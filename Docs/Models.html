<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
    <title>iFit: Models model functions</title>
  </head>
  <body>
    <h1 style="text-align: center;"><a class="mozTocH1"
        name="mozTocId294096"></a>iFit: Models (fit models)</h1>
    <br>
    <ul id="mozToc">
      <!--mozToc h3 1 h4 2 h5 3 h4 4 h5 5 h6 6-->
      <li><a href="#mozTocId147615">How to use models </a></li>
      <li><a href="#mozTocId96090">List of default fit models</a></li>
      <li><a href="#mozTocId285330">Specialized models</a>
        <ul>
          <li><a href="#mozTocId597620">Small Angle Scattering models
              (neutrons, x-rays)</a></li>
          <li><a href="#mozTocId344379"> Powder structure refinement
              (Rietveld)</a></li>
          <li><a href="#mozTocId677670">Phonon/spin-wave dispersion</a></li>
          <li><a href="#mozTocId226848">Phonon dispersion in perovskites</a></li>
          <li><a href="#mozTocId885605">Acoustic phonon dispersion in
              mono-atomic cubic crystal</a></li>
          <li><a href="#mozTocId990577">Phonon dispersion from ab-initio
              force estimate and dynamical matrix </a>
            <ul>
              <li><a href="#mozTocId716147"> A few words about the
                  theory</a></li>
              <li><a href="#mozTocId891630">Syntax</a></li>
              <li><a href="#mozTocId880915"> The system configuration
                  (atoms, unit cell)</a></li>
              <li><a href="#mozTocId912608"> General options </a></li>
              <li><a href="#mozTocId913674"> Specific options for ABINIT</a></li>
              <li><a href="#mozTocId486503">Specific options for GPAW</a></li>
              <li><a href="#mozTocId902505">Specific options for
                  QuantumEspresso/PHON</a></li>
              <li><a href="#mozTocId577034">Choosing a calculator (DFT
                  code)</a></li>
              <li><a href="#mozTocId715775">Convergence issues: what to
                  try</a></li>
              <li><a href="#mozTocId134538">Examples</a></li>
              <li><a href="#mozTocId168620"> References</a></li>
              <li><a href="#mozTocId183326"> Requirements and
                  installation</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="#mozTocId810939">Model builder: defining a new model
          easy</a>
        <ul>
          <li><a href="#mozTocId775891">Creating complex functions from
              simple functions</a></li>
          <li><a href="#mozTocId937554">Using signal
              convolution/correlation in new functions</a></li>
        </ul>
      </li>
      <li><a href="#mozTocId854762">How to write manually a model
          function</a></li>
    </ul>
    <br>
    <hr style="width: 100%; height: 2px;">
    <div style="text-align: center;">Commands we use in this page: <span
        style="font-style: italic;">fits, <a href="#mozTocId775891">ifitmakefunc,













        </a>fits(iData)</span>, <a href="iFunc.html">iFunc</a><br>
    </div>
    <br>
    <h3><a class="mozTocH3" name="mozTocId147615"></a>How to use models<br>
    </h3>
    Models are numerical functions, that take input axes and a parameter
    set, and return a function evaluation. <br>
    <br>
    Such models are defined as <a href="iFunc.html">iFunc</a> objects,
    and used in iFit when there is a need to e.g. compute and plot a
    function evaluation corresponding with the axes of an iData object.
    Similarly, this function evaluation can be used iteratively in an
    optimization process in order to find a parameter set that matches
    best the iData object Signal, using the <span style="font-weight:
      bold;">fits</span> method (refer to the <a href="Fit.html">Fit</a>
    page).<br>
    <br>
    Models can be used in the following ways (for instance 'model' may
    be 'gauss'):<br>
    <pre style="margin-left: 40px;">&gt;&gt; <span style="color: rgb(51, 102, 255);">model</span>		<span style="font-style: italic;">% display model information</span><br>&gt;&gt; <span style="color: rgb(51, 102, 255);">disp(model</span>)		<span style="font-style: italic;">% idem, extensive information</span><br>&gt;&gt; <span style="color: rgb(51, 102, 255);">plot(model</span><span style="color: rgb(204, 51, 204);"></span>)	<span style="font-style: italic;">	% plot the model with its default settings</span><span style="color: rgb(255, 0, 0); font-style: italic;"></span><br>&gt;&gt; <span style="color: rgb(51, 102, 255);">model</span>(p, x, y ...)	<span style="font-style: italic;">% evaluate the model with parameters p, and axes x,y,...<br>&gt;&gt; </span><span style="color: rgb(51, 102, 255);">model</span>([], x, y ...)	<span style="font-style: italic;">% evaluate the model with axes x,y,... and automatic parameter guess<br></span><span style="font-style: italic;">&gt;&gt; </span><span style="color: rgb(51, 102, 255);">model</span>(<span style="color: rgb(204, 51, 204);">'guess'</span>, x, y ...)	% idem<br>&gt;&gt; <span style="color: rgb(51, 102, 255);"></span>a(model, p)	<span style="font-style: italic;">	% evaluate the model onto the iData object 'a' axes with parameters p<br>&gt;&gt; </span><span style="color: rgb(51, 102, 255);">fits</span>(a, model, p)	<span style="font-style: italic;">% fit the model onto the iData object</span><br>&gt;&gt; <span style="color: rgb(51, 102, 255);">fits</span>(model, a, p)	<span style="font-style: italic;">% same as above<br></span><span style="font-style: italic;"></span><br></pre>
    To create a model, use the <a href="#mozTocId775891">ifitmakefunc</a>
    dialogue window (see below), or instantiate an <a href="iFunc.html">iFunc</a>
    object.<br>
    <pre style="margin-left: 40px;">&gt;&gt; model = gauss;<br>&gt;&gt; model = <span style="color: rgb(51, 102, 255);">iFunc</span>(<span style="color: rgb(204, 51, 204);">'p(1)*x+p(2)'</span>)<br>&gt;&gt; model = <span style="color: rgb(51, 102, 255);">iFunc</span>(<span style="color: rgb(204, 51, 204);">'a=p(1); b=p(2); signal=a*x+b'</span>) <br></pre>
    You can edit their code to see how to define new models:<br>
    <pre style="margin-left: 40px;">&gt;&gt; <span style="color: rgb(51, 102, 255);">edit</span> gauss <span style="font-style: italic;">% edit the function definition (from a file)</span><br>&gt;&gt; <span style="color: rgb(51, 102, 255);">edit</span> voigt<br>&gt;&gt; <span style="color: rgb(51, 102, 255);">edit</span>(voig) <span style="font-style: italic;">% edit the object definition</span><br></pre>
    <pre style="margin-left: 40px;"><span style="font-style: italic;"></span></pre>
    <h3><a class="mozTocH3" name="mozTocId96090"></a><span
        style="font-weight: bold;">List of default fit models</span></h3>
    The 1D functions are <span style="font-style: italic;">signal=f(parameters,













      x)</span>, and the 2D functions are <span style="font-style:
      italic;">signal=f(parameters, x, y)</span>.<br>
    <span style="font-style: italic; font-weight: bold;"><br>
    </span>
    <table style="text-align: left; width: 1016px; height: 1301px;"
      border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Function<br>
          </td>
          <td style="vertical-align: top; background-color: rgb(255,
            204, 204);"><span style="font-style: italic; font-weight:
              bold; color: rgb(51, 102, 255);">Description</span><br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Dimensionality<br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Parameters<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">allometric<br>
          </td>
          <td style="vertical-align: top;">Allometric (power/asymptotic
            law)<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<br>
          </td>
          <td style="vertical-align: top;">Amplitude Offset Exponent
            BackGround<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><span style="font-weight:
              bold;">bigauss</span><br>
          </td>
          <td style="vertical-align: top;">Asymmetric Gaussian<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D</td>
          <td style="vertical-align: top;">Amplitude Centre HalfWidth1
            HalfWidth2 Background</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><span style="font-weight:
              bold;">bilorz</span><br>
          </td>
          <td style="vertical-align: top;">Asymmetric Lorentzian<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D</td>
          <td style="vertical-align: top;">Amplitude Centre HalfWidth1
            HalfWidth2 Background</td>
        </tr>
        <tr>
          <td style="vertical-align: top; color: rgb(0, 0, 0);
            font-weight: bold;">bose</td>
          <td style="vertical-align: top;">Bose factor<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D</td>
          <td style="vertical-align: top;">Tau <span style="font-style:
              italic;">[h/2pi/kT] in "x" units</span><br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">dho<br>
          </td>
          <td style="vertical-align: top;">Damped harmonic oscillator<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D</td>
          <td style="vertical-align: top;">Amplitude Centre HalfWidth
            Background Temperature <span style="font-style: italic;">(in












              "x" unit)</span><br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">dirac<br>
          </td>
          <td style="vertical-align: top;">Dirac peak<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<br>
          </td>
          <td style="vertical-align: top;">Amplitude Centre<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">doseresp<br>
          </td>
          <td style="vertical-align: top;">Dose-response curve with
            variable Hill slope. This is a sigmoid or S-shaped.<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<br>
          </td>
          <td style="vertical-align: top;">Amplitude Center Slope
            BackGround<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><span style="font-weight:
              bold;">expon</span><br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Exponential_decay">Exponential</a>
            decay <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="Expon decay" title="Expon decay"
              src="images/Models_Plot-exponential-decay.svg.png"
              height="75" width="100" align="middle"> </td>
          <td style="vertical-align: top;">Amplitude Tau Background<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><span style="font-weight:
              bold;">expstretched</span><br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Stretched_exponential_function">Exponential














              - Stretched</a><br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="Expon stretched" title="Expon stretched"
              src="images/Models_Pibmasterplot.png" height="75"
              width="100" align="middle"> </td>
          <td style="vertical-align: top;">Amplitude Tau Exponent
            Background<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; color: rgb(0, 0, 0);
            font-weight: bold;">gauss</td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Gaussian_function">Gaussian</a>
            <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="Normal_Distribution" title="Normal_Distribution"
              src="images/Models_Normal_Distribution_PDF.svg.png"
              height="75" width="100" align="middle"></td>
          <td style="vertical-align: top;">Amplitude Centre HalfWidth
            Background<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">green<br>
          </td>
          <td style="vertical-align: top;">Green function<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<br>
          </td>
          <td style="vertical-align: top;">Amplitude Centre HalfWidth
            Background</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><span style="font-weight:
              bold;">heaviside</span><br>
          </td>
          <td style="vertical-align: top;">Heaviside (gap)<br>
            <span style="font-style: italic;">The GapSide indicates
              raising (+) or falling (-) gap.</span><br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<br>
          </td>
          <td style="vertical-align: top;">Amplitude Centre GapSide
            Background<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">langevin<br>
          </td>
          <td style="vertical-align: top;">Langevin function for
            magnetic polarization<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<br>
          </td>
          <td style="vertical-align: top;">Amplitude Center Width
            BackGround<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">laplace<br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Laplace_distribution">Laplace












              distribution function</a> <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="Laplace" title="Laplace"
              src="images/Models_Laplace_pdf_mod.svg.png" height="75"
              width="100" align="middle"> </td>
          <td style="vertical-align: top;">Amplitude Center Width
            BackGround</td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">lognormal<br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Log-normal_distribution">Log-Normal














              distribution</a> <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="Log normal" title="Log normal"
              src="images/Models_PDF-log_normal_distributions.svg.png"
              height="100" width="100" align="middle"> </td>
          <td style="vertical-align: top;">Amplitude Center Width
            BackGround<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">lorz<br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Lorentzian_function">Lorentzian</a>
            (aka Cauchy)&nbsp; <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="lorz" title="lorz"
              src="images/Models_Cauchy_pdf.svg.png" height="80"
              width="100" align="middle"></td>
          <td style="vertical-align: top;">Amplitude Centre HalfWidth
            Background</td>
        </tr>
        <tr>
          <td valign="top"><b>ngauss</b><b><br>
            </b></td>
          <td valign="top">multiple Gaussian<br>
          </td>
          <td valign="top">n*1D<br>
          </td>
          <td valign="top"><br>
          </td>
        </tr>
        <tr>
          <td valign="top"><b>nlorz</b><b><br>
            </b></td>
          <td valign="top">multiple Lorentzian<br>
          </td>
          <td valign="top">n*1D<br>
          </td>
          <td valign="top"><br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">pareto<br>
          </td>
          <td style="vertical-align: top;">Pareto distribution function<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<br>
          </td>
          <td style="vertical-align: top;">Amplitude Exponent Width
            BackGround<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">poisson<br>
          </td>
          <td style="vertical-align: top;">Poisson distribution<br>
            <span style="color: rgb(255, 0, 0);">WARNING:<span
                style="font-style: italic;"> </span></span><span
              style="font-style: italic;">The 'x' axis is assumed to be
              an integer array (counts)</span><br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<br>
          </td>
          <td style="vertical-align: top;">Amplitude Center BackGround<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><span style="font-weight:
              bold;">pseudovoigt</span><br>
          </td>
          <td style="vertical-align: top;">Pseudo Voigt<br>
          </td>
          <td style="vertical-align: top;"><span style="color: rgb(51,
              204, 0);">1D</span><br>
          </td>
          <td style="vertical-align: top;">Amplitude Center Width
            BackGround LorentzianRatio<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><span style="font-weight:
              bold;">quadline</span><br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Parabola">Quadratic</a>
            line (parabola) <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="quad" title="quad"
              src="images/Models_Parts_of_Parabola.svg.png" height="82"
              width="100" align="middle"> </td>
          <td style="vertical-align: top;">Quadratic Linear Constant<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><span style="font-weight:
              bold;">sigmoid</span><br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Sigmoid_function">Sigmoidal</a>
            S-shaped curve (similar to Dose Response) <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="sigmo" title="sigmo"
              src="images/Models_Logistic-curve.svg.png" height="67"
              width="100" align="middle"></td>
          <td style="vertical-align: top;">Amplitude Center Width
            BackGround</td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">sine<br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Sine_function">Sine
              function</a> <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="sine" title="sine"
              src="images/Models_Sine_one_period.svg.png" height="40"
              width="100" align="middle"> </td>
          <td style="vertical-align: top;">Amplitude Phase_Shift Period
            BackGround<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">sinedamp<br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Damped_sine_wave">Damped













              Sine function</a> (exponential decay) <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="sine_exp" title="sine_exp"
              src="images/Models_DampedSine.png" height="76" width="100"
              align="middle"> </td>
          <td style="vertical-align: top;">Amplitude Phase_Shift Period
            BackGround Decay<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">strline<br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Straight_line">Straight
              line</a> <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="line" title="line"
              src="images/Models_FuncionLineal01.svg.png" height="75"
              width="100" align="middle"> </td>
          <td style="vertical-align: top;">Gradient Background<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">triangl<br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Triangular_function">Triangular</a>
            <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="triangle" title="triangle"
              src="images/Models_Triangular_function.svg.png"
              height="70" width="100" align="middle"></td>
          <td style="vertical-align: top;">Amplitude Centre HalfWidth
            Background</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><span style="font-weight:
              bold;">tophat</span><br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Rectangular_function">Top-Hat












              rectangular function</a> <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="top hat" title="top hat"
              src="images/Models_Rectangular_function.svg.png"
              height="69" width="100" align="middle"></td>
          <td style="vertical-align: top;">Amplitude Centre HalfWidth
            Background</td>
        </tr>
        <tr>
          <td style="vertical-align: top;"><span style="font-weight:
              bold;">twoexp</span><br>
          </td>
          <td style="vertical-align: top;">Two exponential decay
            functions<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D</td>
          <td style="vertical-align: top;">Amplitude1 Tau1 Amplitude2
            Tau2 Background<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">voigt<br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Voigt_profile">Voigt
              function</a> <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<img
              alt="voigt" title="voigt"
              src="images/Models_Voigt_distributionPDF.png" height="75"
              width="100" align="middle"> </td>
          <td style="vertical-align: top;">Amplitude Centre
            HalfWidth_Gauss HalfWidth_Lorz Background<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">gauss2d<br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Gaussian_function">Gaussian</a>
            function with tilt angle <br>
          </td>
          <td style="vertical-align: top;"><span style="color: rgb(51,
              102, 255);">2D</span><img alt="gauss2d" title="gauss2d"
              src="images/Models_Gaussian_2d_3.svg.png" height="75"
              width="100" align="middle"> </td>
          <td style="vertical-align: top;">Amplitude Centre_X Center_Y
            HalfWidth_X HalfWidth_Y Angle Background<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">lorz2d<br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Lorentzian_function">Lorentzian</a>
            function with tilt angle</td>
          <td style="vertical-align: top;"><span style="color: rgb(51,
              102, 255);">2D</span></td>
          <td style="vertical-align: top;">Amplitude Centre_X Center_Y
            HalfWidth_X HalfWidth_Y Angle Background</td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">plane2d<br>
          </td>
          <td style="vertical-align: top;">Planar function<br>
          </td>
          <td style="vertical-align: top;"><span style="color: rgb(51,
              102, 255);">2D</span></td>
          <td style="vertical-align: top;">Slope_X Slope_Y Background<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">pseudovoigt2d<br>
          </td>
          <td style="vertical-align: top;">Pseudo Voigt with tilt
            angle&nbsp;</td>
          <td style="vertical-align: top;"><span style="color: rgb(51,
              102, 255);">2D</span><img alt="voigt" title="voigt"
              src="images/Models_Voigt_distributionPDF.png" height="75"
              width="100" align="middle"></td>
          <td style="vertical-align: top;">Amplitude Centre_X Center_Y
            HalfWidth_X HalfWidth_Y Angle Background LorentzianRatio<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">quad2d<br>
          </td>
          <td style="vertical-align: top;">Quadratic (parabola) with
            tilt angle</td>
          <td style="vertical-align: top;"><span style="color: rgb(51,
              102, 255);">2D</span></td>
          <td style="vertical-align: top;">Amplitude Centre_X Center_Y
            Curvature_X Curvature_Y Angle Background</td>
        </tr>
        <tr>
          <td valign="top"><b>gaussnd</b><br>
          </td>
          <td valign="top"><a
href="http://en.wikipedia.org/wiki/Gaussian_function#Multi-dimensional_Gaussian_function">n-dimensional













              Gaussian</a><br>
          </td>
          <td valign="top"><font color="#cc33cc">nD</font><br>
          </td>
          <td valign="top"><br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;"><a
              href="#mozTocId597620">sf_hard_spheres</a><br>
          </td>
          <td style="vertical-align: top;">Hard Sphere structure factor
            [Percus-Yevick] <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D <img
              alt="py" title="py" src="images/Models_Hard_Spheres.jpg"
              height="81" width="100" align="middle"></td>
          <td style="vertical-align: top;">R rho<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;"><a
              href="#mozTocId344379">rietveld</a><br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Rietveld_refinement">Rietveld</a>
            refinement of powder sample <br>
            with full <a href="http://www.mcstas.org">McStas</a>
            instrument model <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D,
            2D, 3D<img alt="rietveld" title="rietveld"
              src="images/Models_xrayplot-usgs2.gif" height="59"
              width="100" align="middle"><br>
          </td>
          <td style="vertical-align: top;">sample structure, <br>
            instrument parameters<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;"><a
              href="#mozTocId677670"><b>sqw_sine3d</b></a> </td>
          <td style="vertical-align: top;">Phonon dispersions as sine
            wave in HKL with a damped harmonic oscillator energy
            dispersion&nbsp; </td>
          <td style="vertical-align: top;"><font color="#33cc00">4D (HKL<i>w</i>)</font><br>
            <img alt="sqw_sine3d" title="sqw_sine3d"
              src="images/Models_sqw_sine3d.png" height="73" width="100"
              align="middle" border="0"> </td>
          <td valign="top">zone center, energy gaps, periodicity</td>
        </tr>
        <tr>
          <td valign="top"><a href="#mozTocId226848"><b>sqw_vaks</b></a></td>
          <td valign="top">Phonon dispersions in perovskite cubic
            crystals using the Vaks parameterisation&nbsp; </td>
          <td valign="top"><font color="#33cc00">4D (HKLw)</font><br>
            <a href="images/Models_sqw_vaks.png"><img alt="sqw_vaks"
                title="sqw_vaks" src="images/Models_sqw_vaks.png"
                height="75" width="100" align="middle" border="0"></a></td>
          <td valign="top">acoustic and optical energies, coupling
            parameters, soft mode frequency<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><a href="#mozTocId885605"><b>sqw_</b><b>cubic_monoatomic</b></a></td>
          <td valign="top">Phonon dispersions in a monoatomic cubic
            crystal using the Dynamical matrix. </td>
          <td valign="top"><font color="#33cc00">4D (HKLw)</font><br>
            <a href="images/Models_sqw_cubic_mono.png"><img
                alt="sqw_cubic_mono" title="sqw_cubic_mono"
                src="images/Models_sqw_cubic_mono.png" height="76"
                width="100" align="middle" border="0"></a></td>
          <td valign="top">acoustic force constant ratio and energy
            scaling.<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><a href="#mozTocId881911"><b>sqw_phon</b></a></td>
          <td valign="top">Phonon dispersions from the Dynamical matrix,
            using forces estimated by <i>ab-initio</i>, using <a
              href="http://www.homepages.ucl.ac.uk/%7Eucfbdxa/phon/">PHON</a>/<a
              href="http://www.quantum-espresso.org/">QE</a><i>.&nbsp;</i>
          </td>
          <td valign="top"><font color="#33cc00">4D (HKLw)</font><br>
            <div align="left"><a href="images/Models_sqw_phon.png"><img
                  alt="sqw_phon" title="sqw_phon"
                  src="images/Models_sqw_phon.png" height="76"
                  width="100" align="left" border="0"></a></div>
          </td>
          <td valign="top">Creation: <a
              href="http://cms.mpi.univie.ac.at/vasp/guide/node59.html">POSCAR.</a><br>
            Then, only the DHO line shape. <i>ab-initio</i> implies no
            (few) tunable parameter. </td>
        </tr>
        <tr>
          <td valign="top"><a href="#mozTocId990577"><b>sqw_phonons</b></a></td>
          <td valign="top">Phonon dispersions from the Dynamical matrix,
            using forces estimated by <i>ab-initio </i>using <a
              href="https://wiki.fysik.dtu.dk/ase">ASE</a>.<i>&nbsp;</i>
          </td>
          <td valign="top"><font color="#33cc00">4D (HKLw)</font><br>
            <a href="images/Models_sqw_ph_ase.png"><img
                src="images/Models_sqw_ph_ase.png" title="sqw_ph_ase Al
                fcc" alt="sqw_ph_ase Al fcc" height="74" width="100"
                align="left" border="0"></a></td>
          <td valign="top">Creation: <a
              href="http://cms.mpi.univie.ac.at/vasp/guide/node59.html">POSCAR</a>,
            <a
              href="http://en.wikipedia.org/wiki/Crystallographic_Information_File">CIF</a>,
            or <a href="http://www.rcsb.org/pdb/">PDB</a>, ...<br>
            Then, only the DHO line shape. <i>ab-initio</i> implies no
            (few) tunable parameter. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <div style="text-align: center;"><a href="images/iFit_Models.png"><img
          title="iFit: default functions (in Models)"
          src="images/iFit_Models.png" alt="iFit: default functions (in
          Models)" style="border: 0px solid ; width: 560px; height:
          420px;" align="middle"></a><br>
    </div>
    <span style="font-weight: normal;">To get one of these models, just
      type their function name:<br>
    </span>
    <pre style="margin-left: 40px;"><span style="font-weight: normal;">&gt;&gt; gauss<br>&gt;&gt; a = gauss;<br></span></pre>
    <pre><span style="font-weight: normal;"></span></pre>
    <span style="font-weight: normal;">The </span>list of <span
      style="font-weight: bold;">all available fit functions</span><span
      style="font-weight: normal;"> can be obtained from the command<span
        style="font-weight: bold;">:</span></span><br>
    <pre style="margin-left: 40px;">&gt;&gt; <span style="color: rgb(51, 102, 255);">fits</span>(<span style="font-style: italic;">iData);<br></span></pre>
    which also produces the plot above.<br>
    <h3><a class="mozTocH3" name="mozTocId285330"></a>Specialized models</h3>
    <h4><a class="mozTocH4" name="mozTocId597620"></a>Small Angle
      Scattering models (neutrons, x-rays)</h4>
    <p>We list below a number of models used to describe neutron and
      x-ray scattering from matter. The structure factor S(q) accounts
      for the structure of matter at the atomistic/molecular level,
      whereas the form factor P(q) accounts for the geometrical
      arrangement of large scale scattering units (micelles, tubes,
      ...). In practice, the scattering from a material can be described
      by:<br>
    </p>
    <p style="text-align: center;"><span style="font-style: italic;">I(q)













        = P(q).S(q)</span><br>
    </p>
    <p style="text-align: left;">where <span style="font-style:
        italic;">q</span> is the momentum exchange in the material.
      These models have been extracted from:<br>
    </p>
    <ul>
      <li><a href="http://kur.web.psi.ch/sans1/SANSSoft/sasfit.html">SASfit</a>,
        by <a href="http://kur.web.psi.ch/sans1/SANSSoft/KJ33.html">Joachim













          Kohlbrecher</a> and <a
          href="mailto:ingo%28at%29cs.tu-berlin.de">Ingo Bressler</a>
        PSI (2006-2011)</li>
    </ul>
    <table style="text-align: left; width: 1016px; height: 13px;"
      border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Structure factors<br>
          </td>
          <td style="vertical-align: top; background-color: rgb(255,
            204, 204);"><span style="font-style: italic; font-weight:
              bold; color: rgb(51, 102, 255);">Description</span><br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Dimensionality<br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Parameters<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">sf_hard_spheres<br>
          </td>
          <td style="vertical-align: top;">Hard Sphere structure factor
            [Percus-Yevick] <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D <img
              alt="py" title="py" src="images/Models_Hard_Spheres.jpg"
              height="81" width="100" align="middle"></td>
          <td style="vertical-align: top;">R rho<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">sf_square_well













            <br>
          </td>
          <td style="vertical-align: top;">structure factor of particles
            interacting with a square well potential [Sharma]<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<br>
          </td>
          <td style="vertical-align: top;">R rho epsilon Delta T<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">sf_sticky_hard_spheres<br>
          </td>
          <td style="vertical-align: top;">Sticky Hard Sphere structure
            factor [Baxter/Menon]<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<br>
          </td>
          <td style="vertical-align: top;">R rho tau<br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <table style="text-align: left; width: 1016px; height: 59px;"
      border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Form factors: small angle<br>
          </td>
          <td style="vertical-align: top; background-color: rgb(255,
            204, 204);"><span style="font-style: italic; font-weight:
              bold; color: rgb(51, 102, 255);">Description</span><br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Dimensionality<br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Parameters<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">ff_core_shell<br>
          </td>
          <td style="vertical-align: top;">Spherical/core shell form
            factor [Guinier]<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<br>
          </td>
          <td style="vertical-align: top;">R1 R2 eta1 eta2<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">ff_sphere&nbsp;













            <br>
          </td>
          <td style="vertical-align: top;">Sphere form factor [Guinier]<br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D<br>
          </td>
          <td style="vertical-align: top;">R eta<br>
          </td>
        </tr>
      </tbody>
    </table>
    <pre style="margin-left: 40px;"><span style="font-style: italic;"></span><span style="font-style: italic;"></span></pre>
    <h4><a class="mozTocH4" name="mozTocId344379"></a> Powder structure
      refinement (Rietveld)</h4>
    <p>The <b>rietveld</b> model performs a structure refinement (atom
      type and position, structure group) of a powder by comparing a
      measured diffractogram with a simulated diffractogram using <a
        href="http://www.mcstas.org">McStas</a> and <a
        href="https://forge.epn-campus.eu/projects/crysfml">CrysFML</a>.
      This model requires external software to be installed on your
      computer. See <i>Requirements</i> below.<br>
    </p>
    <table style="text-align: left; width: 1016px; height: 59px;"
      border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Powder diffraction<br>
          </td>
          <td style="vertical-align: top; background-color: rgb(255,
            204, 204);"><span style="font-style: italic; font-weight:
              bold; color: rgb(51, 102, 255);">Description</span><br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Dimensionality<br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Parameters<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">rietveld<br>
          </td>
          <td style="vertical-align: top;"><a
              href="http://en.wikipedia.org/wiki/Rietveld_refinement">Rietveld</a>
            refinement of powder sample <br>
            with full <a href="http://www.mcstas.org">McStas</a>
            instrument model <br>
          </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">1D,
            2D, 3D<br>
            <img alt="rietveld" title="rietveld"
              src="images/Models_xrayplot-usgs2.gif" height="59"
              width="100" align="middle"> </td>
          <td style="vertical-align: top;">sample structure, <br>
            instrument parameters<br>
          </td>
        </tr>
      </tbody>
    </table>
    <pre style="margin-left: 40px;"><span style="font-style: italic;"></span><span style="font-style: italic;"></span></pre>
    The '<b>rietveld</b>' model allows to prepare a sample+instrument
    model in order to fit a diffraction/structure data set.<br>
    It is obtained by making use of the CrysFML library:<br>
    <ul>
      <li><a href="https://forge.epn-campus.eu/projects/crysfml">CrysFML</a>
        by <a href="mailto:jrc@ill.eu">Juan Rodriguez-Carvajal</a> and
        <a href="mailto:jplatas@ull.es">Javier Gonzalez-Platas</a>, ILL
        and <span class="st">ULL, Tenerife, <em>Spain </em>(LGPL 3.0<em>)</em></span></li>
      <li><span class="st">Commission on Crystallographic Computing,
          IUCr Newsletter No.1, pp 50-58,&nbsp; January 2003 [<a
href="http://www.iucr.org/resources/commissions/crystallographic-computing/newsletters/1/crysfml">link</a>]<br>
        </span></li>
    </ul>
    The procedure is to import a crystal structure (CIF, ShellX, CFL
    format) then compute the HKL <i>d-F</i><sup>2</sup> list of
    reflections (for crystal or powder), and insert this powder model
    into a diffractometer simulated using <a
      href="http://www.mcstas.org">McStas</a>. The detector image, which
    is the convolution of the sample structure with the instrument
    resolution, is then compared with a given diffractogram, and
    optimised to refine the crystal parameters.<br>
    <br>
    The syntax to build the model, and then perform the refinement is:<br>
    <div style="margin-left: 40px;">
      <pre>&gt;&gt; model=<span style="color: rgb(51, 102, 255);">rietveld</span>(structure, ...., instrument, ....)<br>&gt;&gt; p = <span style="color: rgb(51, 102, 255);">fits</span>(model, measurement);<br></pre>
    </div>
    where the 'structure' describes the initial sample structure (space
    group, cell parameters abc &#945;&#946;&#947;, atom positions, ...); it can be
    given as a CIF, FullProf or ShellX file, as well as from a <span
      style="font-style: italic;">struct</span> type variable with
    fields<span style="font-style: italic;"> 'Spgr' </span>and <span
      style="font-style: italic;">'cell'</span>, followed with atoms
    (giving xyz Biso occupancy spin charge, where only xyz are
    mandatory, others are optional):<br>
    <div style="margin-left: 40px;">
      <pre>Sample.cell&nbsp; = [10.242696&nbsp; 10.242696&nbsp; 10.242696&nbsp; 90.000&nbsp; 90.000&nbsp; 90.000];
Sample.Spgr&nbsp; = 'I 21 3';
Sample.Ca1&nbsp;&nbsp; = [0.46737&nbsp; 0.00000&nbsp; 0.25000&nbsp; 0.60046&nbsp; 0.50000&nbsp;&nbsp; 0.0&nbsp;&nbsp; 2.0];<br>...<br></pre>
    </div>
    the instrument is the name of the McStas instrument description (<span
      style="font-style: italic;">templateDIFF.instr</span> is the
    default). The McStas simulation can be controlled using the default
    McStas options, as described in the <a href="McStas.html">dedicated
      help page</a> : <span style="font-weight: bold;">dir, ncount,
      mpi, seed, gravitation, compile, monitors</span>. The monitors
    options is particularly recommended to specify which monitor file to
    use from the virtual experiment. The resulting model data set should
    be of the same type as the diffractometer measured data set (e.g.
    TOF-angle, height-angle, ...), but not necessarily with same binning
    and axes range.<br>
    <br>
    Any other '<span style="font-style: italic;">name=value</span>'
    argument is assumed to be an instrument parameter. Any scalar
    parameter is made into a model parameter, whereas string/char
    parameters are set as fixed instrument parameters. By default, the
    sample structure (powder/single crystal) is made available to the
    McStas instrument by mean of a <span style="font-style: italic;">'reflections.laz'</span>
    file which should be used by a <span style="font-style: italic;">PowderN</span>
    or <span style="font-style: italic;">Isotropic_Sqw</span>
    component. This name can be changed by specifying the
    'CFML_write=filename' option.<br>
    <br>
    An example of Rietveld model is obtained from a CFL file, and the
    templateDIFF instrument including <span style="font-style: italic;">PowderN(reflections=Powder,...)</span>.
    We thus specify the fixed instrument parameter <span
      style="font-style: italic;">Powder='reflections.laz'</span>. The
    wavelength is kept fixed at 2.36, and we use monitor names matching
    <span style="font-style: italic;">BananaTheta</span>.<br>
    <pre style="margin-left: 40px;">&gt;&gt; model = <span style="color: rgb(51, 102, 255);">rietveld</span>([ <span style="color: rgb(51, 102, 255);">ifitpath</span> <span style="color: rgb(204, 51, 204);">'Data/Na2Ca3Al2F14.cfl'</span> ], <span style="color: rgb(204, 51, 204);">'templateDIFF.instr'</span>, <span style="color: rgb(204, 51, 204);">'Powder=reflections.laz; lambda="2.36"; monitors=BananaTheta'</span>);</pre>
    Once built, it is possible to set constraints on the model with the
    syntax such as (see <a href="iFunc.html#mozTocId579374">iFunc</a>
    page) :<br>
    <pre style="margin-left: 40px;">&gt;&gt; model.parameter=<span style="color: rgb(204, 51, 204);">'fix'</span>     <span style="font-style: italic;">% to lock its value during a fit process</span><br>&gt;&gt; model.parameter='<span style="color: rgb(204, 51, 204);">clear'</span>   <span style="font-style: italic;">% to unlock value during a fit process</span>
&gt;&gt; model.parameter=[min max] <span style="font-style: italic;">% to bound value</span><br>&gt;&gt; model.parameter=[nan nan] <span style="font-style: italic;">% to remove bound constraint</span><br>&gt;&gt; model.parameter=<span style="color: rgb(204, 51, 204);">''</span>        <span style="font-style: italic;">% to remove all constraints on 'parameter'</span><br>&gt;&gt; model.Constraint=<span style="color: rgb(204, 51, 204);">''</span>       <span style="font-style: italic;">% to remove all constraints</span></pre>
    Then we import a data set<br>
    <pre style="margin-left: 40px;">&gt;&gt; measurement = iData([ <span style="color: rgb(51, 102, 255);">ifitpath</span> <span style="color: rgb(204, 51, 204);">'Data/nac_1645179.dat'</span> ]);</pre>
    The refinement is then obtained by starting :<br>
    <pre style="margin-left: 40px;">&gt;&gt; parameters = <span style="color: rgb(51, 102, 255);">fits</span>(model, measurement)</pre>
    with optional arguments as described in the <a href="Fit.html">Fit</a>
    page (the 'constraints' argument of <span style="font-style:
      italic;">fits</span> is partly redundant with the model
    constraints seen above).<br>
    Remember to bound most or all of the model parameters for a faster
    and more reliable convergence of the optimization.<br>
    <br>
    <i><b>References:</b></i><br>
    <span class="st">CrysFML, Commission on Crystallographic Computing,
      IUCr Newsletter No.1, pp 50-58,&nbsp; January 2003 [<a
href="http://www.iucr.org/resources/commissions/crystallographic-computing/newsletters/1/crysfml">link</a>]</span>.<br>
    McStas: K. Lefmann and K. Nielsen, Neutron News 10, 20, (1999) ; P.
    Willendrup, E. Farhi and K. Lefmann, Physica B, 350 (2004) 735.<br>
    <br>
    <i><b>Requirements/installation:</b></i><br>
    <a href="http://www.mcstas.org">McStas</a> must be installed.
    Packages exist for all major systems (Linux as RedHat and Debian
    flavours, Windows, Mac OSX). For Debian-class systems:<br>
    <blockquote>
      <pre>cd /etc/apt/sources.list.d
sudo wget http://packages.mccode.org/debian/mccode.list
sudo apt-get update<br>sudo apt-get install <b><font color="blue">mcstas-suite</font></b><br></pre>
    </blockquote>
    The CrysFML does not need to be installed, as the used bits are
    assembled in the <a
      href="http://ifit.mccode.org/Downloads/cif2hkl.F90">cif2hkl
      fortran</a> programme, which generates HKL d-F2 reflection lists
    suitable for the PowderN and Isotropic_Sqw McStas components. The
    cif2hkl programme is part of the iFit distribution, and is compiled
    by calling the local fortran compiler (gfortran) on demand.<br>
    <h4><a class="mozTocH4" name="mozTocId677670"></a>Phonon/spin-wave
      dispersion</h4>
    <p>The <b>sqw_sine3d</b> model provides a simple way to model most
      <a href="https://en.wikipedia.org/wiki/Phonon">phonon-type</a>
      dispersions, including <a
        href="https://en.wikipedia.org/wiki/Spin_wave">spin-waves</a>,
      acoustic and optical modes, incommensurate dispersions.<br>
    </p>
    <p><i><u>Limitation</u></i><i>:</i> this model only handles simple
      sine dispersions, and can not treat mode exchange (interferences).
    </p>
    <table style="text-align: left; width: 1016px; height: 59px;"
      border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">S(q,w)<br>
          </td>
          <td style="vertical-align: top; background-color: rgb(255,
            204, 204);"><span style="font-style: italic; font-weight:
              bold; color: rgb(51, 102, 255);">Description</span><br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Dimensionality<br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Parameters<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; font-weight: bold;"><b>sqw_sine3d</b>
          </td>
          <td style="vertical-align: top;">Phonon dispersions as sine
            wave in HKL (3D) with a damped harmonic oscillator energy
            dispersion&nbsp; </td>
          <td style="vertical-align: top; color: rgb(51, 204, 0);">4D
            (HKL<i>w</i>)<br>
            <img alt="sqw_sine3d" title="sqw_sine3d"
              src="images/Models_sqw_sine3d.png" height="73" width="100"
              align="middle" border="0"><br>
          </td>
          <td style="vertical-align: top;">zone center, energy gaps,
            periodicity<br>
          </td>
        </tr>
      </tbody>
    </table>
    <pre style="margin-left: 40px;"><span style="font-style: italic;"></span><span style="font-style: italic;"></span></pre>
    <p>Each dispersion is a sine wave which goes continuously from
      energy E0 to E1, along 3 principal lattice directions (HKL). The
      dispersion has an energy width (DHO). Schematically, the
      dispersion relation is:<br>
    </p>
    <p>&nbsp;&nbsp;&nbsp; <i>w(Q) = E0 + (E1-E0)*sin(Q_freq*pi*(Q-Q0));</i>
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; along principal axes<br>
    </p>
    <p>where the wave-vector/momentum Q is expressed in reciprocal
      lattice units [r.l.u]. The parameters of this model allow extended
      flexibility in the description of the mode. Along the 3D HKL
      volume, a dispersion is described with 10 parameters.<br>
      The <i>Q_freq</i> parameter indicates how many dispersion sine
      'arches' there are per reciprocal lattice unit [rlu]. A <i>Q_freq</i>
      of 1/2 means the dispersion extends from e.g. Q=0 to Q=2 rlu. A <i>Q_freq</i>
      of 1 means it extends from Q=0 to Q=1 rlu, and a <i>Q_freq</i> of
      2 means there are two arches between Q=0 and Q=1 rlu (all these
      with Q0=0). A Q_freq of 0 sets a flat dispersion.<br>
    </p>
    <p>To create the model without defined parameter values, you may
      use:<br>
    </p>
    <blockquote>
      <p>sw = <font color="#3366ff">sqw_sine3d</font>;<br>
      </p>
    </blockquote>
    or alternatively, to define starting parameters:<br>
    <blockquote>sw = <font color="#3366ff">sqw_sine3d</font>(<i>p</i>);<br>
    </blockquote>
    where <i>p</i>=[...] is a vector containing the parameter values.
    It may be given as 1,2,3 and 14 value vector, as detailed below.<br>
    <p>A <b>spin-wave </b>could for instance mostly use Q0=0,
      Q_freq=1,&nbsp; E0=0, E1&gt;0 (2 arches from Q=0 to 1 rlu). In a
      simple anti-ferromagnet, the gap width is <i>E1-E0=4J.S</i> with
      J=exchange energy and S=magnetic moment of spins.<br>
    </p>
    <pre>  &gt;&gt; sw = <font color="#3366ff">sqw_sine3d</font>([ E0 E1 Q_freq ])	<i>% creates a dispersion from E0 to E1 with given Q frequency, e.g. .5, 1 or 2</i></pre>
    <p>A <b>phonon acoustic branc</b>h could use Q0=0, Q_freq=.5, E0=0
      (1 arch from Q=0 to 1 rlu).<br>
    </p>
    <pre>  &gt;&gt; acoustic = <font color="#3366ff">sqw_sine3d</font>(Emax)	<i>% creates an acoustic dispersion up to Emax </i><br></pre>
    <p>An <b>phonon optical branch</b> could use Q0=0, Q_freq=.2,
      E0&gt;E1 E1&gt;0 (1 arch from Q=0 to 1 rlu with Q=0 energy - Raman
      frequency). </p>
    <pre>  &gt;&gt; optical = <font color="#3366ff">sqw_sine3d</font>([ E0 E1 ])	<i>% creates an optical dispersion from E0 to E1</i></pre>
    <p>The model parameters allow to tune the dispersion:<br>
    </p>
    <ul>
      <li>To shift the minimum/maximum Q of the dispersion, move <i>QH0,QK0,QL0</i>
        parameters.</li>
      <li> To change the extent of the dispersion in Q, vary <i>QH_freq,QK_freq,QL_freq</i>
        parameters.</li>
      <li> To change to minimum and maximum energy, move <i>E0</i> and
        <i>E1_qh,E1_qk,E1_ql</i> parameters. </li>
      <li> To model an incommensurate dispersion, move both <i>QH0,QK0,QL0</i>
        and the <i>QH_freq,QL_freq,QK_freq </i>parameters to
        incommensurate (non rational) values.</li>
      <li>An anisotropic model can be obtained by having different <i>E1













        </i> and <i>Q_freq</i> parameters along axes.</li>
      <li>A 1D or 2D dispersion can be obtained when setting the
        frequencies (e.g. <i>QK_freq QL_freq</i>) to 0<br>
      </li>
    </ul>
    <p>The model parameters are:</p>
    <blockquote>
      <p>&nbsp; p(&nbsp;
        1)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













        <b>E1_qh</b> energy at QH half period [meV]<br>
        &nbsp; p(&nbsp;
        2)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;














        <b>E1_qk</b> energy at QK half period [meV]<br>
        &nbsp; p(&nbsp;
        3)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













        <b>E1_ql</b> energy at QL half period [meV]<br>
        &nbsp; p(&nbsp;
        4)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













        <b>E0</b> zone-centre energy gap [meV]<br>
        &nbsp; p(&nbsp;
        5)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













        <b>QH0</b> QH zone-centre [rlu]<br>
        &nbsp; p(&nbsp;
        6)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













        <b>QK0</b> QK zone-centre [rlu]<br>
        &nbsp; p(&nbsp;
        7)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;












        <b>QL0</b> QL zone-centre [rlu]<br>
        &nbsp; p(&nbsp;
        8)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













        <b>QH_freq</b> QH frequency [multiples of pi]<br>
        &nbsp; p(&nbsp;
        9)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;














        <b>QK_freq</b> QK frequency [multiples of pi]<br>
        &nbsp; p(
        10)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













        <b>QL_freq</b> QL frequency [multiples of pi]<br>
        &nbsp; p(
        11)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













        <b>Gamma</b> Damped Harmonic Oscillator width in energy [meV]<br>
        &nbsp; p( 12)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Temperature</b>
        [K]<br>
        &nbsp; p(
        13)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <b>Amplitude</b><br>
        &nbsp; p(
        14)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Background</b><br>
      </p>
    </blockquote>
    <p>The axes needed for the evaluation are expressed in rlu for
      QH,QK,QL and in meV for the energy.</p>
    <p>A usage example is as follows:<a
        href="images/Models_sqw_sine3d.png"><img alt="sqw_sine3d"
          title="sqw_sine3d" src="images/Models_sqw_sine3d.png"
          height="146" width="200" align="right" border="0"></a><br>
    </p>
    <pre style="margin-left: 40px;">&gt;&gt; ac=<font color="#3366ff">sqw_sine3d</font>(5); 		<i>% an acoustic branch up to 5 meV</i><br>&gt;&gt; qh=<font color="#3366ff">linspace</font>(0,1,50);qk=qh; ql=qh'; w=<font color="#3366ff">linspace</font>(0.01,10,50);	<i>% the axes for evaluation</i><br>&gt;&gt; f=<font color="#3366ff">iData</font>(s,[],qh,qk,ql,w);	<i>% evaluate the model onto given axes</i><br>&gt;&gt; <font color="#3366ff">plot3</font>(log(f(:,:,1,:))); 	<i>% plot as volume</i> in [QH,QK,w, QL=0]. You can also use surf and scatter3 for other rendering<br></pre>
    <p>The axes are given as vectors, but the second is made
      non-parallel to the others, to indicate we wish to build a volume
      out of this. Without transposing the vector, as all axes are the
      same length, they would be interpreted as event data, and the
      resulting evaluation would only contain 50 values.<br>
    </p>
    <p>It is possible to stack as many modes as possible, in different
      flavors. In this case it is advisable to link e.g. the <i>Temperature</i>
      and <i>Background</i> parameters:<a
        href="images/Models_sqw_sine3d_add.png"><img
          alt="sqw_sine3d_3disp" title="sqw_sine3d_3disp"
          src="images/Models_sqw_sine3d_add.png" height="143"
          width="200" align="right" border="0"></a><br>
    </p>
    <pre style="margin-left: 40px;">&gt;&gt; acoustic = <font color="#3366ff">sqw_sine3d</font>(5); optical = <font color="#3366ff">sqw_sine3d</font>([ 10 8 ]); sw = <font color="#3366ff">sqw_sine3d</font>([ 2 4 1 ]);<br>&gt;&gt; disp3 = acoustic + optical + sw;<br>&gt;&gt; disp3.Temperature_2 = <font color="#cc33cc">'"Temperature"'</font>;		% Temperature_2 = Temperature (1st sin3d)<br>&gt;&gt; disp3.Temperature_3 = <font color="#cc33cc">'"Temperature"'</font>;		% Temperature_3 = Temperature<br>&gt;&gt; disp3.Name=<font color="#cc33cc">'sqw_sine3d: acousitc+optical+sw'</font>;<br>&gt;&gt; <font color="#3366ff">mlock</font>(disp3, {<font color="#cc33cc">'Background_2','Background_3'</font>});	% keep them as 0 (default)<br>&gt;&gt; qh=<font color="#3366ff">linspace</font>(0,1,50);qk=qh; ql=qh; w=<font color="#3366ff">linspace</font>(0.01,10,51);	<i>% the axes for evaluation<br></i>&gt;&gt; f=<font color="#3366ff">iData</font>(disp3,[],qh,qk,ql,w);	<i>		% evaluate using initial model parameters</i><br>&gt;&gt; <font color="#3366ff">plot3</font>(log(f(:,:,1,:))); 				<i>% plot as volume</i> in [QH,QK,w, QL=0].<br></pre>
    <p>The <b>plot (surf), plot3, scatter3</b>, and <b>slice</b>
      methods for plotting all provide nice looking rendering of volume
      data. See <a href="Plot.html#mozTocId734523">Plot/3D</a> page.<br>
    </p>
    <h4><a class="mozTocH4" name="mozTocId226848"></a>Phonon dispersion
      in perovskites</h4>
    <p>The <b>sqw_vaks </b>model computes the dispersion of the 5
      lowest <a href="https://en.wikipedia.org/wiki/Phonon">phonon</a>
      dispersions in perovskite cubic crystals. It is based on the Vaks
      parametrization (see references below). The TA1,TA2,LA,TO1 and TO2
      dispersions are obtained from 8 parameters, and a DHO line shape
      is added. The dispersions are anisotropic, with 'valley' and soft
      mode. <br>
      The dynamical matrix is 5x5 and its eigenvalues are the mode
      frequencies.<br>
    </p>
    <p><i><u>Limitation</u></i><i>:</i> even though this is model uses
      few parameters, the dynamic range is limited to e.g.<b> |q|</b>
      &lt; 0.3-0.5 rlu and |w| &lt; 100 meV.<br>
    </p>
    <table style="text-align: left; width: 1016px; height: 59px;"
      border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">S(q,w)<br>
          </td>
          <td style="vertical-align: top; background-color: rgb(255,
            204, 204);"><span style="font-style: italic; font-weight:
              bold; color: rgb(51, 102, 255);">Description</span><br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Dimensionality<br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Parameters<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><b>sqw_vaks</b></td>
          <td valign="top">Phonon dispersions in perovskite cubic
            crystals using the Vaks parameterisation&nbsp; </td>
          <td valign="top"><font color="#33cc00">4D (HKLw)</font><br>
            <a href="images/Models_sqw_vaks.png"><img alt="sqw_vaks"
                title="sqw_vaks" src="images/Models_sqw_vaks.png"
                height="75" width="100" align="middle" border="0"></a></td>
          <td valign="top">acoustic and optical , coupling parameters,
            soft mode frequency<br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <p>To create the model without defined parameter values, you may
      use:<br>
    </p>
    <blockquote>
      <p>s = <font color="#3366ff">sqw_vaks</font>;<br>
      </p>
    </blockquote>
    or alternatively, to define starting parameters:<br>
    <blockquote>s = <font color="#3366ff">sqw_vaks</font>(<i>p</i>);<br>
    </blockquote>
    where <i>p</i>=[...] is a vector containing the parameter values.
    It may be given as a 12 value vector or a string, as detailed below.<br>
    <br>
    The model parameters are the following:<br>
    <blockquote>&nbsp; p(&nbsp;
      1)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













      <b>At</b> transverse acoustic [meV2/rlu2]<br>
      &nbsp; p(&nbsp;
      2)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













      <b>Al</b> longitudinal acoustic [meV2/rlu2]<br>
      &nbsp; p(&nbsp;
      3)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













      <b>Aa</b> anisotropic acoustic [meV2/rlu2]<br>
      &nbsp; p(&nbsp;
      4)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













      <b>St</b> soft mode&nbsp; transverse soft optical [meV2/rlu2]<br>
      &nbsp; p(&nbsp;
      5)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













      <b>Sa</b> soft mode&nbsp; anisotropic soft optical [meV2/rlu2]<br>
      &nbsp; p(&nbsp;
      6)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













      <b>Vt</b> transverse acoustic-optical coupling [meV2/rlu2]<br>
      &nbsp; p(&nbsp;
      7)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













      <b>Va</b> entered as: anisotropic acoustic-optical coupling
      [meV2/rlu2]<br>
      &nbsp; p(&nbsp;
      8)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













      <b>w0</b> soft mode frequency at q=0, depends on temperature [meV]<br>
      &nbsp; p(&nbsp;
      9)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













      <b>Gamma</b> Damped Harmonic Oscillator width in energy [meV]<br>
      &nbsp; p( 10)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Temperature</b>
      [K]<br>
      &nbsp; p(
      11)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Amplitude</b><br>
      &nbsp; p(
      12)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Background</b><br>
    </blockquote>
    The axes needed for the evaluation are expressed in rlu for QH,QK,QL
    and in meV for the energy.<br>
    <br>
    The <b>plot (surf), plot3, scatter3</b>, and <b>slice</b> methods
    for plotting all provide nice looking rendering of volume data. See
    <a href="Plot.html#mozTocId734523">Plot/3D</a> page.<br>
    <br>
    There are predefined parameter settings for <font color="#cc33cc">'KTaO3'</font>,
    <font color="#cc33cc">'SrTiO3'</font> and <font color="#cc33cc">'BaTiO3'</font>
    crystals.<br>
    A usage example is:<a href="images/Models_sqw_vaks.png"><img
        alt="sqw_vaks" title="sqw_vaks" src="images/Models_sqw_vaks.png"
        height="151" width="200" align="right" border="0"></a><br>
    <pre>	&gt;&gt; s=<font color="#3366ff">sqw_vaks</font>(<font color="#cc33cc">'KTaO3'</font>); 		<i>% create model, with KTaO3 parameters</i><br>	&gt;&gt; qh=<font color="#3366ff">linspace</font>(0,.5,50);qk=qh; ql=qh; w=<font color="#3366ff">linspace</font>(0.01,10,51);<br> 	&gt;&gt; f=<font color="#3366ff">iData</font>(s,[],qh,qk,ql,w); 		<i>% evaluate model into an iData</i><br>	&gt;&gt; <font color="#3366ff">scatter3</font>(log(f(:,:,1,:)),'filled');	<i>% plot</i> ql(1)=0 plane<br></pre>
    <i><br>
    </i><i> </i><i><b>References:</b></i><br>
    <ul>
      <li>E. Farhi et al, <i>EPJB</i>, <b>15</b> (2000) pp 615-623.
        DOI: 10.1007/s100510051164 </li>
      <li> A.K. Tagantsev et al, <i>Nature Comm</i>, <b>4</b> (2013)
        2229. <a
href="http://www.nature.com/ncomms/2013/130729/ncomms3229/abs/ncomms3229.html">DOI:












          10.1038/ncomms3229</a></li>
      <li> V.G. Vaks,<i> Introduction to the Microscopic Theory of
          Ferroelectrics</i> (Nauka, Moscow, 1973)</li>
    </ul>
    <h4><a class="mozTocH4" name="mozTocId885605"></a>Acoustic phonon
      dispersion in mono-atomic cubic crystal</h4>
    The <b>sqw_cubic_monoatomic</b> model provides 3 acoustic <a
      href="https://en.wikipedia.org/wiki/Phonon">phonon</a> dispersions
    from a dynamical matrix computation. It uses only 2 parameters for
    these 3 modes, plus additional DHO parameters. Each dispersion is
    basically:<br>
    <blockquote><i>w(k) = Emax*sin(k.a) </i><i>&nbsp;&nbsp;&nbsp;
        &nbsp;&nbsp;&nbsp; </i>along principal axes.<br>
    </blockquote>
    The dynamical matrix is 3x3 with sine and cosine terms. Eigenvalues
    provide the mode energies.<br>
    <br>
    <table style="text-align: left; width: 1016px; height: 59px;"
      border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">S(q,w)<br>
          </td>
          <td style="vertical-align: top; background-color: rgb(255,
            204, 204);"><span style="font-style: italic; font-weight:
              bold; color: rgb(51, 102, 255);">Description</span><br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Dimensionality<br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Parameters<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><b>sqw_</b><b>cubic_monoatomic</b></td>
          <td valign="top">Phonon dispersions in a monoatomic cubic
            crystal using the Dynamical matrix. </td>
          <td valign="top"><font color="#33cc00">4D (HKLw)</font><br>
            <a href="images/Models_sqw_cubic_mono.png"><img
                alt="sqw_cubic_mono" title="sqw_cubic_mono"
                src="images/Models_sqw_cubic_mono.png" height="76"
                width="100" align="middle" border="0"></a></td>
          <td valign="top">acoustic force constant ratio and scaling
            energy<br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    The model parameters are the following:<br>
    <blockquote>&nbsp; p(&nbsp;
      1)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













      <b>C_ratio</b> C1/C2 force constant ratio first/second neighbours<a
        href="images/Models_sqw_cubic_mono.png"><img
          alt="sqw_cubic_mono" title="sqw_cubic_mono"
          src="images/Models_sqw_cubic_mono.png" height="152"
          width="200" align="right" border="0"></a><br>
      &nbsp; p(&nbsp;
      2)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

















      <b>E0</b> sqrt(C1/m) energy [meV]<br>
      &nbsp; p(&nbsp;
      3)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;














      <b>Gamma</b> Dampled Harmonic Oscillator width in energy [meV]<br>
      &nbsp; p(&nbsp;
      4)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Temperature</b>
      [K]<br>
      &nbsp; p(&nbsp;
      5)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Amplitude</b><br>
      &nbsp; p(&nbsp;
      6)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Background</b><br>
    </blockquote>
    The axes needed for the evaluation are expressed in <i>rlu</i> for
    QH,QK,QL and in meV for the energy.<br>
    <br>
    A usage example is:<br>
    <pre>	&gt;&gt; s=<font color="#3366ff">sqw_cubic_monoatomic</font>([ 3 3 ]); 	<i>% create model, with C1/C2=3 E0=3</i><br>	&gt;&gt; qh=<font color="#3366ff">linspace</font>(0,.5,50);qk=qh; ql=qh; w=<font color="#3366ff">linspace</font>(0.01,10,51);<br> 	&gt;&gt; f=<font color="#3366ff">iData</font>(s,[],qh,qk,ql,w); 		<i>% evaluate model into an iData</i><br>	&gt;&gt; <font color="#3366ff">plot3</font>(log(f(:,:,1,:)));	<i>	% plot </i><i>ql(1)=0 plane</i><br></pre>
    The <b>plot (surf), plot3, scatter3</b>, and <b>slice</b> methods
    for plotting all provide nice looking rendering of volume data. See
    <a href="Plot.html#mozTocId734523">Plot/3D</a> page.<br>
    <br>
    <i> </i><i><b>References:</b></i><br>
    <blockquote>E. Meisterhofer &lt;<a
        href="http://lampx.tugraz.at/%7Ehadley/ss1/phonons/scdos/sc.pdf">http://lampx.tugraz.at/~hadley/ss1/phonons/scdos/sc.pdf</a>&gt;













      2013<br>
      Kittel, Solid State Physics, Wiley, New York, 7th ed. (1996), pp
      99-103.<br>
      <br>
    </blockquote>
    <ul>
    </ul>
    <h4><a class="mozTocH4" name="mozTocId990577"></a>Phonon dispersion
      from <i>ab-initio</i> force estimate and dynamical matrix<br>
    </h4>
    <p>The <b>sqw_phonons</b> model computes phonon dispersions using
      the <a href="https://wiki.fysik.dtu.dk/ase/">Atomic Simulation
        Environment</a> (ASE). The only needed input for the model to
      run is the name of a configuration file describing the material
      lattice and atom positions. This file can be in any <a
        href="https://wiki.fysik.dtu.dk/ase/ase/io.html#module-ase.io">ASE














        supported format</a>, e.g. <a
        href="http://cms.mpi.univie.ac.at/vasp/guide/node59.html">POSCAR</a>,
      <a
        href="http://en.wikipedia.org/wiki/Crystallographic_Information_File">CIF</a>,
      <a href="http://www.rcsb.org/pdb/">PDB</a>, ... This model
      requires to install external software on the computer. See <a
        href="#mozTocId183326"><i>Requirements</i></a> below.<br>
    </p>
    <table style="text-align: left; width: 1016px; height: 59px;"
      border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">S(q,w)<br>
          </td>
          <td style="vertical-align: top; background-color: rgb(255,
            204, 204);"><span style="font-style: italic; font-weight:
              bold; color: rgb(51, 102, 255);">Description</span><br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Dimensionality<br>
          </td>
          <td style="vertical-align: top; font-weight: bold; font-style:
            italic; color: rgb(51, 102, 255); background-color: rgb(255,
            204, 204);">Parameters<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><b>sqw_phonons<br>
              <img alt="ase" title="ase" src="images/ase256.png"
                height="80" width="80" align="middle"><br>
            </b></td>
          <td valign="top">Phonon dispersions from the Dynamical matrix,
            using forces estimated by <i>ab-initio </i>using <a
              href="https://wiki.fysik.dtu.dk/ase">ASE</a> and a
            selection of DFT codes (EMT, GPAW, ABINIT, Elk, Dacapo,
            NWChem, QuantumEspresso, VASP). </td>
          <td valign="top"><font color="#33cc00">4D (HKLw)</font><br>
            <a href="images/Models_sqw_ph_ase.png"><img
                src="images/Models_sqw_ph_ase.png" title="sqw_ph_ase Al
                fcc" alt="sqw_ph_ase Al fcc" height="74" width="100"
                align="left" border="0"></a></td>
          <td valign="top">Creation: <a
              href="http://cms.mpi.univie.ac.at/vasp/guide/node59.html">POSCAR</a>,
            <a
              href="http://en.wikipedia.org/wiki/Crystallographic_Information_File">CIF</a>,
            <a href="http://www.rcsb.org/pdb/">PDB</a>, ...<br>
            Then, only the DHO line shape. <i>ab-initio</i> implies no
            (few) tunable parameter.<br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    The procedure is entirely automatic. A supercell is automatically
    generated, then forces are estimated by differentiation of a set of
    atom displacements. Temporary data files are created. The model can
    then be evaluated onto an HKLE trajectory, and plotted.<br>
    <h5><a class="mozTocH5" name="mozTocId716147"></a> <i><u>A few
          words about the theory</u></i></h5>
    The dynamical matrix <i>D</i> is defined as:<br>
    <blockquote><i>D</i><i><sub>&#945;</sub></i><i><sub>&#946;</sub></i><i>=1/&#8730;(M</i><i><sub>&#945;</sub></i><i>M</i><i><sub>&#946;</sub></i><i>)
        &#8706;</i><i><sup>2</sup></i><i>V/(&#8706;u</i><i><sub>&#945;</sub></i><i>&#8706;u</i><i><sub>&#946;</sub></i><i>)
      </i>where <i>V</i> is the inter-atomic potential, <i>M</i> is
      the atom mass, <i>&#945;</i><i>&#946;</i> are atom indices, <i>u</i> is
      the displacement of these atoms around their equilibrium position.<i><sub><br>
        </sub></i></blockquote>
    The equation of motions is then:<br>
    <blockquote><i>d</i><i><sup>2</sup></i><i>u</i><i><sub>&#945;</sub></i><i>/dt</i><i><sup>2</sup></i><i>
        = - &#8721; D</i><i><sub>&#945;</sub></i><i><sub>&#946;</sub></i><i>.u</i><i><sub>&#946;</sub></i></blockquote>
    In order to simplify this expression, we assume a periodic motion:<br>
    <blockquote><i>u</i><i><sub>&#945;</sub></i><i>=U</i><i><sub>&#945;</sub></i><i>(k)













        e </i><i><sup>i(<b>k.r</b> - &#969;t</sup></i><i><sup>)</sup></i><br>
    </blockquote>
    where <b><i>r</i></b> is the position of the atom in a so-called <i>super-cell</i>,
    which replicates the lattice primitive cell, and its extent sets the
    potential extension distance, which is assumed to vanish at long
    distance. <i><b>k</b></i> and &#969; are the momentum and energy of the
    wave. <br>
    <br>
    The methodology is then to displace each atom by a small quantity,
    then compute the force <i><b>F</b></i> acting on the atom to
    restore the equilibrium. This step is commonly achieved by an <a
      href="https://en.wikipedia.org/wiki/Ab_initio_quantum_chemistry_methods"><i>ab-initio</i></a>
    code such as <a href="https://www.vasp.at/">VASP</a>, <a
      href="http://www.abinit.org/">ABINIT</a> and <a
      href="http://www.quantum-espresso.org/">QuantumEspresso</a>. Then
    the potential <i>V </i>is estimated by differentiating the force
    as <b>F</b><i> = -&#8711;V</i> after displacing atoms by small
    quantities. Finally, the dynamical matrix is computed for each
    desired wave-vector <i><b>k</b></i>, and its eigen-modes are
    extracted. Currently, there are a few packages which do perform the
    dynamical matrix estimate and diagonalisation steps, among which <a
      href="http://www.homepages.ucl.ac.uk/%7Eucfbdxa/phon/">PHON</a>, <a
      href="http://wolf.ifj.edu.pl/phonon/">PHONON</a>, <a
      href="https://wiki.fysik.dtu.dk/ase">ASE</a> and <a
      href="http://phonopy.sourceforge.net/">PhonoPy</a>. We here use
    ASE or PHON.<br>
    <h5><a class="mozTocH5" name="mozTocId891630"></a><b><i><u>Syntax</u></i></b></h5>
    The simplest syntax is to call:<br>
    <blockquote><img alt="sqw_ph_ase_gui" title="sqw_ph_ase_gui"
        src="images/Models_sqw_ph_ase_gui.png" height="168" width="200"
        align="right">s = <font color="#3366ff">sqw_phonons</font>(<font
        color="#cc33cc">'gui'</font>); &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <i>%
        displays an entry dialog box</i><i> and proceeds with a fully
        automatic computation, and plots final results. With
        QuantumEspresso, a dialog may show up to select
        pseudo-potentials when there is more than one choice.</i><br>
    </blockquote>
    The general syntax for creating&nbsp; the S(q,w) model is any of:<br>
    <blockquote>s = <font color="#3366ff">sqw_phonons</font>;&nbsp;&nbsp;&nbsp;














      &nbsp;&nbsp;&nbsp; <i>% creates a simple fcc Al model</i><br>
    </blockquote>
    <blockquote>s = <font color="#3366ff">sqw_phonons</font>(configuration);<br>
    </blockquote>
    <blockquote>s = <font color="#3366ff">sqw_phonons</font>(configuration,













      options, ...);<br>
      <br>
      s = <font color="#3366ff">sqw_phonons</font>(configuration,
      calculator, options, ...);<br>
    </blockquote>
    Once created, we recommend to save the model with:<br>
    <blockquote>&gt;&gt; save <font color="#cc33cc">'my_model'</font>
      model<br>
    </blockquote>
    You can later load this model again within iFit, without the need to
    recompute forces (which may be a long process with DFT codes).<br>
    <blockquote>&gt;&gt; load <font color="#cc33cc">'my_model'</font><br>
    </blockquote>
    <blockquote> </blockquote>
    <p>The model parameters, once built, are the following:<br>
    </p>
    <blockquote>&nbsp; p(&nbsp;
      1)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Amplitude</b><br>
      &nbsp; p(&nbsp;
      2)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;













      <b>Gamma</b>&nbsp; Damped Harmonic Oscillator width in energy
      [meV]<br>
      &nbsp; p(&nbsp;
      3)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Background</b><br>
      &nbsp; p(&nbsp;
      4)=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Temperature</b>&nbsp;













      [K]<br>
    </blockquote>
    The axes needed for the evaluation are expressed in <i>rlu</i> for
    QH,QK,QL and in meV for the energy. The model can be evaluated by
    giving axes and model parameters (see examples below). The resulting
    <a href="iData.html"> iData</a> object can then be <a
      href="Plot.html">plotted</a>, such as in the following example
    (grid max energy 50 meV):<br>
    <pre>	&gt;&gt; qh=<font color="#3366ff">linspace</font>(0.01,.5,50);qk=qh; ql=qh; w=<font color="#3366ff">linspace</font>(0.01,50,51);<br> 	&gt;&gt; f=<font color="#3366ff">iData</font>(s,[],qh,qk,ql,w); 		<i>% evaluate model into an iData</i><br><i> 	</i>&gt;&gt; <font color="#3366ff">plot3</font>(log(f(1,:,:,:)));	<i>	% plot QH=0 plane
</i></pre>
    <blockquote> </blockquote>
    <h5><a class="mozTocH5" name="mozTocId880915"></a> <u><i>The system
          configuration (atoms, unit cell)</i></u></h5>
    The <i>configuration</i> is the location of any file format
    supported by ASE, which describes the system geometry (atom types
    and positions in the cell). In addition, the system configuration
    can be given as a bulk, molecule, crystal and nano-tube constructors
    from ASE.<br>
    <br>
    <table width="100%" border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td valign="top"><b>configuration</b><b><br>
            </b></td>
          <td valign="top"><b>Description</b><b><br>
            </b></td>
        </tr>
        <tr>
          <td valign="top">a file name<br>
            <font color="#cc33cc">[ ifitpath 'Data/POSCAR_Al']</font><br>
          </td>
          <td valign="top">Any file format supported by ASE, including
            CIF, ETSF, Gromacs, LAMMPS, PDB, SHELX, VASP/POSCAR,
            MaterialStudio, XYZ. See <a
              href="https://wiki.fysik.dtu.dk/ase/ase/io.html#module-ase.io">full</a>
            list.<a
              href="https://wiki.fysik.dtu.dk/ase/ase/io.html#module-ase.io"></a></td>
        </tr>
        <tr>
          <td valign="top"><font color="#cc33cc">'<b>bulk</b>("Cu",
              "fcc", a=3.6, cubic=True)'</font><br>
            <div align="center"><img alt="bulk" title="bulk"
                src="images/Models_Cubic.png" height="77" width="77"><br>
            </div>
          </td>
          <td valign="top">A bulk material, with formula (Cu, MgO,
            NaCl), lattice constant and structure (sc, fcc, bcc, hcp,
            diamond, zincblende, rocksalt, cesiumchloride, fluorite or
            wurtzite). See description of <a
href="https://wiki.fysik.dtu.dk/ase/ase/structure.html#bulk-crystal-section">bulk</a>.<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><font color="#cc33cc">'<b>molecule</b>("isobutane")'</font><br>
            <div align="center"><img alt="molecule" title="molecule"
                src="images/Models_Molecule_butane.png" height="73"
                width="84"><br>
            </div>
          </td>
          <td valign="top">Any <a
              href="https://wiki.fysik.dtu.dk/ase/ase/structure.html">molecule













              known to ASE</a>, e.g.<small><small> 'isobutene',
                'CH3CH2OH', 'CH3COOH', 'COF2', 'CH3NO2', 'CF3CN',
                'CH3OH', 'CCH', 'CH3CH2NH2', 'PH3', 'Si2H6', 'O3', 'O2',
                'BCl3', 'CH2_s1A1d', 'Be', 'H2CCl2', 'C3H9C', 'C3H9N',
                'CH3CH2OCH3', 'BF3', 'CH3', 'CH4', 'S2', 'C2H6CHOH',
                'SiH2_s1A1d', 'H3CNH2', 'CH3O', 'H', 'BeH', 'P',
                'C3H4_C3v', 'C2F4', 'OH', 'methylenecyclopropane',
                'F2O', 'SiCl4', 'HCF3', 'HCCl3', 'C3H7', 'CH3CH2O',
                'AlF3', 'CH2NHCH2', 'SiH2_s3B1d', 'H2CF2', 'SiF4',
                'H2CCO', 'PH2', 'OCS', 'HF', 'NO2', 'SH2', 'C3H4_C2v',
                'H2O2', 'CH3CH2Cl', 'isobutane', 'CH3COF', 'HCOOH',
                'CH3ONO', 'C5H8', '2-butyne', 'SH', 'NF3', 'HOCl',
                'CS2', 'P2', 'C', 'CH3S', 'O', 'C4H4S', 'S', 'C3H7Cl',
                'H2CCHCl', 'C2H6', 'CH3CHO', 'C2H4', 'HCN', 'C2H2',
                'C2Cl4', 'bicyclobutane', 'H2', 'C6H6', 'N2H4',
                'C4H4NH', 'H2CCHCN', 'H2CCHF', 'cyclobutane', 'HCl',
                'CH3OCH3', 'Li2', 'Na', 'CH3SiH3', 'NaCl', 'CH3CH2SH',
                'OCHCHO', 'SiH4', 'C2H5', 'SiH3', 'NH', 'ClO', 'AlCl3',
                'CCl4', 'NO', 'C2H3', 'ClF', 'HCO', 'CH3CONH2',
                'CH2SCH2', 'CH3COCH3', 'C3H4_D2d', 'CH', 'CO', 'CN',
                'F', 'CH3COCl', 'N', 'CH3Cl', 'Si', 'C3H8', 'CS', 'N2',
                'Cl2', 'NCCN', 'F2', 'CO2', 'Cl', 'CH2OCH2', 'H2O',
                'CH3CO', 'SO', 'HCOOCH3', 'butadiene', 'ClF3', 'Li',
                'PF3', 'B', 'CH3SH', 'CF4', 'C3H6_Cs', 'C2H6NH', 'N2O',
                'LiF', 'H2COH', 'cyclobutene', 'LiH', 'SiO', 'Si2',
                'C2H6SO', 'C5H5N', 'trans-butane', 'Na2', 'C4H4O',
                'SO2', 'NH3', 'NH2', 'CH2_s3B1d', 'ClNO', 'C3H6_D3h',
                'Al', 'CH3SCH3', 'H2CO', 'CH3CN'</small></small><br>
          </td>
        </tr>
        <tr>
          <td valign="top"><font color="#cc33cc">'<b>nanotube</b>(6, 0,
              length=4)'</font><br>
            <div align="center"><img alt="nanotube" title="nanotube"
                src="images/Models_Nanotube.png" height="71" width="136"><br>
            </div>
            <br>
          </td>
          <td valign="top">A carbon (or other material) nanotube. See
            description of <a
              href="https://wiki.fysik.dtu.dk/ase/ase/structure.html#nanotubes">nanotube</a>.<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><font color="#cc33cc">'<b>crystal</b>(...)'</font><br>
          </td>
          <td valign="top">The generic crystal builder from ASE. See
            description <a
href="https://wiki.fysik.dtu.dk/ase/tutorials/spacegroup/spacegroup.html">here</a>.<br>
          </td>
        </tr>
      </tbody>
    </table>
    <div align="center"><i>The different possibilities to specify an
        atomic system/molecule in </i><i><b>sqw_phonons</b></i><i>.</i><br>
    </div>
    <br>
    You may look at the following resources to get material structure
    files:<br>
    <ul>
      <li>MaterialsProject&lt;<a
          href="https://www.materialsproject.org/">https://www.materialsproject.org/</a>&gt;

        using VASP</li>
      <li>PhononDB &lt;<a href="http://phonondb.mtl.kyoto-u.ac.jp/">http://phonondb.mtl.kyoto-u.ac.jp/</a>&gt;

        using PhonoPy and VASP. Makes use of the MaterialsProject.</li>
      <li>NoMaD repository &lt;<a href="http://nomad-repository.eu/cms/">http://nomad-repository.eu/cms/</a>&gt;

        can store any computational result from e.g. ABINIT,
        QuantumEspresso, VASP, and others.</li>
    </ul>
    <h5><a class="mozTocH5" name="mozTocId912608"></a> <u><i> </i></u><u><i>General













          options</i></u> </h5>
    Other options, given as strings, or as a structure, allow to
    customise how to create the supercell and other computational tuning
    stuff.<br>
    More options can be obtained from '<i>help sqw_phonons</i>'<br>
    <ul>
      <li><b>target</b>: The <font color="#cc33cc">'target=LOCATION'</font>
        argument can be set to save these files to a defined directory,
        which must pre-exist. Without specification, a temporary
        directory will be used.</li>
      <li><b>supercell</b>: The <i>dimension of the supercell</i> can
        be given using e.g. the <font color="#cc33cc">'supercell=3'</font>
        (for a 3x3x3 supercell) argument, or <font color="#cc33cc">'supercell=[2













          3 2]'</font>.</li>
      <li><b>calculator</b>: the calculator to use, see below.</li>
      <li><b>dos</b>: indicates if the phonon density of states should
        be computed, which takes more time. Default is NOT to compute
        it.</li>
      <li><b>potentials</b>: pseudo potential directory to use, e.g. <font
          color="#cc33cc">'/usr/share/elk-lapw/species'</font>, <font
          color="#cc33cc">'/usr/share/abinit/psp'</font>, <font
          color="#cc33cc">'/usr/share/dacapo-psp'</font>,<font
          color="#cc33cc">'/usr/share/espresso/pseudo'</font>.</li>
      <li><b>diagonalization</b>: <font color="#cc33cc">'david'</font>
        or <font color="#cc33cc">'cg'</font>. or <font color="#cc33cc">'rmm-diis'</font>.
        The Davidson method is faster than the conjugate-gradient but
        uses more memory. The RMM-DIIS is even faster.<br>
      </li>
      <li><b>autoplot</b>: evaluates the model on QH=0 plane, and plot
        it.</li>
      <li><b>mpi</b>: The number of CPU's to use can be set with option
        e.g <font color="#cc33cc">'mpi=4'</font>. This option requires
        e.g. <a href="http://www.open-mpi.org/">OpenMPI</a> to be
        installed, and is only validated on Linux systems (<i>sudo
          apt-get install openmpi-bin</i>). All codes support MPI. <i><b>Remember</b></i>
        that the memory usage increases linearly with the number of
        processors involved, so in practice you should have about 2GB
        per CPU requested. For a 16 GB node, you can safely use 8 CPUs.<br>
      </li>
      <li><b>command</b>: specify the calculator executable which may
        include e.g. "mpirun -np N" when applicable (and options.mpi
        should not be set).</li>
      <li><b>htmlreport:</b> when set to 1, creates a readable report as
        an HTML document '<i>index.html</i>' in the target directory.</li>
      <li><b>email</b>: send an email to the specified address on
        start-up and end of the computation. This requires the machine
        to be connected to the Internet. Proxy servers can not be
        passed.<br>
      </li>
    </ul>
    and specific DFT related options<br>
    <ul>
      <li><b> occupations</b>: For metallic and insulator systems, the <i>electron













          state occupations</i> should be set by using argument <font
          color="#cc33cc">'metal'</font> or <font color="#cc33cc">'insulator'</font>,
        or <font color="#cc33cc">'occupations=smearing'</font> or<font
          color="#cc33cc"> 'occupations=fixed'</font>. You can also
        directly specify the smearing width as <font color="#cc33cc">'occupations=&lt;value&gt;'</font>
        assuming a Fermi Dirac distribution. The unit is eV.</li>
      <li><b> kpoints</b>: The size of the <i>Monkhorst-Pack grid</i>
        can be set using e.g. <font color="#cc33cc">'kpoints=3'</font>
        or <font color="#cc33cc">'kpoints=[3 4 3]'</font>. For
        gamma-point (liquids) use kpoints=0. In order to compute
        realistic phonon dispersions, the k-points value should be at
        least 3. Values lower should only be used for testing.<br>
      </li>
      <li><b>xc</b>: type of Exchange-Correlation functional to use,
        e.g. default <font color="#cc33cc">'xc=PBE'</font>. Other
        choices<font color="#cc33cc"> 'LDA','revPBE','RPBE'</font>,...</li>
      <li><b> ecut</b>: The <i>kinetic energy cutoff</i> for
        wavefunctions can also be specified using e.g. argument <font
          color="#cc33cc">'ecut=340'</font>. The unit is eV. A good
        estimate is to use [200*the number of different atoms].</li>
      <li><b>ecutrho (optional)</b>: kinetic energy cutoff for charge
        density and potential. Typical=4*ecut, suitable for PAW. Larger
        value improves convergence, especially for ultra-soft PP (you
        should then use 8-12*ecut). Leave it undefined to let the
        calculator determine it.</li>
      <li><b>nsteps (optional)</b>: max number of iterations for SCF.
        Larger value improves convergence. Leave it undefined to let the
        calculator determine it.</li>
      <li><b>nbands (optional)</b>: Number of valence bands for which
        wavefunctions are being computed. Should be the number of
        electrons /2 and for a metal, 20% more (minimum 4 more). Leave
        it undefined to let the calculator determine it.<br>
      </li>
      <li><b>toldfe (optional): </b>Convergence threshold on the energy
        for selfconsistency. Typical value is 1e-6. Leave it undefined
        to let the calculator determine it.</li>
    </ul>
    <h5><a class="mozTocH5" name="mozTocId913674"></a> <u>Specific
        options for ABINIT</u></h5>
    <ul>
      <li><b>iscf</b>: type of self-consistent cycle. Can be <font
          color="#cc33cc">'NC'</font> (norm-conserving) and <font
          color="#cc33cc">'PAW'</font>.</li>
      <li><b>potentials</b>: can be a directory path, as well as also
        one of <font color="#cc33cc">'NC' 'fhi' 'hgh' 'hgh.sc' 'hgh.k'
          'tm' 'paw'</font>.</li>
      <li><b>pps</b>: Type of pseudo potential database, any of <font
          color="#cc33cc">'fhi' 'hgh' 'hgh.sc' 'hgh.k' 'tm' 'paw'</font><span
          class="st"> which stand for Fritz-Haber-Institute,
          Hartwigsen-Goedeker-Hutter (with/without semi-core valence
          electrons), Troullier-Martins and Projector-Augmented-Wave.
          Default is <font color="#cc33cc">'fhi'</font>.<br>
        </span></li>
    </ul>
    <h5><a class="mozTocH5" name="mozTocId486503"></a><u>Specific
        options for GPAW</u></h5>
    <ul>
      <li><b>mode</b>: GPAW computation mode as Plane-Wave, Finite
        Difference, or LCAO (linear combination of atomic orbitals). Can
        be <font color="#cc33cc">'pw','fd',</font> or <font
          color="#cc33cc">'lcao'</font>. Default is <font
          color="#cc33cc">'fd'</font>.</li>
    </ul>
    <ul>
    </ul>
    <h5><a class="mozTocH5" name="mozTocId902505"></a><u><i>Specific
          options for QuantumEspresso/PHON</i></u></h5>
    <p>The <i>pseudopotentials</i><i> </i>are given as many
      filenames/directories (UPF format) suitable for QuantumEspresso.
      When not given, available potentials will be searched in current
      location, the Home directory, and the standard QuantumEspresso
      locations (PSEUDO_DIR, $HOME/espresso/pseudo). When more than one
      potential is available for an atom type, a list selector is
      displayed to request which one to choose. The PBE-PAW potentials
      are preferred and pre-selected. Pseudo-potential can be obtained
      at <a href="http://www.quantum-espresso.org/pseudopotentials/">QuantomEspresso














        PP selector</a>.</p>
    <ul>
      <li><b>disp</b>: The generation of the supercell and the forces
        can be tuned by choosing the <i>initial atom displacement</i>,
        or a random one. Use e.g. <font color="#cc33cc">'disp=[ 1 -1
          1]' </font>or <font color="#cc33cc">'disp=random'</font> or
        <font color="#cc33cc">'random'</font> as argument. </li>
      <li><b>potential_auto</b>: when set to 1, a 'good'
        pseudo-potential will automatically be chosen (e.g. PBE/PAW).</li>
      <li><b>potentials</b>: a list (cell) of UPF potential files to
        use. You may also specify a directory. If not specified, the
        user will be prompted for a list of sensible potentials, to
        select one per atom. The <b>potential_auto=1</b> skips the
        potential selection dialog, and selects a 'good' potential (PBE
        PAW). A typical location is '/usr/share/espresso/pseudo'.</li>
      <li><b>mixing_ndim</b>: number of iterations used in mixing,
        default=8. If you are tight with memory, you may reduce it to 4.
        A larger value will improve the SCF convergence, and use more
        memory.</li>
      <li><b>mixing_beta</b>: mixing factor for self-consistency,
        default=0.7. use 0.3 to improve convergence.</li>
    </ul>
    <blockquote> If you have difficulties in the model SCF convergence,
      you may use e.g:<br>
      <pre>  &gt;&gt; s=<font color="#3366ff">sqw_phonons</font>(POSCAR,<font color="#cc33cc">'QuantumEspresso'</font>, <font color="#cc33cc">'random'</font>,<font color="#cc33cc">'nsteps=200; toldfe=1e-6; occupations=smearing; ecut=500; mixing_ndim=12; </font><font color="#cc33cc"><font color="#cc33cc">miximg_beta=0.3;</font>'</font>);</pre>
      If you are tight on the memory (e.g. the system is large), you may
      try:<br>
      <pre>  &gt;&gt; s=<font color="#3366ff">sqw_phonons</font>(POSCAR,<font color="#cc33cc"><font color="#cc33cc">'QuantumEspresso', </font>'random'</font>,<font color="#cc33cc">'ecut=15; mixing_ndim=4; diagonalization=cg'</font>);</pre>
    </blockquote>
    <h5><a class="mozTocH5" name="mozTocId577034"></a><u>Choosing a
        calculator (DFT code)</u></h5>
    <p>The <b>sqw_phonons</b> model may use any of the calculators
      listed below:<br>
    </p>
    <table width="100%" border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td valign="top"><b><font color="#cc33cc">'calculator=...'</font></b><br>
          </td>
          <td valign="top"><b>Description</b><br>
          </td>
          <td valign="top"><b>time elapsed</b> [s]<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><img alt="emt" title="emt"
              src="images/emt.png" height="50" width="71" align="middle">&nbsp;<a
href="https://wiki.fysik.dtu.dk/ase/ase/calculators/emt.html">EMT</a></td>
          <td valign="top">Effective Medium Theory calculator (<b>only</b>
            for Al,Cu,Ag,Au,Ni,Pd,Pt,H,C,N,O). Very fast, but limited.<br>
          </td>
          <td valign="top">0.3<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><b><img alt="qe" title="qe"
                src="images/logo_qe.jpg" height="34" width="80"
                align="middle"></b><a
              href="http://www.quantum-espresso.org/">QuantumEspresso</a></td>
          <td valign="top">Density-functional theory, plane waves, and
            pseudopotentials based code for electronic-structure
            calculations and materials modeling. When using this option
            through ASE, the input file is converted to POSCAR, and
            makes use of <a
              href="http://chianti.geol.ucl.ac.uk/%7Edario">PHON</a> and
            <a href="http://www.quantum-espresso.org/">Quantum Espresso</a>.
          </td>
          <td valign="top">76<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><a href="http://www.abinit.org/"><img
                alt="abinit" title="abinit" src="images/abinit.png"
                height="34" width="80" align="middle" border="0"></a><a
              href="http://www.abinit.org/">&nbsp;ABINIT</a></td>
          <td valign="top">Plane-wave pseudopotential code</td>
          <td valign="top">74<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><a href="https://www.vasp.at/"><img
                alt="vasp" title="vasp" src="images/vasp.png"
                height="50" width="77" align="middle" border="0"></a><a
              href="https://www.vasp.at/">VASP</a><br>
          </td>
          <td valign="top">Plane-wave PAW code. <b><i>Requires a
                specific licens</i></b><b>e.</b><br>
          </td>
          <td valign="top">126<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><a href="http://wiki.fysik.dtu.dk/gpaw"><img
                alt="GPAW" title="GPAW" src="images/logo-gpaw.png"
                height="39" width="80" align="middle" border="0"> </a><a
              href="http://wiki.fysik.dtu.dk/gpaw">GPAW</a><a
              href="http://wiki.fysik.dtu.dk/gpaw"><br>
            </a></td>
          <td valign="top">Real-space/plane-wave/LCAO PAW code</td>
          <td valign="top">438<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><a href="https://wiki.fysik.dtu.dk/dacapo/"><img
                alt="jacapo" title="jacapo" src="images/jacapo.png"
                height="29" width="80" align="middle" border="0"></a><a
              href="https://wiki.fysik.dtu.dk/dacapo/">&nbsp;Dacapo</a></td>
          <td valign="top">Plane-wave ultra-soft pseudopotential code</td>
          <td valign="top">409<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><a href="http://elk.sourceforge.net/"><img
                alt="elk" title="elk" src="images/elk.png" height="47"
                width="81" align="middle" border="0"></a><a
              href="http://elk.sourceforge.net/">&nbsp;ELK</a></td>
          <td valign="top">Full Potential LAPW code</td>
          <td valign="top">600<br>
          </td>
        </tr>
        <tr>
          <td valign="top"><a href="http://www.nwchem-sw.org/"><img
                alt="nwchem" title="nwchem" src="images/nwchem.png"
                height="22" width="80" align="middle" border="0"></a><a
              href="http://www.nwchem-sw.org/">&nbsp;NWChem</a></td>
          <td valign="top">Gaussian based electronic structure code</td>
          <td valign="top">1300<br>
          </td>
        </tr>
      </tbody>
    </table>
    <div align="center"><i>The available calculators in </i><i><b>sqw_phonons</b></i><i>.
        We recommend QuantumEspresso and ABINIT (which may require </i><i>tuning</i><i>
        for better convergence).</i><i> The computation time is given
        for </i><i>(Al a=5.6) with 1 CPU, kpoints=3, ecut=340 eV. These
        times depend on the pseudo potential used and are only given as
        estimates.<br>
      </i></div>
    <br>
    Benchmarks indicate that, for phonon dispersions:<br>
    <ul>
      <li><a href="http://www.quantum-espresso.org/">Quantum Espresso</a>
        is the fastest, with excellent parallelization and accuracy.</li>
      <li><a href="http://www.abinit.org/">ABINIT</a>, <a
          href="https://www.vasp.at/">VASP</a> are also very efficient
        codes.</li>
      <li><a href="http://wiki.fysik.dtu.dk/gpaw">GPAW</a> and <a
          href="https://wiki.fysik.dtu.dk/dacapo/">Dacapo</a> are about
        5 times slower than QuantumEspresso.</li>
      <li>The all-electrons <a href="Elk">ELK</a> code is about 10
        times slower than QuantumEspresso.</li>
      <li>Using k-points=3 is both fast and ensures a reasonable
        accuracy in phonons</li>
      <li>Phonon dispersions are not too sensitive on the energy
        cut-off. 340 eV is good.</li>
      <li>Elk and ABINIT can not handle large supercells without
        recompiling.</li>
      <li>NWChem and Elk are hardly sensitive to the energy cut-off.</li>
      <li>NWChem has good parallelization performance, but remains very
        slow compared to all the others.<br>
      </li>
    </ul>
    <h5><a class="mozTocH5" name="mozTocId715775"></a><u>Convergence
        issues: what to try</u></h5>
    <p>It is generally recommended to use the following settings for
      very accurate phonon band computations:<br>
    </p>
    <ul>
      <li><b>kpoints</b>=6 (or at least 4x4x4). <i>kpoints=3</i> is
        suggested for a quick estimate.<br>
      </li>
      <li><b>ecut</b>=1500 [eV]. This depends on the crystal. Try 340 eV
        and gradually increase value for better accuracy.<br>
      </li>
      <li><b>smearing</b>=0.27 [eV] for most materials.<br>
      </li>
    </ul>
    <p></p>
    <p>If the SCF convergence fails, you may try: </p>
    <pre>  &gt;&gt; s=<font color="#3366ff">sqw_phonons</font>(POSCAR,<font color="#cc33cc"> 'nsteps=200; toldfe=1e-6; occupations=0.27; ecut=1500; </font><font color="#cc33cc">'</font>);</pre>
    For insulators, you may also use a very small smearing, e.g. 0.01
    eV.<br>
    If you are tight on the memory (e.g. the system is large), you may
    try:<br>
    <pre>  &gt;&gt; s=<font color="#3366ff">sqw_phonons</font>(POSCAR,<font color="#cc33cc"><font color="#cc33cc"> </font></font><font color="#cc33cc">'ecut=500; diagonalization=cg'</font>);</pre>
    <h5><a class="mozTocH5" name="mozTocId134538"></a><i><u>Examples</u></i></h5>
    A usage example is:<a href="images/Models_sqw_ph_ase.png"><img
        alt="sqw_ph_ase Al fcc" title="sqw_ph_ase Al fcc"
        src="images/Models_sqw_ph_ase.png" height="153" width="200"
        align="right" border="0"></a><br>
    <pre>	&gt;&gt; s=<font color="#3366ff">sqw_phonons</font>(<font color="#cc33cc">'bulk("Cu", "fcc", a=3.6)'</font>,<font color="#cc33cc">'EMT','metal'</font>); 	<i>% create model from bulk</i><br>	&gt;&gt; qh=<font color="#3366ff">linspace</font>(0.01,.5,50);qk=qh; ql=qh; w=<font color="#3366ff">linspace</font>(0.01,50,51);<br> 	&gt;&gt; f=<font color="#3366ff">iData</font>(s,[],qh,qk,ql,w); 		<i>% evaluate model into an iData</i><br>	&gt;&gt; <font color="#3366ff">plot3</font>(log(f(:,:,1,:)));	<i>	% plot ql=0 plane<br></i></pre>
    To get a system with acoustic and optical modes:<br>
    <pre>	&gt;&gt; s=<font color="#3366ff">sqw_phonons</font>(<font color="#cc33cc">[ ifitpath 'Data/POSCAR_AlN'</font>],<font color="#cc33cc">'EMT'</font>); 	<i>% create model from given POSCAR</i><br>	&gt;&gt; qh=<font color="#3366ff">linspace</font>(0.01,.5,50);qk=qh; ql=qh; w=<font color="#3366ff">linspace</font>(0.01,50,51);<br> 	&gt;&gt; f=<font color="#3366ff">iData</font>(s,[],qh,qk,ql,w); 		<i>% evaluate model into an iData</i><br>	&gt;&gt; <font color="#3366ff">scatter3</font>(log(f(:,:,1,:)));	<i>	% plot ql=0 plane with acoustic and optical modes</i></pre>
    In addition, the <a
      href="https://en.wikipedia.org/wiki/Density_of_states">phonon
      Density of States</a> can be computed, when specifying the <font
      color="#cc33cc">'dos'</font> options upon model creation. This
    computation can be rather intensive. It is then computed during the
    first model evaluation (subsequent evaluations will be faster), and
    stored in the model <i>UserData.DOS</i> so that it can be viewed
    with e.g. :<br>
    <pre>	&gt;&gt; s=<font color="#3366ff">sqw_phonons</font>(<font color="#cc33cc">[ ifitpath 'Data/POSCAR_Al'</font>],<font color="#cc33cc">'dos=1'</font>,<font color="#cc33cc">'EMT'</font>); 	<i>% create model from given POSCAR</i>, with DOS computation<br>	&gt;&gt; qh=<font color="#3366ff">linspace</font>(0.01,.5,50);qk=qh; ql=qh; w=<font color="#3366ff">linspace</font>(0.01,50,51);<br> 	&gt;&gt; f=<font color="#3366ff">iData</font>(s,[],qh,qk,ql,w); 		<i>% evaluate model into an iData<br></i> 	&gt;&gt; figure; <font color="#3366ff">plot</font>(s.UserData.DOS);</pre>
    The <b>plot (surf), plot3, scatter3</b>, and <b>slice</b> methods
    for plotting all provide nice looking rendering of volume data. See
    <a href="Plot.html#mozTocId734523">Plot/3D</a> page.<br>
    <h5><a class="mozTocH5" name="mozTocId168620"></a> <u><i><b>References</b></i></u></h5>
    <ul>
      <li> <a href="https://wiki.fysik.dtu.dk/ase">Atomic Simulation
          Environment</a> S. R. Bahn and K. W. Jacobsen, <i>Comput.
          Sci. Eng.</i>, Vol. <b>4</b>, 56-66, 2002.</li>
      <li> <a href="http://wiki.fysik.dtu.dk/gpaw">GPAW</a>&nbsp; J. J.
        Mortensen et al, <i>Phys Rev B</i>, Vol. <b>71</b>, 035109
        (2005). <a
          href="https://wiki.fysik.dtu.dk/gpaw/setups/setups.html">Pseudo-potentials</a>.</li>
      <li> <a href="http://www.nwchem-sw.org/">NWChem</a>&nbsp; M.
        Valiev et al, <i>Comput. Phys. Commun.</i> <b>181</b>, 1477
        (2010).</li>
      <li> <a href="http://elk.sourceforge.net">Elk</a> cite
        &lt;http://elk.sourceforge.net&gt;. <i><b>NOTE:</b></i> The Elk
        executable should be compiled with e.g. elk/src/modmain.f90:289
        maxsymcrys=1024 or larger to handle supercells. We provide an <a
href="http://packages.mccode.org/debian/dists/stable/main/binary-amd64/elk-lapw_3.3.17-1_amd64.deb">Elk-3.3.17</a>
        Debian package compiled with this setting.</li>
      <li> <a href="https://wiki.fysik.dtu.dk/dacapo/">DACAPO</a> B.
        Hammer et al, <i>Phys.Rev.</i><i> B</i> <b>59</b>, 7413
        (1999). <a
          href="https://wiki.fysik.dtu.dk/dacapo/Pseudopotential_Library">Pseudo-potentials</a>.</li>
      <li> <a href="http://www.abinit.org/">ABINIT</a> X. Gonze et al,
        <i>Computer Physics Communications</i> <b>180</b>, 2582-2615
        (2009). <a
          href="http://www.abinit.org/downloads/psp-links/pseudopotentials">Pseudo-potentials.</a></li>
    </ul>
    <ul>
      <li><a href="http://chianti.geol.ucl.ac.uk/%7Edario">PHON</a>: D.
        Alfe, <i>Computer Physics Communications</i> <b>180</b>,2622-2633













        (2009). &lt;<a href="http://chianti.geol.ucl.ac.uk/%7Edario">http://chianti.geol.ucl.ac.uk/~dario</a>&gt;.














        <br>
      </li>
      <li><a href="http://www.quantum-espresso.org/">Quantum Espresso</a>:
        P. Giannozzi, et al, <i>J.Phys.:Condens.Matter,</i> <b>21</b>,
        395502 (2009). &lt;<a href="http://www.quantum-espresso.org/">http://www.quantum-espresso.org/</a>&gt;.













        <a href="http://www.quantum-espresso.org/pseudopotentials/">Pseudo-potentials</a>.
        We also recommend the <a href="http://materialscloud.org/">SSSP
          library</a> for which we provide the <a
href="http://packages.mccode.org/debian/dists/stable/main/binary-amd64/quantum-espresso-sssp_5.0.2-5build3_all.deb">quantum-espresso-sssp</a>
        Debian package.</li>
      <li><a href="https://www.vasp.at/">VASP</a>: G. Kresse and J.
        Hafner. <i>Phys. Rev. B</i>, <b>47</b>:558, 1993. &lt;<a
          href="https://www.vasp.at/">https://www.vasp.at/</a>&gt;<br>
      </li>
    </ul>
    <h5><a class="mozTocH5" name="mozTocId183326"></a> <u><i><b>Requirements












            and installation</b></i></u></h5>
    The <a href="https://wiki.fysik.dtu.dk/ase">ASE</a> must be
    installed. Packages exist for Ubuntu/Mint/Debian, RedHat/Fedora,
    OpenSUSE, MacOSX (brew), and Windows (experimental). Type
    (Ubuntu/Mint/Debian):
    <blockquote>
      <blockquote> </blockquote>
      <pre>% sudo apt-get install python-ase<br></pre>
    </blockquote>
    External calculators should be installed separately. For Debian
    systems, we provide most packages at <a
      href="http://packages.mccode.org/">packages.mccode.org</a>. Type
    (Ubuntu/Mint/Debian):
    <blockquote>
      <pre>% sudo apt-add-repository 'deb http://packages.mccode.org/debian stable main'<br>% sudo apt-get update<br>% sudo apt-get install ifit elk-lapw dacapo dacapo-psp gpaw gpaw-setups nwchem nwchem-data python-matplotlib<br>% sudo apt-get install abinit abinit-doc abinit-psp quantum-espresso quantum-espresso-sssp phon libnetcdf-dev libxc1 openmpi-bin </pre>
    </blockquote>
    <blockquote><i><b>Note:</b></i> The <i>gpaw-setups</i> package is
      named <a href="http://packages.ubuntu.com/wily/gpaw-data"><i>gpaw-data</i></a>
      in Ubuntu distributions &gt;= 15.10.<br>
    </blockquote>
    Pseudo potentials:<br>
    The ABINIT code requires to install an additional library of pseudo
    potentials. We recommand to get it <a
href="http://wiki.fysik.dtu.dk/abinit-files/abinit-pseudopotentials-2.tar.gz"><i>here













        (ASE)</i></a> and extract it in <i>/usr/share/abinit/</i>. We
    provide the <a
href="http://packages.mccode.org/debian/dists/stable/main/binary-amd64/abinit-psp_2_all.deb">abinit-psp</a>
    package for Debian. You may alternatively install for ABINIT the
    package <a
      href="http://packages.ubuntu.com/vivid/all/abinit-data/download">abinit-data</a>
    (which provides a <i>limited</i> set of pseudo-potentials).<br>
    <br>
    The QuantumEspresso code requires to install an additional library
    of pseudo potentials. We recommend the <a
      href="http://materialscloud.org/">SSSP library</a> for which we
    provide the <a
href="http://packages.mccode.org/debian/dists/stable/main/binary-amd64/quantum-espresso-sssp_5.0.2-5build3_all.deb">quantum-espresso-sssp</a>
    Debian package.<br>
    <br>
    <h3><a class="mozTocH3" name="mozTocId810939"></a><span
        style="font-weight: bold;">Model builder: defining a new model
        easy</span></h3>
    The <span style="font-style: italic;">ifitmakefunc</span> tool
    enables to define a new fit function/model from a simple dialog, by
    entering its <a href="images/ifitmakefunc.png"><img
        title="ifitmakefunc" src="images/ifitmakefunc.png"
        alt="ifitmakefunc" style="border: 0px solid ; width: 150px;
        height: 137px;" align="right"></a>expression as a function of
    the parameter vector <span style="font-style: italic; font-weight:
      bold;">p</span> and the axes <span style="font-style: italic;
      font-weight: bold;">x,y,z</span><b>,t,u,v,w</b><br>
    <pre style="margin-left: 40px;">&gt;&gt; <span style="color: rgb(255, 0, 0);">h</span>=<span style="color: rgb(51, 102, 255);">ifitmakefunc;<br><span style="color: rgb(0, 0, 0);">&gt;&gt; h=</span>edit<span style="color: rgb(0, 0, 0);">(iFunc);	<span style="font-style: italic;">% equivalent</span></span><br></span></pre>
    The only required argument is the expression, but you may as
    well&nbsp; enter a function name and description, parameter names
    and default values, as well as a constraint to be evaluated before
    computing the function value. When started without any parameters,
    the Gaussian function settings are used.<br>
    <br>
    The function both creates a function file, and returns its model
    object, that may evaluate and adjust to a data set with <a
      href="Fit.html"><span style="font-weight: bold;">fits</span></a>.<br>
    <pre style="margin-left: 40px;">&gt;&gt; [p,criteria,message,output]= <span style="color: rgb(51, 102, 255);">fits</span>(a, <span style="color: rgb(255, 0, 0);">h</span><span style="color: rgb(204, 51, 204);"></span>);<br>&gt;&gt; [p,criteria,message,output]= <span style="color: rgb(51, 102, 255);">fits</span>(<span style="color: rgb(255, 0, 0);">h</span><span style="color: rgb(204, 51, 204);"></span>, a); <span style="font-style: italic;">% same as above</span><br></pre>
    A quick definition, without using the dialog, can be performed with
    the syntax:<br>
    <pre style="margin-left: 40px;">&gt;&gt; <span style="color: rgb(255, 0, 0);">h</span>=<span style="color: rgb(51, 102, 255);">ifitmakefunc<span style="color: rgb(0, 0, 0);">(<span style="color: rgb(204, 51, 204);">'p(1)*exp( (x-p(2))/p(3) )'</span>);</span></span><br>&gt;&gt; <span style="color: rgb(51, 102, 255);">fits</span>(a,<span style="color: rgb(51, 102, 255);">  iFunc<span style="color: rgb(0, 0, 0);">(<span style="color: rgb(204, 51, 204);">'p(1)*exp( (x-p(2))/p(3) )'</span>));</span></span> <span style="font-style: italic;">% same as above</span><br></pre>
    where&nbsp; <span style="font-weight: bold; font-style: italic;">p</span>
    is the vector that holds parameters. Axes are<span
      style="font-weight: bold; font-style: italic;"> x </span><span
      style="font-style: italic;">(rows)</span><span style="font-weight:
      bold; font-style: italic;">,y </span><span style="font-style:
      italic;">(columns)</span><span style="font-weight: bold;
      font-style: italic;">,z </span><span style="font-style: italic;">(pages)</span><span
      style="font-weight: bold; font-style: italic;">,t</span><span
      style="font-style: italic;"> (time)</span>. Beware to use a model
    expression with element-wise division and multiplication operators (<span
      style="font-weight: bold;">./</span> and <span
      style="font-weight: bold;">.*</span>). The function builder is
    known to work well for 1D and 2D functions.<br>
    <br>
    You can also build complex models from simpler ones using <a
      href="iFunc.html">iFunc</a> methods/operators, such as in<br>
    <pre style="margin-left: 40px;">&gt;&gt; h = gauss + lorz<br>&gt;&gt; h = convn(lorz, 3)<br>&gt;&gt; h = convn(gauss, lorz)<br>&gt;&gt; h = gauss .* lorz; % a 1D model<br>&gt;&gt; h = gauss  * lorz; % a 2D model
<br></pre>
    The full syntax for the model builder is:<br>
    <pre style="margin-left: 40px;">&gt;&gt; <span style="color: rgb(255, 0, 0);">h</span>=<span style="color: rgb(51, 102, 255);">ifitmakefunc</span><span style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);">(</span></span><span style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);"><span style="color: rgb(204, 51, 204);">'expression'<span style="color: rgb(0, 0, 0);">);<br></span></span></span></span>&gt;&gt; <span style="color: rgb(255, 0, 0);">h</span>=<span style="color: rgb(51, 102, 255);">ifitmakefunc</span><span style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);">(</span></span><span style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);"><span style="color: rgb(204, 51, 204);"><span style="font-style: italic;">iFunc model</span><span style="color: rgb(0, 0, 0);">);</span></span></span></span>	<span style="font-style: italic;"><br>&gt;&gt; </span><span style="color: rgb(255, 0, 0);">h</span>=<span style="color: rgb(51, 102, 255);">edit</span><span style="font-style: italic;">(</span><span style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);"><span style="color: rgb(204, 51, 204);"><span style="font-style: italic;">iFunc model</span><span style="color: rgb(0, 0, 0);"><span style="font-style: italic;">);		</span></span></span></span></span><span style="font-style: italic;">% same as above</span><span style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);"><span style="color: rgb(204, 51, 204);"><span style="color: rgb(0, 0, 0);"><span style="font-style: italic;"></span><br></span></span></span></span>&gt;&gt; <span style="color: rgb(255, 0, 0);">h</span>=<span style="color: rgb(51, 102, 255);">ifitmakefunc</span><span style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);">('function_name', 'description', 'Parameter1 Parameter2 ...', ...<br>	<span style="color: rgb(204, 51, 204);">'expression'<span style="color: rgb(0, 0, 0);">, </span></span>[default parameter values], <span style="color: rgb(204, 51, 204);">'constraint'</span>);<br></span></span><span style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);"></span></span></pre>
    which is equivalent to:<br>
    <pre style="margin-left: 40px;">&gt;&gt; fun.Name=<span style="color: rgb(204, 51, 204);">'function short name'</span>;<br>&gt;&gt; fun.Description=<span style="color: rgb(204, 51, 204);">'function description'</span>;		<span style="font-style: italic;">% function long description</span><br style="font-style: italic;">&gt;&gt; fun.Parameters=<span style="color: rgb(204, 51, 204);">'Parameter1 Parameter2 ...'</span>;		<span style="font-style: italic;">% parameter names</span>. When empty, names are given according to the Expression analysis (when appropriate)<br>&gt;&gt; fun.Guess=[0 1 2 ...] or <span style="color: rgb(204, 51, 204);">'automatic'</span>;		<span style="font-style: italic;">% parameter default values (vector), or automatic mode</span><br>&gt;&gt; fun.Expression=<span style="color: rgb(204, 51, 204); font-style: italic;">'expression using p and x,y,z,t...'</span>;	<span style="font-style: italic;">% value of the model</span> (required). p is the vector that holds parameters. Axes are x,y,z,t,u,v,w.<br>&gt;&gt; fun.Constraint=<span style="color: rgb(204, 51, 204);">'evaluated before Expression'</span>;	<span style="font-style: italic;">% constraint evaluated </span>prior<span style="font-style: italic;"> to the model Expression</span><br>&gt;&gt; <span style="color: rgb(255, 0, 0);">h</span>=<span style="color: rgb(51, 102, 255);">iFunc</span><span style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);">(fun);<br>&gt;&gt; </span></span><span style="color: rgb(51, 102, 255);">fits</span>(a, <span style="color: rgb(255, 0, 0);">h</span><span style="color: rgb(204, 51, 204);"></span>);<span style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);"></span></span></pre>
    The generated code will basically be:<br>
    <pre style="margin-left: 40px;"><span style="color: rgb(51, 102, 255);">function</span> y=Name(p, axes, ...)<br><span style="font-style: italic;">% Description</span><br style="font-style: italic;"><span style="font-style: italic;">% Parameters: [fun.Parameters]</span><br>Constraint;<br>y=Expression;<br></pre>
    The resulting function has the ability to identify itself (<span
      style="color: rgb(51, 102, 255);">disp(model)</span> provides
    detailed informations), compute automatic starting parameters with
    e.g.<span style="color: rgb(51, 102, 255);"> feval(model, 'guess')</span>,
    display itself <span style="color: rgb(51, 102, 255);">plot(model)</span>,
    and evaluate its value of course <span style="color: rgb(51, 102,
      255);">feval(model, parameter_values, axes, ...)</span>. The
    resulting model is a <a href="iFunc.html">iFunc</a> object. Refer
    to that object description for more information.<br>
    <br>
    A large set of 1D (vector) and 2D (surface) models can be obtained
    from <a href="http://zunzun.com">ZunZun.com</a>.<br>
    <h4><a class="mozTocH4" name="mozTocId775891"></a>Creating complex
      functions from simple functions</h4>
    To <span style="font-weight: bold;">assemble existing functions</span>
    into new ones, you may use the iFunc operators <span
      style="font-style: italic;">e.g.</span>:&nbsp; <br>
    <pre style="margin-left: 40px;">&gt;&gt; <span style="color: rgb(255, 0, 0);">h</span>=<span style="color: rgb(51, 102, 255);"></span><span style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);"></span></span><span style="color: rgb(204, 51, 204);"><span style="color: rgb(51, 102, 255);">gauss</span>+<span style="color: rgb(51, 102, 255);">lorz</span><span style="color: rgb(0, 0, 0);">; h.Constraint = </span></span><span style="color: rgb(204, 51, 204);">'p(8)=0'</span>;<br></pre>
    which creates a new function which is the <span style="font-weight:
      bold; font-style: italic;">sum</span> of a Gaussian and a
    Lorentzian.&nbsp; Unspecified arguments are guessed/automatically
    set. The second redundant Lorentzian Background <span
      style="font-style: italic;">p(8)</span> parameter is forced to 0
    so that it does not correlate with the Gaussian Background <span
      style="font-style: italic;">p(4)</span>.
    <h4><a class="mozTocH4" name="mozTocId937554"></a>Using signal
      convolution/correlation in new functions</h4>
    It is possible to include a convolution (FFT based,
    multidimensional) in the core of the new function. The two function
    <span style="font-weight: bold; font-style: italic;">fconv</span>
    and <span style="font-weight: bold; font-style: italic;">fconvn</span>
    should then be used with the following syntax, where <span
      style="font-style: italic;">a</span> and <span style="font-style:
      italic;">b</span> are vectors/matrices:<br>
    <pre style="margin-left: 40px;">&gt;&gt; c = <span style="color: rgb(51, 102, 255);">fconv</span>(a,b);	<span style="font-style: italic;">	% returned convoluted object with size which is size(a)+size(b)+1</span><br>&gt;&gt; c = <span style="color: rgb(51, 102, 255);">fconv</span>(a,b, <span style="color: rgb(204, 51, 204);">'same'</span>);<span style="font-style: italic;">	% returned convoluted object </span><span style="font-style: italic;">with</span><span style="font-style: italic;"> size which is size(a)<br></span>&gt;&gt; c = <span style="color: rgb(51, 102, 255);">fconv</span>(a,b, <span style="color: rgb(204, 51, 204);">'valid'</span>);<span style="font-style: italic;">	% returned convoluted object </span><span style="font-style: italic;">with</span><span style="font-style: italic;"> size which is size(a)</span>-size(b)+1<br>&gt;&gt; c = <span style="color: rgb(51, 102, 255);">fconv</span>(a,b, <span style="color: rgb(204, 51, 204);">'pad'</span>);<span style="font-style: italic;">	% pads 'a' with starting/ending values to minimize border effects<br></span>&gt;&gt; c = <span style="color: rgb(51, 102, 255);">fconv</span>(a,b, <span style="color: rgb(204, 51, 204);">'center'</span>);<span style="font-style: italic;">	% centers 'b' so that convolution does not shift 'a'<br></span>&gt;&gt; c = <span style="color: rgb(51, 102, 255);">fconv</span>(a,b, <span style="color: rgb(204, 51, 204);">'norm'</span>);<span style="font-style: italic;">	% normalizes</span><span style="font-style: italic;"> 'b' so that convolution does not change 'a' integral<br></span>&gt;&gt; c = <span style="color: rgb(51, 102, 255);">fconv</span>(a,b, <span style="color: rgb(204, 51, 204);">'background'</span>);<span style="font-style: italic;">% subtracts</span><span style="font-style: italic;"> minimal value in 'b' so that convolution does not change 'a' integra</span>l<br>&gt;&gt; c = <span style="color: rgb(51, 102, 255);">fconv</span>(a,b, <span style="color: rgb(204, 51, 204);">'deconv'</span>);	<span style="font-style: italic;">% deconvolution, but very sensitive to noise (use with caution)</span><br></pre>
    When some data has to be convoluted with a response function (<span
      style="font-style: italic;">e.g.</span> instrument resolution
    function), the usual options to use should be:<br>
    <pre style="margin-left: 40px;">&gt;&gt; c = <span style="color: rgb(51, 102, 255);">fconv</span>(a,b, <span style="color: rgb(204, 51, 204);">'same pad background center norm'</span>);<br>&gt;&gt; c = <span style="color: rgb(51, 102, 255);">fconvn</span>(a,b);	<span style="font-style: italic;">% same as above</span> in a shorter call</pre>
    These convolution methods have been ported to <a href="iFunc.html">iFunc</a>
    models as<br>
    <ul>
      <li><span style="font-weight: bold;">conv: </span>convolution
        (calls fconv)<br>
      </li>
      <li><span style="font-weight: bold;">convn: </span>normalized
        convolution (calls fconvn)<br>
      </li>
      <li><span style="font-weight: bold;">xcorr: </span>cross-correlation













        (calls fconv in correlation mode)<br>
      </li>
    </ul>
    If you wish to convolute two models, use<br>
    <pre style="margin-left: 40px;">&gt;&gt; a = <span style="color: rgb(51, 102, 255);">convn</span>(lorz, 3)		<span style="font-style: italic;">% convolution of a Lorentzian with a Gaussian of width 3<br></span>&gt;&gt; a = <span style="color: rgb(51, 102, 255);">convn</span>(lorz, gauss)	<span style="font-style: italic;">% a Voigt function...<br></span>&gt;&gt; a = <span style="color: rgb(51, 102, 255);">convn</span>(lorz, <span style="color: rgb(204, 51, 204);">'double(b)'</span>)<span style="font-style: italic;">; </span>a.Constraint = <span style="color: rgb(204, 51, 204);">'global b'</span>;	% convolute with a global variable 'b'<span style="font-style: italic;"></span></pre>
    where the vector/matrix<span style="font-style: italic;"> 'b'</span>
    holds the response function (filter) <span style="font-style:
      italic;">with the same axis binning</span> as the object <span
      style="font-style: italic;">'a'</span>.<br>
    <br>
    <span style="color: rgb(255, 0, 0);">Warning: </span>The <span
      style="font-style: italic;">fconv</span> and <span
      style="font-style: italic;">fxcorr</span> functions require the <span
      style="font-style: italic;">x</span> axis not to be coarsely
    sampled. In case the models/data contain narrow peaks (described
    with few points underneath e.g. less than 5), the fit model above
    will fail convolving. One solution is to artificially create a finer
    sampled axis, evaluate the function, and reduce back to the initial
    number of points. The constraints are used to define the new finer
    axis <span style="font-style: italic;">xx</span>, and the final
    result is re-sampled with 1 point out of 5 :<br>
    <pre style="margin-left: 40px;">&gt;&gt; h = <span style="color: rgb(51, 102, 255);">convn</span>(dho, gauss); <br>&gt;&gt; h.Constraint=<span style="color: rgb(204, 51, 204);">'x=linspace(min(x),max(x), 5*length(x))';</span><span style="color: rgb(51, 102, 255);"></span><span style="color: rgb(204, 51, 204);">	<span style="color: rgb(0, 0, 0); font-style: italic;">% artificially extend the 'x' axis</span><br><span style="color: rgb(0, 0, 0);">&gt;&gt; h = h + </span>'signal=signal(1:5:end);'<span style="color: rgb(0, 0, 0);">;</span></span>				<span style="font-style: italic;">% shrink 'signal' back to initial size</span><br></pre>
    <pre style="margin-left: 40px;"><span style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);"></span></span></pre>
    <h3><a class="mozTocH3" name="mozTocId854762"></a><span
        style="font-weight: bold;">How to write manually a model
        function</span></h3>
    We suggest that you start from the<span style="color: rgb(51, 102,
      255);"> 'gauss' </span>function in <span style="font-style:
      italic;">iFit/Scripts/Models, </span>and customize at will.
    Please retain the function core structure to ensure proper
    execution. More complex models can be derived from e.g. the <span
      style="color: rgb(51, 102, 255);">voigt</span> function.<br>
    <pre style="margin-left: 40px;">&gt;&gt; edit gauss<br>&gt;&gt; edit voigt<br>&gt;&gt; <span style="color: rgb(51, 102, 255);">ifitmakefunc</span>(voigt)	<span style="font-style: italic;">% pop-up a dialogue</span><br>&gt;&gt; <span style="color: rgb(51, 102, 255);">edit</span>(voigt)		<span style="font-style: italic;">% same as ifitmakefunc for iFunc objects</span><br></pre>
    <br>
    <hr style="width: 100%; height: 2px;">
    <div style="text-align: center;">
      <div style="text-align: center;"><span style="font-style: italic;">E.
Farhi














          - iFit/fit models - </span><span style="font-style: italic;">
          $Date$ $Revision$ </span><span style="font-style: italic;"> </span>-
        back to <a href="index.html">Main iFit Page </a><a
          href="http://www.ill.eu/"><img title="ILL, Grenoble, France
            &lt;www.ill.eu&gt;" src="images/ILL-web-jpeg.jpg" alt="ILL,
            Grenoble, France &lt;www.ill.eu&gt;" style="border: 0px
            solid ; width: 53px; height: 50px;" align="right"></a> </div>
    </div>
  </body>
</html>
