<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta content="text/html; charset=windows-1252"
      http-equiv="content-type">
    <title>miFit: a user interface to iFit</title>
  </head>
  <body>
    <h1 align="center"><a class="mozTocH1" name="mozTocId760940"></a>
      miFit: a user interface for iFit</h1>
    <div align="center"><img alt="iFit" title="iFit"
        src="images/iFit-logo.png" width="116" height="64"
        align="middle"><img alt="miFit" title="miFit"
        src="images/miFit.png" width="80" height="64" align="middle"><br>
    </div>
    <ol id="mozToc">
      <!--mozToc h3 1 h4 2 h5 3-->
      <li><a href="#mozTocId772540">Starting</a>
        <ol>
          <li><a href="#mozTocId34149">Using specific miFit flavor</a></li>
        </ol>
      </li>
      <li><a href="#mozTocId449791"> Loading data and models</a>
        <ol>
          <li><a href="#mozTocId647875">from files</a></li>
          <li><a href="#mozTocId487410">from the Matlab/iFit prompt:
              Data sets</a></li>
          <li><a href="#mozTocId315062">from the Matlab/iFit prompt:
              Models</a></li>
          <li><a href="#mozTocId805610">from copy/paste</a></li>
          <li><a href="#mozTocId565408">from drag-and-drop</a></li>
          <li><a href="#mozTocId997017">creating a new Data set</a></li>
          <li><a href="#mozTocId638950">creating new Models</a></li>
        </ol>
      </li>
      <li><a href="#mozTocId82620">Working with Data sets</a>
        <ol>
          <li><a href="#mozTocId207324"> Plotting data</a></li>
          <li><a href="#mozTocId97236"> Sorting and searching data</a></li>
          <li><a href="#mozTocId467624"> Mathematical operators on Data
              sets</a></li>
        </ol>
      </li>
      <li><a href="#mozTocId729437">Working with Models (fitting)</a>
        <ol>
          <li><a href="#mozTocId892073"> Assigning and Evaluating Models
              to Data sets</a></li>
          <li><a href="#mozTocId655920">Selecting a fit routine
              (optimization algorithm)</a></li>
          <li><a href="#mozTocId830396"> Fitting Models to Data sets</a></li>
        </ol>
      </li>
      <li><a href="#mozTocId457482"> Preferences</a>
        <ol>
          <li><a href="#mozTocId205238">Resetting miFit (default
              Preferences)</a></li>
        </ol>
      </li>
      <li><a href="#mozTocId430134"> Saving your work</a>
        <ol>
          <li><a href="#mozTocId319597"> Saving all data sets, Models
              and Preferences</a></li>
          <li><a href="#mozTocId557435"> Exporting selected Data sets</a></li>
          <li><a href="#mozTocId887221"> Exporting Models (and importing
              them as well)</a></li>
        </ol>
      </li>
      <li><a href="#mozTocId687843"> Examples</a>
        <ol>
          <li><a href="#mozTocId840871">Fitting a simple peak</a></li>
          <li><a href="#mozTocId60957">Fitting a powder pattern</a></li>
          <li><a href="#mozTocId546971">Fitting a spin-wave dispersion</a></li>
          <li><a href="#mozTocId89596">Fitting a phonon dispersion
              (neutron_TAS)</a></li>
        </ol>
      </li>
    </ol>
    <hr size="2" width="100%"><br>
    This is the miFit help, a simple graphical user interface to iFit.
    To access the main iFit help pages, <a href="index.html">click here</a>.<br>
    <br>
    <h3 align="center"><a class="mozTocH3" name="mozTocId772540"></a>Starting</h3>
    To start the miFit interface, just type <code>'mifit'</code> from
    the Matlab prompt when iFit is installed, or from the iFit
    stand-alone prompt. The main window will then appear, as follows:<br>
    <br>
    <div align="center"><img alt="miFit" title="miFit"
        src="images/miFit.png" width="296" height="238" align="middle"><br>
      <i>The miFit main window</i><br>
    </div>
    <br>
    The main window has menus, a toolbar with icons, and tips that show
    up when bringing the mouse pointer over items. The imported data
    sets are stored in a 'Data Sets' list.<br>
    <br>
    On the first start-up, <i>miFit</i> builds a list of available
    Models and Optimizers. This list can be re-built (updated) if you
    reset the application from the <i>Reset</i> item in the File menu.
    Before you reset <i>miFit,</i> it may be desirable to <a
      href="#mozTocId430134">save your Data Sets</a>.<br>
    <h4><a class="mozTocH4" name="mozTocId34149"></a>Using specific
      miFit flavor</h4>
    miFit can be customized to provide specific features, from the <i>Configurations</i>
    item in the <i>File</i> menu. Each configuration is an ini file
    stored in the<i> iFit/Applications/miFit/configurations</i>
    directory. You may add your own configurations there, based on the
    existing ones. Selected configurations are appended to the current
    Preferences, and saved for later use. They mostly populate new menu
    items. In order to remove specific configurations from miFit, you
    should <i>Reset</i> miFit as indicated <a href="#mozTocId205238">below</a>.<br>
    <br>
    <ul>
      <li><i><u>neutron_TAS</u></i>: add a Neutron Scattering menu with
        4D TAS resolution calculation and convolution. See <a
          href="#mozTocId89596">below</a> for an example usage.</li>
    </ul>
    <br>
    <h3 align="center"><a class="mozTocH3" name="mozTocId449791"></a>
      Loading data and models</h3>
    <p>The imported Data Sets appear in the main <i>miFit</i> list.<br>
      The imported Models are inserted in the <i>Models</i> menu,
      sorted by dimensionality (1D, 2D, 3D, 4D, others).</p>
    <ul>
    </ul>
    <h4><a class="mozTocH4" name="mozTocId647875"></a>from files</h4>
    <p>The legacy way to import data files into miFit is to select the <i>Open




        item in the File menu</i>. A file selector will pop-up, and
      allow to select one or more data files (use Ctrl-click to select
      files one-by-one, and Shift-click to select a range). You can
      equally select the <i>Open icon</i> in the toolbar.<br>
    </p>
    <p>It is possible to import data files in any supported format
      (whole list available in the <a href="Loaders.html">Loaders</a>
      page). Once loaded, the data sets appear in the Data Sets list in
      the main window. <br>
    </p>
    <p>Supported formats for Data Sets (stored as <a href="iData.html">iData</a>
      objects):</p>
    <table width="100%" border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td valign="top">
            <ul style="color: rgb(0, 0, 0); font-family: &quot;Times New
              Roman&quot;; font-size: medium; font-style: normal;
              font-variant-ligatures: normal; font-variant-caps: normal;
              font-weight: normal; letter-spacing: normal; orphans: 2;
              text-align: start; text-indent: 0px; text-transform: none;
              white-space: normal; widows: 2; word-spacing: 0px;
              -webkit-text-stroke-width: 0px;">
              <li><small>any Data in text format<br>
                </small></li>
              <small> </small>
              <li><small>ILL Data (legacy, text, most instruments at the<span
                    class="Apple-converted-space">&nbsp;</span><a
                    href="http://www.ill.fr/YellowBook/">ILL</a>)<br>
                </small></li>
              <small> </small>
              <li><small>ILL TAS Data (legacy, text, polarized or not)</small></li>
              <small> </small>
              <li><small>ILL<span class="Apple-converted-space">&nbsp;</span><a
href="http://www.ill.eu/instruments-support/instruments-groups/instruments/cyclops/description/instrument-layout/">Cyclops</a><span
                    class="Apple-converted-space">&nbsp;</span>neutron
                  Laue diffractometer image (HBIN)<br>
                </small></li>
              <small> </small>
              <li><small>Chalk River<span class="Apple-converted-space">&nbsp;</span><a
                    href="http://www.nrc-cnrc.gc.ca/cnbc/">CNBC</a><span
                    class="Apple-converted-space">&nbsp;</span>NRU data,
                  including multi-wire and polarized data<br>
                </small></li>
              <small> </small>
              <li><small>SPEC ESRF<br>
                </small></li>
              <small> </small>
              <li><small><a href="http://www.mcstas.org">McStas</a><span
                    class="Apple-converted-space">&nbsp;</span>(Scan DAT
                  output, 1D, 2D monitor, event lists, sim file, Sqw,
                  LAZ, LAU tables)</small></li>
              <small> </small>
              <li><small>ISIS/SPE and SQW tof data (see<span
                    class="Apple-converted-space">&nbsp;</span><a
                    href="http://horace.isis.rl.ac.uk/">Horace</a><span
                    class="Apple-converted-space">&nbsp;</span>and<span
                    class="Apple-converted-space">&nbsp;</span><a
                    href="http://www.libisis.org/">LibISIS</a>)<br>
                </small></li>
              <small> </small>
              <li><small>INX tof data (ILL<span
                    class="Apple-converted-space">&nbsp;</span><a
href="http://www.ill.eu/instruments-support/computing-for-science/cs-software/all-software/tofhr/inx/">processed




                    TOF</a>)<br>
                </small></li>
              <small> </small>
              <li><small>ESRF data format (*.edf)</small></li>
              <small> </small>
              <li><small>Xray/neutron diffraction<span
                    class="Apple-converted-space">&nbsp;</span><a
                    href="http://www.esrf.fr/computing/Forum/imgCIF/cbf_definition.html">Crystallographic




                    binary file</a><span class="Apple-converted-space">&nbsp;</span>(*.cbf)</small></li>
              <small> </small>
              <li><small><a
                    href="http://en.wikipedia.org/wiki/Analyze_%28imaging_software%29">MRI




                    3D volume</a><span class="Apple-converted-space">&nbsp;</span>Analyze




                  7.5 (*.hdr with associated *.img)</small></li>
              <small> </small>
              <li><small><a href="http://nifti.nimh.nih.gov/">NifTI</a><span
                    class="Apple-converted-space">&nbsp;</span>medical
                  imaging volume data format (*.nii)<br>
                </small></li>
              <small> </small>
              <li><small>NeXT/SUN (.au) sound</small></li>
              <small> </small>
              <li><small>Microsoft WAVE (.wav) sound</small></li>
              <small> </small>
              <li><small>Audio/Video Interleaved (*.avi)</small></li>
              <small> </small>
              <li><small><a
                    href="http://www.unidata.ucar.edu/software/netcdf/">NetCDF</a><span
                    class="Apple-converted-space">&nbsp;</span>(*.nc)<br>
                </small></li>
              <small> </small>
              <li><small>CDF (*.cdf)<br>
                </small></li>
              <small> </small>
              <li><small><a href="http://fits.gsfc.nasa.gov/">FITS</a><span
                    class="Apple-converted-space">&nbsp;</span>(*.fits)
                  used in astronomy<br>
                </small></li>
              <small> </small>
              <li><small>Microsoft Excel (*.xls)</small></li>
              <small> </small>
              <li><small>Image/Picture (*.gif, *.bmp, *.tif, *.jpg,
                  *.png, ppm, pgm, pbm)<br>
                </small></li>
              <small> </small>
              <li><small><a href="http://www.hdfgroup.org/">HDF4</a><span
                    class="Apple-converted-space">&nbsp;</span>(*.hdf4)<br>
                </small></li>
              <small> </small>
              <li><small><a href="http://www.hdfgroup.org/">HDF5</a><span
                    class="Apple-converted-space">&nbsp;</span>(*.hdf5)
                  including the<span class="Apple-converted-space">&nbsp;</span><a
                    href="http://nexusformat.org">NeXus</a><span
                    class="Apple-converted-space">&nbsp;</span>format
                  (*.nx, *.n4, *.ns, *.n5, *.nxs) and more specifically<span
                    class="Apple-converted-space">&nbsp;</span><a
                    href="http://www.mantidproject.org">Mantid</a><span
                    class="Apple-converted-space">&nbsp;</span>workspaces.<br>
                </small></li>
              <small> </small>
              <li><small>Matlab workspace (*.mat) a customized HDF<br>
                </small></li>
              <small> </small>
              <li><small>Comma Separated Values (*.csv)<br>
                </small></li>
              <small> </small>
              <li><small>Numerical single block (*.dlm)<br>
                </small></li>
              <small> </small>
              <li><small><a href="http://www.w3.org/XML/">XML</a><span
                    class="Apple-converted-space">&nbsp;</span>(*.xml)</small></li>
              <small> </small>
              <li><small>FIG (Matlab figure, *.fig)</small></li>
              <small> </small>
            </ul>
          </td>
          <td valign="top">
            <ul style="color: rgb(0, 0, 0); font-family: &quot;Times New
              Roman&quot;; font-size: medium; font-style: normal;
              font-variant-ligatures: normal; font-variant-caps: normal;
              font-weight: normal; letter-spacing: normal; orphans: 2;
              text-align: start; text-indent: 0px; text-transform: none;
              white-space: normal; widows: 2; word-spacing: 0px;
              -webkit-text-stroke-width: 0px;">
              <li><small><a href="http://www.rcsb.org/pdb/">Protein Data
                    Bank (*.pdb)<br>
                  </a></small></li>
              <small> </small>
              <li><small><a
                    href="http://en.wikipedia.org/wiki/STL_%28file_format%29">STL</a><span
                    class="Apple-converted-space">&nbsp;</span>stereolithography




                  (*.stl)</small></li>
              <small> </small>
              <li><small><a
                    href="http://www.geomview.org/docs/html/OFF.html">OFF</a><span
                    class="Apple-converted-space">&nbsp;</span>object
                  geometry (*.off)</small></li>
              <small> </small>
              <li><small><a
                    href="http://en.wikipedia.org/wiki/PLY_%28file_format%29">PLY</a><span
                    class="Apple-converted-space">&nbsp;</span>Polygon
                  File Format or the Stanford Triangle Format (*.ply)</small></li>
              <small> </small>
              <li><small><a href="http://www.marresearch.com/">MAR</a><span
                    class="Apple-converted-space">&nbsp;</span>MarResearch



                  CCD Camera (*.mar, *.mccd), a variant of the TIFF
                  format<br>
                </small></li>
              <small> </small>
              <li><small><a
                    href="http://www.andor.com/scientific-cameras">SIF</a><span
                    class="Apple-converted-space">&nbsp;</span>Andor SIF
                  CCD Camera (*.sif)</small></li>
              <small> </small>
              <li><small><a
                    href="http://www.princetoninstruments.com/products/software/#1">SPE</a><span
                    class="Apple-converted-space">&nbsp;</span>Princeton/Roper




                  Scientific WinView CCD / PI Acton Camera file (*.spe)</small></li>
              <small> </small>
              <li><small><a
                    href="http://www.adsc-xray.com/products.html">IMG</a><span
                    class="Apple-converted-space">&nbsp;</span>ADSC
                  Quantum CCD Camera (*.img)</small></li>
              <small> </small>
              <li><small><a
                    href="http://en.wikipedia.org/wiki/Crystallographic_Information_File">CIF</a>,<span
                    class="Apple-converted-space">&nbsp;</span><a
                    href="http://www.ill.eu/sites/fullprof/">CFL/PCR</a>,<span
                    class="Apple-converted-space">&nbsp;</span><a
                    href="http://shelx.uni-ac.gwdg.de/SHELX/">INS/RES/SHX</a><span
                    class="Apple-converted-space">&nbsp;</span>Crystallography




                  files (FullProf, ShelX)<br>
                </small></li>
              <small> </small>
              <li><small>EZD, MRC and<span class="Apple-converted-space">&nbsp;</span><a
href="http://en.wikipedia.org/wiki/CCP4_%28file_format%29">CCP4</a><span
                    class="Apple-converted-space">&nbsp;</span>electron
                  density maps (*.map, *.ezd, *.ccp4)</small></li>
              <small> </small>
              <li><small><a href="http://en.wikipedia.org/wiki/Yaml">YAML</a><span
                    class="Apple-converted-space">&nbsp;</span>and<span
                    class="Apple-converted-space">&nbsp;</span><a
                    href="http://en.wikipedia.org/wiki/JSON">JSON</a><span
                    class="Apple-converted-space">&nbsp;</span>(*.yaml,
                  *.yml, *.json)</small></li>
              <small> </small>
              <li><small>NMR Bruker, Varian and JEOL data files</small></li>
              <small> </small>
              <li><small><a href="http://www.wavemetrics.com/">IBW</a><span
                    class="Apple-converted-space">&nbsp;</span>Igor Wave
                  data file (*.ibw)</small></li>
              <small> </small>
              <li><small><a
                    href="http://en.wikipedia.org/wiki/Wavefront_.obj_file">OBJ</a><span
                    class="Apple-converted-space">&nbsp;</span>Wavefront
                  3D (*.obj)</small></li>
              <small> </small>
              <li><small>LabView<span class="Apple-converted-space">&nbsp;</span><a
                    href="http://www.ni.com/white-paper/4139/en/">LVM</a><span
                    class="Apple-converted-space">&nbsp;</span>and<span
                    class="Apple-converted-space">&nbsp;</span><a
                    href="http://www.ni.com/white-paper/3727/en/">TDMS</a><span
                    class="Apple-converted-space">&nbsp;</span>files
                  (*.lvm; *.tdms)</small></li>
              <small> </small>
              <li><small>Bruker FT-IR<span class="Apple-converted-space">&nbsp;</span><a
href="http://www.bruker.com/fr/products/infrared-near-infrared-and-raman-spectroscopy/opus-software/overview.html">OPUS</a><span
                    class="Apple-converted-space">&nbsp;</span>data
                  files (*.0001, *.0002, ...)</small></li>
              <small> </small>
              <li><small>LLB TAS binary data files (R* and C*)</small></li>
              <small> </small>
              <li><small><a
                    href="https://en.wikipedia.org/wiki/IDL_%28programming_language%29">IDL</a><span
                    class="Apple-converted-space">&nbsp;</span>SAV data
                  (*.sav)</small></li>
              <small> </small>
              <li><small>DAT<span class="Apple-converted-space">&nbsp;</span><a
                    href="http://www.qdusa.com/products/mpms3.html">Quantum



                    Design</a><span class="Apple-converted-space">&nbsp;</span>VMS



                  ppms/mpms</small></li>
              <small> </small>
              <li><small>XVG<span class="Apple-converted-space">&nbsp;</span><a
                    href="http://plasma-gate.weizmann.ac.il/Grace/">XmGrace</a><span
                    class="Apple-converted-space">&nbsp;</span>data set</small></li>
              <small> </small>
              <li><small>Agilent Mass Spectrometry (*.CH, *.D, *.MS)</small></li>
              <small> </small>
              <li><small>Thermo Finnigan Mass Spectrometry (*.RAW)</small></li>
              <small> </small>
              <li><small><a
                    href="https://www.oecd-nea.org/dbdata/data/manual-endf/endf102.pdf">ENDF</a><span
                    class="Apple-converted-space">&nbsp;</span><a
                    href="https://en.wikipedia.org/wiki/Nuclear_data">Evaluated




                    Nuclear Data File</a><span
                    class="Apple-converted-space">&nbsp;</span>(*.endf,*.tsl)</small></li>
              <small> </small>
              <li><small>ACE<span class="Apple-converted-space">&nbsp;</span><a
                    href="https://mcnp.lanl.gov/">MCNP</a><span
                    class="Apple-converted-space">&nbsp;</span>files
                  (*.ace) [requires<span class="Apple-converted-space">&nbsp;</span><a
                    href="http://pyne.io/">PyNE</a>]</small></li>
            </ul>
          </td>
        </tr>
      </tbody>
    </table>
    <ul style="color: rgb(0, 0, 0); font-family: &quot;Times New
      Roman&quot;; font-size: medium; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; orphans: 2;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px;">
    </ul>
    <p>Supported formats for Models (stored as <a href="iFunc.html">iFunc</a>
      objects):
      <meta http-equiv="content-type" content="text/html;
        charset=windows-1252">
    </p>
    <ul>
      <li><small>M Matlab script/function (*.m) </small></li>
      <li><small>MAT Matlab binary file (*.mat) </small></li>
      <li><small>JSON JavaScript Object Notation (*.json)</small></li>
      <li><small>YAML interchange format (*.yaml)</small></li>
      <li><small>XML file (*.xml)</small></li>
    </ul>
    <pre style="color: rgb(0, 0, 0); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; margin-left: 40px;"><meta http-equiv="content-type" content="text/html; charset=windows-1252"></pre><h4><a class="mozTocH4" name="mozTocId487410"></a>from the Matlab/iFit prompt: Data sets<br></h4><p>It is possible to work from the Matlab/iFit prompt, and send any numerical array, as well as <a href="iData.html">iData</a> (data sets) and iFunc (models) objects. This is done with the <font color="#3366ff">mifit(data)</font> command. Any syntax from the <a href="Load.html">Load</a> page can be used, where '<i>mifit</i>' stand in place of '<i>iData</i>'.<br></p><p>To import a numerical array:<i> mifit(array)</i><br></p><ul><li><a href="images/iFit_standalone.png"><img alt="iFit standalone
            window (no Matlab license required)" title="iFit standalone
            window (no Matlab license required)" src="images/iFit_standalone.png" style="border: 0px solid;
            border: 0px solid; width: 300px; height: 198px;" align="right"></a><code>a=<font color="#3366ff">rand</font>(10);</code><code><br></code><code><font color="#3366ff">mifit</font>(a);</code></li></ul><p>or <i>mifit(x,y,z, ... signal)</i><br></p><ul><li><code>x = 0:.1:8*pi; y = sin(x);</code><code><br></code><code><font color="#3366ff">mifit</font></code><code>(x,y);</code><br></li></ul><p>or</p><ul><li><code>a=[ &nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</code><code><br></code><code>&nbsp;&nbsp;&nbsp; 0.1000&nbsp;&nbsp;&nbsp; 0.0998</code><code><br></code><code>&nbsp;&nbsp;&nbsp; 0.2000&nbsp;&nbsp;&nbsp; 0.1987</code><code><br></code><code>&nbsp;&nbsp;&nbsp; 0.3000&nbsp;&nbsp;&nbsp; 0.2955</code><code><br></code><code>&nbsp;&nbsp;&nbsp; 0.4000&nbsp;&nbsp;&nbsp; 0.3894</code><code><br></code><code>&nbsp;&nbsp;&nbsp; 0.5000&nbsp;&nbsp;&nbsp; 0.4794</code><code><br></code><code>&nbsp;&nbsp;&nbsp; 0.6000&nbsp;&nbsp;&nbsp; 0.5646</code><code><br></code><code>&nbsp;&nbsp;&nbsp; 0.7000&nbsp;&nbsp;&nbsp; 0.6442</code><code><br></code><code>&nbsp;&nbsp;&nbsp; 0.8000&nbsp;&nbsp;&nbsp; 0.7174</code><code><br></code><code>&nbsp;&nbsp;&nbsp; 0.9000&nbsp;&nbsp;&nbsp; 0.7833</code><code><br></code><code>&nbsp;&nbsp;&nbsp; 1.0000&nbsp;&nbsp;&nbsp; 0.8415</code><code><br></code><code>&nbsp;&nbsp;&nbsp; 1.1000&nbsp;&nbsp;&nbsp; 0.8912</code><code><br></code><code>&nbsp;&nbsp;&nbsp; 1.2000&nbsp;&nbsp;&nbsp; 0.9320 ];<br></code><code><font color="#3366ff">mifit</font></code><code>(a);</code><br></li></ul><p>To import an iData object (data set. Refer to the <a href="Load.html">Load</a> page): <i>mifit(iData)</i><br></p><ul><li><code>a = iData(peaks);</code></li><li><code>a.Title = <font color="#cc33cc">'Peak function'</font>; <font color="#3366ff">label</font>(a,1,<font color="#cc33cc">'my X axis'</font>); <font color="#3366ff">label</font>(a,2,<font color="#cc33cc">'my Y axis'</font>);</code></li><li><code><font color="#3366ff">mifit</font>(a);</code></li></ul><h4><a class="mozTocH4" name="mozTocId315062"></a>from the Matlab/iFit prompt: Models</h4><p>To import a Model (<a href="iFunc.html">iFunc</a> object): <i>mifit(iFunc)</i><br></p><ul><li><code>f=gauss+lorz; f.Background_2=0; <font color="#3366ff">fix</font>(f,<font color="#cc33cc">'Background_2'</font>);</code></li><li><code><font color="#3366ff">mifit</font>(f);</code></li></ul>The new model is added to the <i>1D</i> Models menu, as a <b><font color="#3366ff">blue</font></b> entry, which is used to label 'user' models. Such models are <b><i>'static'</i></b> in the sense that once in the Models menu only their model parameters can be changed. These models are assigned a unique iD in the form <i>iFxxxx</i>.<br><br>It is also possible to add Models as expressions, which are then evaluated to create a model. Such models, shown in <b><font color="#33cc00">green</font></b> in the Models menu, are <i><b>'dynamic'</b></i> in the sense that they are used to effectively create <i>other</i> static models. Such model creators do not have a unique model iD. For instance, the '<i>sqw_phonons</i>' model is dynamic. When called, it requires to enter parameters to initiate the model creation, such as the DFT code to use, the k-mesk, ... Then, a <i>static</i> model is created, but the parameters used initially (DFT, k-mesh, ...) can not be changed further. However, the model parameters (intensity, ...) can be changed, e.g. during fit processes.<br><br>To import a Model expression as a dynamic model (creator), use:<br><ul><li><code><font color="#3366ff">mifit</font>(<font color="#cc33cc">'Models_Add_Entry'</font>,<font color="#cc33cc">'gauss+lorz'</font>);</code></li></ul><h4><a class="mozTocH4" name="mozTocId805610"></a>from copy/paste</h4><p>It is possible to use the Copy/Paste mechanism to import data sets. If the copied element is a file, it will be imported the same way as with the Open item above when selecting the <i>Paste</i> item in the <i>Edit</i> menu. You can also click on the grey window background or the 'Data Sets' label above the list, and press <i>Ctrl-V</i>.<br></p><p>You can also copy whole data blocks (e.g. numerical values/array from a text editor or a spreadsheet), and paste them into miFit.<br></p><h4><a class="mozTocH4" name="mozTocId565408"></a>from drag-and-drop</h4><p>A very convenient way to import data is to drag a data file, and drop it into the miFit window. A new data sets object is then read, and added to the list.<br></p><h4><a class="mozTocH4" name="mozTocId997017"></a>creating a new Data set</h4><p>You may create a new data set using a spreadsheet by selecting the <i>New</i> item in the <i>File</i> menu, or the white page icon in the toolbar. Type in your data (Copy/Paste works). The data set will be imported into miFit when you close the window.<br></p><h4><a class="mozTocH4" name="mozTocId638950"></a>creating new Models</h4><p>The way to define new Models into miFit is <i>via</i> the Matlab/iFit prompt (see <a href="#mozTocId315062">above</a>), or by importing a data file containing a model (iFunc) definition.<br></p><h3 align="center"><a class="mozTocH3" name="mozTocId82620"></a>Working with Data sets</h3><p>You should first import or create Data Sets (see <a href="#mozTocId638950">above</a>), which populate the <i>miFit</i> list. Each entry is an <a href="iData.html">iData</a> object.<br></p><p>Most actions require to select one or more Data Sets from the list. You can use the mouse click, with the <i>Ctrl</i> key for adding one-by-one, or the <i>Shit</i> key to add in a range. The <i>Select All</i> item in the <i>Edit</i> menu allows to select all, or none (when they are all selected). To deselect a single item, use mouse <i>Ctrl-click</i> on it. You can use <i>Ctrl-A</i> to select all.<br></p><p>Subsequent Data Sets states are saved into a History, which allow to Undo last operations (data states, model selections, etc...). You may as well save any time the miFit state from the <i>Save as</i> item in the <i>File</i> menu.<br></p><h4><a class="mozTocH3" name="mozTocId207324"></a>
    Plotting data</h4>
    <img alt="miFit_Data_Plot" title="miFit_Data_Plot" src="images/miFit_Data_Plot.png" width="300" height="269" align="right">You can plot Data Sets by selecting one or more, and then click on the <i>Plot</i> icon in the toolbar, or the <i>Plot</i> item in the <i>Data</i> menu. To plot a single Data Set, double-click it in the Data Set list. Data Sets with assigned Models (see <a href="#mozTocId892073">below</a>) will also show the model evaluation.<br><h4><a class="mozTocH3" name="mozTocId97236"></a>
    Sorting and searching data</h4>
    Once you have imported or created many Data Sets, it is desirable to be able to sort them, or to find some that match given criteria.<br><br>The <i>Sort List</i> item in the <i>Data</i> menu allows to sort the Data Sets according to a given criteria, such as the integrated value, the Date, the title, its unique iD, its size (number of elements). <br><br>The <i>Search</i> item in the <i>Data</i> menu allows to enter a token/word to be searched in the data sets. Those matching the token will then be selected. You can then use the above <i>Sort List</i> item to move these at the top or bottom of the Data Set list.<br><h4><a class="mozTocH3" name="mozTocId467624"></a>
    Mathematical operators on Data sets</h4><p>It is possible to apply simple mathematical operators onto one or more Data Sets. <br></p><ul>
      <li><i>Unary:</i> these operators take single data sets, and return the same number of data sets after the transformation, which are appended to the Data Sets list. You can find  typically: log, abs, trigonometric, opposite (uminus), ...<br></li>
      <li><i>Binary:</i> these operators take operators two-by-two and return a single data set, which is appended to the Data Sets list. You can find  typically:merge/combine, plus, minus, times, divide, comparisons, interpolation, FFT convolution, ...<br></li>
      <li><i>Others:</i> these operators are usually specialized unary operators, and return the same number of data sets as the selected ones, which are appended to the Data Sets list. You can find typically: FFT, smoothing, intergral (trapz), cartesian to spherical/radial (cart2sph), wavelets (cwt), gradient and laplacian (del2), ...<br></li></ul>For more complex treatment, you should retrieve the Data Sets in the Matlab/iFit workspace (prompt level), do some work, and send it back as new or updated Data sets. You can refer to the main iFit help page to learn what you can do, especially regarding the <a href="iData.html">iData</a> object handling, and <a href="Math.html">Mathematical operators</a>.<br><ul><li><code>d=<font color="#3366ff">mifit</font>(<font color="#cc33cc">'pull'</font>)</code></li><li><code><font color="#3366ff">set</font>(d,<font color="#cc33cc">'Model'</font>,gauss);</code></li><li><code>d(1) = d(1)+d(2);&nbsp;&nbsp;&nbsp; <i>% assuming we have selected 2 data sets.</i></code></li><li><code><font color="#3366ff">mifit</font>(<font color="#cc33cc">'pull'</font> d);</code></li></ul><h3 align="center"><a class="mozTocH4" name="mozTocId729437"></a>Working with Models (fitting)</h3><p>You can use the available Models listed in the <i>Models</i> menu, and sorted by dimensionality (1D,2D,...). You may import new models from <a href="#mozTocId647875">files</a> (including drag-n-drop), and <a href="#mozTocId315062">from the Matlab/iFit prompt</a> (which allows to create new Models). All Models are <a href="iFunc.html">iFunc</a> objects.<br></p><p><u><i>1D models</i></u><br></p><table width="100%" border="1" cellpadding="2" cellspacing="2"><tbody><tr><td valign="top">&nbsp; <b>allometric</b> Allometric/Freundlich (1D) [allometric]<br>&nbsp;<b>bigauss</b> Bi-Gaussian (1D) [bigauss]<br>&nbsp;<b>bilorz</b> Bi-Lorentzian (1D) [bilorz]<br>&nbsp;<b>bose</b> Bose (1D) [bose]<br>&nbsp;<b>dho</b> Damped-harmonic-oscillator (1D) [dho]<br>&nbsp;<b>dirac</b> Dirac (1D) [dirac]<br>&nbsp;<b>doseresp</b> Dose-response (sigmoid) (1D) [doseresp]<br>&nbsp;<b>expon</b> Exponential decay (1D) [expon]<br>&nbsp;<b>expstretched</b> Stretched Exponential decay (1D) [expstretched]<br>&nbsp;<b>gauss</b> Gaussian (1D) [gauss]<br>&nbsp;<b>green</b> Green function (1D) [green]<br>&nbsp;<b>heaviside</b> Heaviside (1D) [heaviside]<br>&nbsp;<b>langevin</b> Langevin function for magnetic polarization (1D) [langevin]<br>&nbsp;<b>laplace</b> Laplace distribution function (1D) [laplace]<br>&nbsp;<b>lognormal</b> Log-Normal distribution function (1D) [lognormal]<br>&nbsp;<b>lorz</b> Lorentzian (1D) [lorz]<br>&nbsp;<b>maxwell</b> Maxwell-Boltzmann *3 distribution function (1D) [maxwell]<br>&nbsp;<b>pareto</b> Pareto distribution distribution function (1D) [pareto]<br></td><td valign="top">&nbsp;<b>poisson</b> Poisson distribution function (1D) [poisson]<br>&nbsp;<b>powerlaw</b> Power law (1D) [powerlaw]<br>&nbsp;<b>pseudovoigt</b> Pseudo-Voigt (1D) [pseudovoigt]<br>&nbsp;<b>quadline</b> Quadratic equation (1D) [quadline]<br>&nbsp;<b>sigmoid</b> Sigmoidal curve (1D) [sigmoid]<br>&nbsp;<b>sine</b> Sine function (1D) [sine]<br>&nbsp;<b>sinedamp</b> Damped-Sine function (1D) [sinedamp]<br>&nbsp;<b>strline</b> Straight-line (1D) [strline]<br>&nbsp;<b>tophat</b> Top-Hat rectangular function (1D) [tophat]<br>&nbsp;<b>triangl</b> Triangular function (1D) [triangl]<br>&nbsp;<b>twoexp</b> Bi-Exponential decay (1D) [twoexp]<br>&nbsp;<b>voigt</b> Voigt (1D) [voigt]<br><br>&nbsp;<b>ff_core_shell</b> Spherical/core shell P(q) (1D) [ff_core_shell]<br>&nbsp;<b>ff_sphere</b> Sphere P(q) (1D) [ff_sphere]<br><b>&nbsp;sf_hard</b>_spheres Hard Sphere S(q) (1D) [sf_hard_spheres]<br>&nbsp;<b>sf_square_well</b> Square well S(q) (1D) [sf_square_well]<br><b>&nbsp;sf_sticky_hard_spheres</b> Sticky Hard Sphere S(q) (1D) [sf_sticky_hard_spheres]<br></td></tr></tbody></table><p><u><i>2D models</i></u><br></p><table width="100%" border="1" cellpadding="2" cellspacing="2"><tbody><tr><td valign="top">&nbsp;<b>lorz2d</b> Lorenztian-2D function with tilt angle (2D) [lorz2d]<br>&nbsp;<b>plane2d</b> Planar function (2D) [plane2d]<br>&nbsp;<b>pseudovoigt2d</b> Pseudo-Voigt-2D function with tilt angle (2D) [pseudovoigt2d]<br>&nbsp;<b>quad2d</b> Quadratic-2D function with tilt angle (2D) [quad2d]<br><b>gauss2d</b> Gaussian-2D function with tilt angle (2D) [gauss2d]<br></td></tr></tbody></table><p><u><i>4D models</i></u><br></p><table width="100%" border="1" cellpadding="2" cellspacing="2"><tbody><tr><td valign="top">&nbsp;<b>sqw_acoustopt</b> Sqw_acoustopt acoustic/optic dispersion(HKL) with DHO line shape [sqw_acoustopt]<br><b>&nbsp;sqw_cubic_monoatomic</b> Sqw_cubic dispersion(HKL) for cubic monoatomic crystal [sqw_cubic_monoatomic]<br>&nbsp;<b>sqw_linquad</b> Sqw_linquad linear-quadratic dispersion(HKL) with DHO line shape [sqw_linquad]<br>&nbsp;<b>sqw_sine3d</b> Sqw_sine3d sine dispersion(HKL) with DHO line shape [sqw_sine3d]<br>&nbsp;<b>sqw_phonons</b> Sqw_phonon DHO [sqw_phonons]<br>&nbsp;<b>sqw_spinw</b> Sqw_spinw spin-wave dispersion(HKL) [sqw_spinw]<br>&nbsp;<b>sqw_vaks</b> Sqw_Vaks phonon dispersion(HKL) for perovskites ABX3 [sqw_vaks]<br></td></tr></tbody></table><p><u><i>Others</i></u><br></p><table width="100%" border="1" cellpadding="2" cellspacing="2"><tbody><tr><td valign="top">&nbsp;<b>constant</b> Constant (0D) [constant] <br><b>&nbsp;gaussnd</b> Gaussian (nD) [gaussnd]<br>&nbsp;<b>ngauss</b> Gaussians_n (n*1D) [ngauss]<br>&nbsp;<b>nlorz</b> Lorentzians_n (n*1D) [nlorz]<br>&nbsp;<b>rietveld</b> Rietveld refinement [rietveld]<br></td></tr></tbody></table><p>A detailed list of available models is given in the <a href="Models.html">Models</a> page.<br></p><ul>
    </ul><h4><a class="mozTocH3" name="mozTocId892073"></a>
    Assigning and Evaluating Models to Data sets</h4><p>You should first select the target Data Set(s) in the list, which will be assigned a given model. Then, select a model from the <i>Models</i> menu (1D,2D, ....).<br></p><p>To view the Model Parameters, select the <i>View Model Parameters</i> item in the <i>Models</i> menu. This window has a contextual menu which provides additional features (on right-click).<br></p><p><img alt="miFit_View_Parameters" title="miFit_View_Parameters" src="images/miFit_View_Parameters.png" width="764" height="143" align="middle"></p><p align="center"><i>The miFit Model Parameters window. You can fix and set parameter bounds.<br></i></p>You can force to evaluate the Model onto selected Data Set axes from the <i>Evaluate Model</i> in the <i>Data</i> menu. When no model parameters have been set yet, the model will guess some starting parameters from the data set.<br><br>To force an update of the Parameter Window (with e.g. guessed values), de-select (Ctrl-click or click an other data set) and re-select (click) the Data Set from the list.<br><br>Plotting one or mode Data Set with assigned models will also display their model evaluation (see <a href="#mozTocId207324">above</a>)<i>.<br></i><h4><a class="mozTocH4" name="mozTocId655920"></a>Selecting a fit routine (optimization algorithm)</h4>
<p>The default choices for the optimizer and the fit criteria will 'work' in most cases. However, you may specifically select the optimizer, its configuration, the fit criteria and the verbosity level (for interactive actions).</p><p>The optimizer to be used for fitting can be chosen from the <i>Optimizers</i> menu. The '<i>Automatic best optimizer</i>'
 (fmin) makes a reasonable choice among all available optimizers, 
depending on the model dimensionality. This is the default choice. 
However, you may choose any of the available optimizers (see <a href="Optimizers.html">Optimizers</a> for a more detailed description).<br>
</p>
<ul><li><u>Configuration of the algorithm:</u> The configuration of the optimizer allows to change the internal optimizer parameters, such as the number of iterations, the desired accuracy (convergence criteria), ... The default configuration should work in most cases.<br></li><li><u>Selecting the optimization criteria (least-squares, ...):</u> use the <i>Select Criteria</i> entry in the <i>Optimizers</i> menu. Usual choice is least-square, but other choices are possible. Refer to the <a href="Fit.html#mozTocId778987">Fit</a> help page for more.<br></li><li><u>Selecting the optimizer</u>: Select one entry in the <i>Optimizers</i> menu.<br></li><li><u>The verbose mode:</u> in the <i>Preferences</i> from the <i>File</i> menu, you can turn the <i>Verbosity</i> item from '<i>no</i>' to '<i>yes</i>' to follow the fit procedure. During the fil, the criteria evolution, as well as the data and model evaluation plot will displayed. The View Parameters window will also be regularly updated. You can also click the <font color="#ff0000"><b><i>Stop</i></b></font> red button during the fit to cleanly interrupt the procedure.<br></li></ul><h4><a class="mozTocH3" name="mozTocId830396"></a>
    Fitting Models to Data sets</h4><p>Once a data set has been assigned a model, it is possible to fit the model parameters onto the data. The procedure makes use of the following concepts:<br></p><ul><li>the model is also called the '<b><i>objective</i></b>' function ;<br></li><li>the model parameters are changed during the fit procedure so that the model evaluated with these parameters converges as best as possible to the data set. The number of parameters is the problem dimensionality. The number of degrees of freedom is the number of data set points minus the number of parameters ;<br></li><li>the metric used to compare the data set and the model evaluation during the fit is called the '<b><i>criteria</i></b>' . It is often defined as the least-square, but other choices are possible ;<br></li><li>the procedure used to perform the fit is called the '<b><i>optimizer</i></b>' (see <a href="https://en.wikipedia.org/wiki/Mathematical_optimization">Optimization</a>). Known optimizers are the <a href="https://en.wikipedia.org/wiki/Levenberg%E2%80%93Marquardt_algorithm">Levenberg-Marquardt</a>, the <a href="https://en.wikipedia.org/wiki/Particle_swarm_optimization">swarm</a> (particules), the <a href="https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method">simplex</a>, etc...</li></ul>The fit process is launched when selecting the <i>Fit to Model</i> item of the <i>Data</i> menu, or clicking the fit icon in the toolbar.<br><br>The <i>Verbose</i> mode ('yes') in the <i>Preferences</i> allows to follow the fit procedure and to be able to interrupt it cleanly during the fit (<i>Stop</i> button). However, it results in a slightly slower fit, as displaying the updates takes more time.<br><br><h3 align="center"><a class="mozTocH3" name="mozTocId457482"></a>
    Preferences</h3><img alt="miFit_Preferences" title="miFit_Preferences" src="images/miFit_Preferences.png" width="927" height="256" align="middle"><br><div align="center"><i>The miFit Preferences window. The Preferences are updated and saved when closing the window. To Reset Preferences, use the File:Reset item.</i><br></div><i><br></i><h4><a class="mozTocH4" name="mozTocId205238"></a>Resetting miFit (default Preferences)</h4><p>To Reset the miFit application, use the Reset item in the File menu. The <i>'Reset'</i> button will clear the data set list, History and Log file. The <i>Factory reset</i> will also clear the Models list (menu), and Preferences. This last choice requires miFit to be restarted in order to be effective. Specific menus from the <i>File:Configurations</i> are also removed.<br></p><h3 align="center"><a class="mozTocH3" name="mozTocId430134"></a>
    Saving your work</h3><h4><a class="mozTocH3" name="mozTocId319597"></a>
    Saving all data sets, Models and Preferences</h4>
    Use the <i>Save</i> item in the <i>File</i> menu to save the Data Sets, Models, and Optimizers, e.g. in the <i>mifit.mat</i> file in the Matlab Preferences directory. This file is automatically re-opened when starting <i>miFit,</i> so that the last configuration is fully restored from one session to an other.<br><br>You may as well save this information into a specific file, using the <i>Save as</i> item in the <i>File</i> menu. You can then later re-open this file from the <i>Open</i> item in the <i>File</i> menu.<br><br>Preferences are saved automatically. They are restored when starting a new <i>miFit</i> session. The location of this file is indicated in the dialog, and in the console. You may make copies of this file for later restore. The Configurations directory in <i>miFit</i> are specific Preferences file (.ini).<br><h4><a class="mozTocH3" name="mozTocId557435"></a>
    Exporting selected Data sets</h4>
    Into files<br>To the Matlab/iFit prompt<br>Copy/Paste<br>As table<br>As web pages (for printing)<br><h4><a class="mozTocH3" name="mozTocId887221"></a>
    Exporting Models (and importing them as well)</h4><h3 align="center"><a class="mozTocH3" name="mozTocId687843"></a>
    Examples</h3><br><h4><a class="mozTocH4" name="mozTocId840871"></a>Fitting a simple peak</h4><br><h4><a class="mozTocH4" name="mozTocId60957"></a>Fitting a powder pattern</h4><br><h4><a class="mozTocH4" name="mozTocId546971"></a>Fitting a spin-wave dispersion</h4><br><h4><a class="mozTocH4" name="mozTocId89596"></a>Fitting a 'phonon' dispersion (neutron_TAS)</h4>
    We here indicate the usual steps to be used to treat a TAS scan around a dispersion.<br><ol><li>Import a TAS data file. This is e.g. a Q or Energy scan.</li><li>Install the <i>Neutron Scattering</i> menu with TAS plug-ins but selecting the <i>File:Configurations:neutron_TAS.ini</i></li><li>Select the data file, and convert it to a 4D (QH QK QL EN) scan, using the <i>TAS: Convert/Convolute 4D</i> item in the <i>Neutron Scattering</i> menu. As there is no Model assigned, only the data set in converted to 4D.<br></li><li>Assign a 4D model, e.g. <a href="Models.html#mozTocId774280"><i>sqw_linquad</i></a> which models a local S(q,w) description around e.g. the scan center.</li><li>Open the <i>View Parameters</i> window by selecting the <i>View Model Parameters</i> item&nbsp; in the <i>Models</i> menu.</li><li>Set initial model parameters (e.g. excitation energy). Make sure to fix e.g. HKL space directions and some other parameters to help the fit to converge. Bound parameters (e.g. excitation energy and Q location...). Adjust Intensity and Width.</li><li>Optionally, turn Verbosity to 'yes' in the Preferences.<br></li><li>Click on the <i>Fit</i> icon or item in the <i>Data</i> menu. This first fit is an ideal one, without the 4D convolution with the neutron TAS resolution.</li><li>Now, open the <a href="ResLibCal.html">ResLibCal</a> interface from the <i>Neutron Scattering</i> menu.</li><li>Optionally import a data file, previous or predefined instrument configuration in ResLibCal to read the spectrometer configuration. This data file should contain Rescal parameters in free text. You can also check/modify instrument and sample parameters in its main window.</li><li>Select the method to compute the resolution from <i>Cooper-Nathans, Popovici</i> or <i>McStas full Monte-Carlo</i>. The resolution uses a Monte-Carlo cloud for the 4D convolution operation which creates a set of points around each TAS measurement location. The resolution
 is re-computed at each location. The number of points used in this 
cloud is defined in the ResLibCal <i>View:Set Monte-Carlo iterations</i> item.</li><li>In miFit select the 4D data set (QH QK QL EN), and convolve the model with the 4D TAS resolution function, using (again) the <i>TAS: Convert/Convolute 4D</i> item in the <i>Neutron Scattering</i> menu. This time, the assigned model is affected.</li><li>You can optionally close ResLibCal (which saves the current configuration to be used). This makes the fit procedure slightly faster.<br></li><li>Click on the <i>Fit</i> icon or item in the <i>Data</i> menu. </li></ol><br><br>
      
    
    <hr style="width: 100%; height: 2px;">
    <div style="text-align: center;"><span style="font-style: italic;">E.
Farhi


        - miFit/GUI - </span><span style="font-style: italic;"></span><span style="font-style: italic;"> $Date$ $Revision$ </span><span style="font-style: italic;"> </span>- back to <a href="index.html">Main iFit Page </a><a href="http://www.ill.eu/"><img title="ILL, Grenoble, France
          &lt;www.ill.eu&gt;" src="images/ILL-web-jpeg.jpg" alt="ILL,
          Grenoble, France &lt;www.ill.eu&gt;" style="border: 0px solid
          ; width: 53px; height: 50px;" align="right"></a> </div>
  


</body></html>