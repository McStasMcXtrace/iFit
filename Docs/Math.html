<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="content-type"
 content="text/html; charset=ISO-8859-1">
  <title>iFit: Math operators</title>
</head>
<body>
<h1 style="text-align: center;"><a class="mozTocH1"
 name="mozTocId294096"></a>iFit: Mathematical operators</h1>
<br>
<ol id="mozToc">
<!--mozToc h3 1 h4 2 h3 3 h4 4 h5 5 h6 6-->
  <li><a href="#mozTocId725083">A reminder on axes, monitors and signal
errors</a></li>
  <li><a href="#mozTocId810783">Unary operators</a></li>
  <li><a href="#mozTocId714232">Binary operators</a></li>
  <li><a href="#mozTocId463816">statistics, fitting and peak
searching</a></li>
  <li><a href="#mozTocId981870">interpolation/projections/integration/sum/combination</a></li>
</ol>
<br>
<hr style="width: 100%; height: 2px;">
<div style="text-align: center;">Commands we use in this page: <span
 style="font-style: italic;">iData</span>, maths<br>
</div>
<br>
<br>
<h3><a class="mozTocH3" name="mozTocId725083"></a>A reminder on axes,
monitors and signal errors</h3>
The iData objets have been designed keeping in mind that any
measurement <span style="font-style: italic;">Signal</span> is
recorded as a function of <span style="font-style: italic;">Axes</span>
(e.g. time, energy, ...) and corresponds to a measurement quantity
(e.g. flux, integrated time for the measurement, ...), which we label
as a <span style="font-style: italic;">Monitor</span>. In addition,
the Signal is attached to an uncertainty <span
 style="font-style: italic;">Error, </span>which provides a
measurement of the accuracy of the Signal. You may get more details
about these definitions in the <a href="iData.html">iData</a> object
description page. Remember that axis of rank 1 is usually associated to
Y (vertical, along rows), whereas axis of rank 2 is associated to X
(horizontal, along columns).<br>
<br>
The way all of these are used is listed below:<br>
<ul>
  <li>All mathematical methods propagate the <span
 style="font-style: italic;">Error</span> together with the <span
 style="font-style: italic;">Signal, </span>assuming Error
distributions are Gaussian. The sections below detail the way Errors
are propagated.</li>
  <li>Binary operators use the <span style="font-style: italic;">Monitor</span>
value to weight the respective ratio when performing the operation. The
    <span style="font-style: italic;">Monitor</span> value is also
affected by Matematical operations that renormalize the <span
 style="font-style: italic;">Signal. </span>The <span
 style="font-style: italic;">Monitor</span> is usually a value larger
than 1.<span style="font-style: italic;"><br>
    </span></li>
  <li>The <span style="font-style: italic;">Axes</span> are used in
binary operators to determine intersection of <span
 style="font-style: italic;">Signal</span> ranges. A rebinning of
objects is automatically performed when the <span
 style="font-style: italic;">Axes</span> sampling do not match.</li>
</ul>
<h3><a class="mozTocH3" name="mozTocId810783"></a>Unary operators</h3>
All unary operators apply on a single object, element-by-element.<br>
<br>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; font-weight: bold; font-style: italic; background-color: rgb(255, 204, 204);">Operator</td>
      <td
 style="vertical-align: top; font-weight: bold; font-style: italic; background-color: rgb(255, 204, 204);">new
Signal<br>
      </td>
      <td
 style="vertical-align: top; font-weight: bold; font-style: italic; background-color: rgb(255, 204, 204);">new
Error<br>
      </td>
      <td
 style="vertical-align: top; font-weight: bold; font-style: italic; background-color: rgb(255, 204, 204);">new
Monitor<br>
      </td>
      <td
 style="vertical-align: top; font-weight: bold; font-style: italic; background-color: rgb(255, 204, 204);">Comments<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">abs<br>
      </td>
      <td style="vertical-align: top;">| Signal |<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Absolute value<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">acos<br>
      </td>
      <td style="vertical-align: top;"><span style="font-style: italic;">cos</span><sup>-1</sup>(Signal)<br>
      </td>
      <td style="vertical-align: top;">-Error/(&#8730;(1-Signal&sup2;))<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Arc cosine. Signal should be
[-1:1]<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">asin<br>
      </td>
      <td style="vertical-align: top;"><span style="font-style: italic;">sin</span><sup>-1</sup>(Signal)<br>
      </td>
      <td style="vertical-align: top;">Error/(&#8730;(1-Signal&sup2;))</td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Arc sine. Signal should be [-1:1]</td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">atan<br>
      </td>
      <td style="vertical-align: top;"><span style="font-style: italic;">tan</span><sup>-1</sup>(Signal)<br>
      </td>
      <td style="vertical-align: top;">Error/(1+Signal&sup2;)</td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Arc tangent.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">cos<br>
      </td>
      <td style="vertical-align: top;"><span style="font-style: italic;">cos</span>(Signal)<br>
      </td>
      <td style="vertical-align: top;">-Error*<span
 style="font-style: italic;">sin</span>(Signal)<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Cosine. Signal is in [rad]<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">sin<br>
      </td>
      <td style="vertical-align: top;"><span style="font-style: italic;">sin</span>(Signal)<br>
      </td>
      <td style="vertical-align: top;">Error*<span
 style="font-style: italic;">cos</span>(Signal)<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Sine. Signal is in [rad]</td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">tan<br>
      </td>
      <td style="vertical-align: top;"><span style="font-style: italic;">tan</span>(Signal)<br>
      </td>
      <td style="vertical-align: top;">Error/<span
 style="font-style: italic;">cos</span>&sup2;(Signal)<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Tangent. Signal is in [rad]</td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">exp<br>
      </td>
      <td style="vertical-align: top;"><span style="font-style: italic;">e</span><sup>Signal</sup><br>
      </td>
      <td style="vertical-align: top;">Error*<span
 style="font-style: italic;">e</span><sup>Signal</sup></td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Exponential<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">log<br>
      </td>
      <td style="vertical-align: top;"><span style="font-style: italic;">ln</span>(Signal)<br>
      </td>
      <td style="vertical-align: top;">Error/Signal<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Logarithm (Neperian, base 2)<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">log10<br>
      </td>
      <td style="vertical-align: top;"><span style="font-style: italic;">log</span><sub>10</sub>(Signal)<br>
      </td>
      <td style="vertical-align: top;">Error/(<span
 style="font-style: italic;">ln</span>(10)*Signal)<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Logarithm (base 10)</td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">sqrt<br>
      </td>
      <td style="vertical-align: top;">&#8730;Signal</td>
      <td style="vertical-align: top;">Error/(2&#8730;Signal)</td>
      <td style="vertical-align: top;">&#8730;Monitor</td>
      <td style="vertical-align: top;">Square root<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">ctranspose <span
 style="font-style: italic; font-weight: normal;">and</span> ' <br>
      </td>
      <td style="vertical-align: top;">Signal'<br>
      </td>
      <td style="vertical-align: top;">Error'<br>
      </td>
      <td style="vertical-align: top;">Monitor'</td>
      <td style="vertical-align: top;">Complex conjugate transpose<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">transpose <span
 style="font-style: italic; font-weight: normal;">and</span> .'<br>
      </td>
      <td style="vertical-align: top;">Signal.'<br>
      </td>
      <td style="vertical-align: top;">Error'<br>
      </td>
      <td style="vertical-align: top;">Monitor'<br>
      </td>
      <td style="vertical-align: top;">Non conjugate transpose<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">floor<br>
      </td>
      <td style="vertical-align: top;">floor(Signal)<br>
      </td>
      <td style="vertical-align: top;">floor(Error)<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Round towards -&#8734; Make it integer.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">ceil</td>
      <td style="vertical-align: top;">ceil(Signal)<br>
      </td>
      <td style="vertical-align: top;">ceil(Error)<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Round towards +&#8734; Make it integer.</td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">round<br>
      </td>
      <td style="vertical-align: top;">round(Signal)<br>
      </td>
      <td style="vertical-align: top;">round(Error)<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Round towards nearest integer.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">sign<br>
      </td>
      <td style="vertical-align: top;">sign(Signal)<br>
      </td>
      <td style="vertical-align: top;">0<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Sign of Signal elements.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">uminus <span
 style="font-style: italic; font-weight: normal;">and</span> -<br>
      </td>
      <td style="vertical-align: top;">-Signal<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Opposite<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">imag<br>
      </td>
      <td style="vertical-align: top;">&#8465;(Signal)<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Imaginary part<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">real<br>
      </td>
      <td style="vertical-align: top;">&#8476;(Signal)<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">Real part<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
Here is an example using unary operators:<br>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">iData</span>(<span
 style="color: rgb(204, 51, 204);">[ ifitpath 'Data/ILL_IN6.dat' ]</span>);<br>&gt;&gt; b = [ log(a) floor(a) sqrt(a) ]<br>b =  array [1  3] iData object:<br><br>Index     [Tag]     [Dimension]                           [Title] [Last command]          [Label]<br>    1  tp362134     [340  1024] 'File ILL_IN6.dat ILL Data (n...' tp362134=log(tp36213...  <br>    2  tp362140     [340  1024] 'File ILL_IN6.dat ILL Data (n...' tp362140=floor(tp362...  <br>    3  tp362145     [340  1024] 'File ILL_IN6.dat ILL Data (n...' tp362145=sqrt(tp3621...  <br></pre>
The <span style="font-weight: bold;">1/Signal </span>is obtained with
the binary operator <span style="font-weight: bold;">division.</span>
The <span style="font-weight: bold;">sqr</span> operator is a short
cut for <span style="font-weight: bold;">power</span> 2.<br>
<h3><a class="mozTocH3" name="mozTocId714232"></a>Binary operators</h3>
The binary operators take two objects, and perform a relational
operator, element-by-element. In the following we use the notations:<br>
<ul>
  <li>s1, e1 and m1 are the <span style="font-style: italic;">Signal,
Error</span> and <span style="font-style: italic;">Monitor</span> of
the 1st object, resp.</li>
  <li>s2, e2 and m2 are the <span style="font-style: italic;">Signal,
Error</span> and <span style="font-style: italic;">Monitor</span> of
the 2nd object, resp.</li>
  <li>s3, e3 and m3 are the <span style="font-style: italic;">Signal,
Error</span> and <span style="font-style: italic;">Monitor</span> of
the resulting object, resp.<br>
  </li>
</ul>
When not defined the <span style="font-style: italic;">Monitor</span>
is set to 1, and the <span style="font-style: italic;">Error</span> is
set to<span style="font-style: italic;"> &#8730;Signal.</span><br>
<br>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; font-weight: bold; font-style: italic; background-color: rgb(255, 204, 204);">Operator<br>
      </td>
      <td
 style="vertical-align: top; font-weight: bold; font-style: italic; background-color: rgb(255, 204, 204);">Signal
(s3)<br>
      </td>
      <td
 style="vertical-align: top; font-weight: bold; font-style: italic; background-color: rgb(255, 204, 204);">Error
(e3)<br>
      </td>
      <td
 style="vertical-align: top; font-weight: bold; font-style: italic; background-color: rgb(255, 204, 204);">Monitor
(m3)<br>
      </td>
      <td
 style="vertical-align: top; font-weight: bold; font-style: italic; background-color: rgb(255, 204, 204);">Description<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">plus <span
 style="font-style: italic; font-weight: normal;">and</span> +<br>
      </td>
      <td style="vertical-align: top;">m3*(s1/m1+s2/m2)<br>
      </td>
      <td style="vertical-align: top;">&#8730;[(e1/m1)<span
 style="font-style: italic;"></span>&sup2;+(e2/m2)<span
 style="font-style: italic;"></span>&sup2;]<br>
      </td>
      <td style="vertical-align: top;">m1+m2<br>
      </td>
      <td style="vertical-align: top;">addition<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">minus <span
 style="font-style: italic; font-weight: normal;">and</span> -<br>
      </td>
      <td style="vertical-align: top;">m3*(s1/m1 - s2/m2)</td>
      <td style="vertical-align: top;">&#8730;[(e1/m1)<span
 style="font-style: italic;"></span>&sup2;+(e2/m2)<span
 style="font-style: italic;"></span>&sup2;]</td>
      <td style="vertical-align: top;">m1+m2</td>
      <td style="vertical-align: top;">subtraction<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">times <span
 style="font-style: italic; font-weight: normal;">and</span> *<br>
      </td>
      <td style="vertical-align: top;">s1 * s2</td>
      <td style="vertical-align: top;">s3*[(e1/s1)&sup2;+(e2/s2)&sup2;]</td>
      <td style="vertical-align: top;">m1*m2<br>
      </td>
      <td style="vertical-align: top;">multiplication<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">divide <span
 style="font-style: italic; font-weight: normal;">and</span> /<br>
      </td>
      <td style="vertical-align: top;">m2&sup2;*(s1/s2)</td>
      <td style="vertical-align: top;">s3*[(e1/s1)&sup2;+(e2/s2)&sup2;]</td>
      <td style="vertical-align: top;">m1*m2</td>
      <td style="vertical-align: top;">division<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">combine <span
 style="font-style: italic; font-weight: normal;">and</span> \<br>
      </td>
      <td style="vertical-align: top;">s1+s2<br>
      </td>
      <td style="vertical-align: top;">&#8730;[e1<span
 style="font-style: italic;"></span>&sup2;+e2<span
 style="font-style: italic;"></span>&sup2;]</td>
      <td style="vertical-align: top;">m1+m2<br>
      </td>
      <td style="vertical-align: top;"><span style="font-style: italic;">Monitor</span>
weighted addition<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">power <span
 style="font-weight: normal;">and</span> ^<br>
      </td>
      <td style="vertical-align: top;">m3*(s1/m1)<sup>(s2/m2)</sup><br>
      </td>
      <td style="vertical-align: top;">s3*[s2*e1/s1+e2*<span
 style="font-style: italic;">ln</span>(s1)]<br>
      </td>
      <td style="vertical-align: top;">m1<sup>m2</sup><br>
      </td>
      <td style="vertical-align: top;">exponentiation<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
All these operations find intersection between objects (when axes are <span
 style="font-style: italic;">e.g</span>. partly overlapping), rebin
objects when axes have a different sampling, and then perform the
mathematical operation. <br>
<br>
The combine operation performs a weighted sum, using the <span
 style="font-style: italic;">Monitor</span> as the weight. This is of
great use when merging results from similar experiments, possibly
performed in slightly different configurations (<span
 style="font-style: italic;">e.g.</span> counting time, statistics,
...). This means that combining two data sets is usually more complex
than
just adding the two Signals, when axes are not exactly the same and
Monitors are not equivalent.<br>
<pre style="margin-left: 40px;"><a href="images/iData_plus_combine.png"><img
 alt="iData: Math: Plus and Combine compared"
 title="iData: Math: Plus and Combine compared"
 src="images/iData_plus_combine.png"
 style="border: 0px solid ; width: 300px; height: 255px;" align="right"></a></pre>
<br>
The following example compares the <span
 style="font-weight: bold; font-style: italic;">combine</span>
operation with the sum. The two initial data sets have a Monitor=1, so
that the
result is indeed the same. We plot both results onto the same figure,
with transparency, and log-scale, shifting the 2nd plot above the first
one.<br>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">iData</span>(<span
 style="color: rgb(204, 51, 204);">[ ifitpath 'Data/ILL_IN6*.dat' ]</span>);<br>&gt;&gt; b=<span
 style="color: rgb(51, 102, 255);">combine</span>(a)             % a is a vector<br>&gt;&gt; c=(a(1)+a(2))/2;<br>&gt;&gt; <span
 style="color: rgb(51, 102, 255);">plot</span>([ <span
 style="color: rgb(51, 102, 255);">log</span>(b) <span
 style="color: rgb(51, 102, 255);">log</span>(c)+5 ]); <span
 style="color: rgb(51, 102, 255);">alpha</span>(0.15);<br></pre>
Changing the Monitor of one of the two objects will affect the relative
weight used for the summation during the <span
 style="font-style: italic;">combine</span> operation. The '\' operator
is used as a shortcut for <span style="font-style: italic;">combine, </span>so
that
<span style="font-style: italic;">combine(a,b)</span> is the same
as <span style="font-style: italic;">a\b</span>.<br>
<br>
<h3><a class="mozTocH3" name="mozTocId463816"></a><span
 style="font-weight: bold;">statistics, fitting and peak
searching</span></h3>
A few methods have been written to analyze the Signal from objects.
This includes peak searching, first and second moment distributions,
and model fitting.<br>
<br>
<span style="font-weight: bold; font-style: italic;">Statistics</span><br>
<br>
The usual <span style="font-weight: bold;">min, max, mean</span>, and <span
 style="font-weight: bold;">median</span> methods can be applied onto
iData objects, and return the corresponding statistics for the Signal.
The operation is performed for one given axis/dimension, e.g. along y,
x, z ...<br>
<pre style="margin-left: 40px;"><a href="images/iData_plot_1d.png"><img
 alt="iData plot1d: std, min, max..."
 title="iData plot1d: std, min, max..." src="images/iData_plot_1d.png"
 style="border: 0px solid ; width: 300px; height: 266px;" align="right"></a></pre>
The <span style="font-weight: bold;">std</span> method provides an
easy way to determine Gaussian widths of Signal distributions along
axes. It returns the half width and center of the Signal distribution.<br>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">iData</span>(<span
 style="color: rgb(204, 51, 204);">[ ifitpath 'Data/sv1850.scn' ]</span>);<br>&gt;&gt; [w,x]=<span
 style="color: rgb(51, 102, 255);">std</span>(a)<br>w =<br>    0.0036<br>x =<br>    1.0007<br>&gt;&gt; [ min(a) max(a) median(a) mean(a) ]<br>ans =<br><br>            0         7387          119       1630.7<br></pre>
indicates that the <span style="font-style: italic;">Signal</span> is
distributed in 1.0007 &plusmn; 0.0036, and gives min, max, ... As a
comparison, the fit to a Gaussian function returns<br>
<pre style="margin-left: 40px;">&gt;&gt; <span
 style="color: rgb(51, 102, 255);">fits</span>(a)<br>   'Amplitude'    <span
 style="color: rgb(255, 0, 0);">'Centre'    'HalfWidth'</span>    'Background'<br>      0.67857      <span
 style="color: rgb(255, 0, 0);"> 1.0008    0.0034641 </span>  0.00024067<br></pre>
which is about the same as the 1st and 2nd moment estimates. Here, the <span
 style="font-style: italic;">Amplitude</span> fit parameter is the one
for <span style="font-style: italic;">Signal/Monitor</span>, which is
indeed different from the value returned by <span
 style="font-weight: bold;">max</span> when <span
 style="font-style: italic;">Monitor</span> is not 1. Use <span
 style="font-style: italic;">setalias(object, 'Monitor',1)</span> to
get similar values from <span style="font-weight: bold;">fits</span>
and <span style="font-weight: bold;">max</span> in this example.<br>
<br>
These operators apply iteratively on object arrays. The <span
 style="font-style: italic;">mean</span> and <span
 style="font-style: italic;">median</span> then point to the <span
 style="font-style: italic;">combine</span> operator, the <span
 style="font-style: italic;">min</span> and <span
 style="font-style: italic;">max</span> return the minimum and maximum
along all objects.<br>
<br>
<span style="font-weight: bold; font-style: italic;">Peak searching and
model fitting</span><br>
<br>
The <span style="font-weight: bold;">peaks</span> method makes an
automatic analysis of a vectorial Signal (that is projected along one
given dimension) of an object, and determines the underlying baseline
(background), apparent peak position and width, based on a shifting
Gaussian estimate [see Slavic, <span style="font-style: italic;">Nucl.
Inst. Meth.</span> <span style="font-weight: bold;">112</span> (1973)
253 ; M. Morhac, <span style="font-style: italic;">Nucl. Inst. Meth.</span>
<span style="font-weight: bold;">A</span> <span
 style="font-weight: bold;">600</span> (2009) 478].&nbsp; <br>
<br>
<a href="images/iData_peaks.png"><img alt="iData_peaks"
 title="iData_peaks" src="images/iData_peaks.png"
 style="border: 0px solid ; width: 300px; height: 266px;" align="right"></a>This
method works remarkably for signals with sharp peaks. <br>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">iData</span>(<span
 style="color: rgb(204, 51, 204);">[ ifitpath 'Data/MCA.dat' ]</span>);<br>&gt;&gt; <span
 style="color: rgb(51, 102, 255);">setalias</span>(a,<span
 style="color: rgb(204, 51, 204);">'Signal'</span>,<span
 style="color: rgb(204, 51, 204);">'Data.Counts(:,2)'</span>);<br>&gt;&gt; <span
 style="color: rgb(51, 102, 255);"><span style="color: rgb(0, 0, 0);">[half_width, center, amplitude, baseline]=</span>peaks</span>(a);<br>&gt;&gt; <span
 style="color: rgb(51, 102, 255);">plot</span>(a); hold on; <br>&gt;&gt; <span
 style="color: rgb(51, 102, 255);">plot</span>(center,amplitude,<span
 style="color: rgb(204, 51, 204);">'ro'</span>); set(gca, <span
 style="color: rgb(204, 51, 204);">'yscale'</span>, <span
 style="color: rgb(204, 51, 204);">'log'</span>)<br></pre>
The first dimension (projection along rows, rank 1) is selected by
default for the analysis, but it may be specified as the second
argument. For broader peaks, a 3rd argument can be used to specify the
length <span style="font-style: italic;">m</span> of the moving window
used for the analysis, which should typically be about the number of
point forming a peak (default is 5).<br>
<br>
As opposed to the <span style="font-weight: bold;">std</span> method
shown above, which only provides one Gaussian estimate, the <span
 style="font-weight: bold;">peaks</span> method can handle as many
peaks as necessary, and is very fast. It also works with iData object
arrays. This method is also used as a basis to determine some starting
parameters for most fit functions (see the <a href="Fit.html">Fitting</a>
and the <a href="iOptim.html">iOptim</a> pages).<br>
<br>
In the case where a finer peak estimate is required, or any other
advanced model parameter determination, the <a href="Fit.html"><span
 style="font-weight: bold;">fits</span></a> method can be used. This
latter makes use of the <span style="font-weight: bold;">ieval</span>
method, which evaluates a model function onto the object axes.<br>
<h3><a class="mozTocH3" name="mozTocId981870"></a><span
 style="font-weight: bold;">interpolation/projections/integration/sum/combination</span></h3>
<br>
<br>
<hr style="width: 100%; height: 2px;">
<div style="text-align: center;"><span style="font-style: italic;">E.
Farhi - iFit/Math operators -&nbsp;</span><span
 style="font-style: italic;"> </span><span style="font-style: italic;">$Date:
2010-11-22
14:15:30
$
$Revision:
1.2
$</span><span style="font-style: italic;"> </span>- back to <a
 href="index.html">Main iFit Page</a>
</div>
</body>
</html>
