<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>iFit: Importing data (iData/load)</title>
  <meta http-equiv="content-type"
 content="text/html; charset=ISO-8859-1">
</head>
<body>
<h1 style="text-align: center;"><a class="mozTocH1"
 name="mozTocId647835"></a>iFit: importing data into objects<br>
</h1>
<br>
<ol id="mozToc">
<!--mozToc h3 1 h4 2 h3 3 h4 4 h5 5 h6 6-->
  <li><a href="#mozTocId5377">Importing data from a
file (iData,
load) </a>
    <ol>
      <li><a href="#mozTocId52427">Distant files</a></li>
      <li><a href="#mozTocId250466">Compressed files</a></li>
    </ol>
  </li>
  <li><a href="#mozTocId59221">Supported data formats</a></li>
  <li><a href="#mozTocId782211">Example data files</a></li>
  <li><a href="#mozTocId141862">Importing directly
from
Matlab variables</a></li>
  <li><a href="#mozTocId755882">Importing from Matlab
Figures</a></li>
  <li><a href="#mozTocId672193">How it works
(looktxt, iLoad, iFiles) </a></li>
</ol>
<br>
<hr style="width: 100%; height: 2px;">
<div style="text-align: center;">Commands we use in this page: <span
 style="font-style: italic;">iData, load, </span><a href="Methods.html">methods</a>
<div style="text-align: left;"><br>
In this document we present how to import data as <a href="iData.html">iData</a>
objetcs from files, variables and figures.<br>
</div>
</div>
<h3><a class="mozTocH3" name="mozTocId5377"></a>Importing data from a
file (<span style="font-style: italic;"><a href="iData.html">iData</a>,
load</span>)<br>
</h3>
This is done by converting a file path to an <a href="iData.html">iData</a>
object, or directly
with the<br>
<span style="font-style: italic;">iData/<span style="font-weight: bold;">load</span></span>
method. The <span style="font-weight: bold; font-style: italic;">ifitpath</span>
points to the iFit library location:<br>
<div style="margin-left: 40px;">
<pre>&gt;&gt; a = <span style="color: rgb(51, 102, 255);">iData</span>([ <span
 style="color: rgb(51, 102, 255);">ifitpath</span> <span
 style="color: rgb(204, 51, 204);">'Data/ILL_IN6.dat'</span> ]);</pre>
<pre>&gt;&gt; a = <span style="color: rgb(51, 102, 255);">load</span>(iData, <span
 style="color: rgb(204, 51, 204);">[ ifitpath 'Data/ILL_IN6.dat' ]</span>);</pre>
</div>
These commands result in the following output, which produce an iData
object:<br>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2"
 cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">
      <pre><span style="font-family: monospace;">iLoad: Importing file iFit/Data/ILL_IN6.dat with method ILL Data (normal integers) (looktxt)<br>looktxt iFit/Data/ILL_IN6.dat --headers --fortran --catenate --fast --binary --makerows=IIII --makerows=FFFF --outfile=/tmp/lk_915264556_CZi4aN <br>Warning: Data root level renamed as lk_915264556_CZi4aN (started with number).<br>         Output file names are unchanged [looktxt:file_open:1377]<br>Warning: File 'iFit/Data/ILL_IN6.dat' c='-' [num pos=250] two fortran numbers are touching each other<br>Warning: File 'iFit/Data/ILL_IN6.dat' c='-' [num pos=2086] two fortran numbers are touching each other<br>Warning: File 'iFit/Data/ILL_IN6.dat' c='-' [num pos=2086] two fortran numbers are touching each other<br>Warning: File 'iFit/Data/ILL_IN6.dat' c='-' [num pos=2107] two fortran numbers are touching each other<br>Warning: File 'iFit/Data/ILL_IN6.dat' c='-' [num pos=2127] two fortran numbers are touching each other<br>Looktxt: file 'iFit/Data/ILL_IN6.dat': wrote 9 numerical fields into /tmp//lk_915264556_CZi4aN.m<br>iData: Setting the Signal of tp481575 to the biggest numerical field Data.IIIIIIIIIIIIIIIIIIIIIIIIIIIII_13 with length 131584.<br><br>a =  iData object:<br><br>    [Tag]     [Dimension]                           [Title] [Last command]          [Label]<br> tp481575      [257  512] 'File ILL_IN6.dat ILL Data (n...' tp481575=load(iData,...  </span></pre>
      </td>
    </tr>
  </tbody>
</table>
<br>
Wildcards (*,?) are supported. The file separator symbol ('/' for
Linux/Unix/MacOSX and '\' for Windows) is automatically adapted to the
system used.<img style="width: 308px; height: 428px;"
 alt="File selector to inport files into iData"
 title="File selector to inport files into iData"
 src="../iFiles/doc/uigetfiles.gif" align="right"><br>
Directory may be imported (and thus all files therein) as well as lists
of files (given as a cell of strings {...})<br>
<div style="margin-left: 40px;">
<pre>&gt;&gt; a = <span style="color: rgb(51, 102, 255);">iData</span>( <span
 style="color: rgb(204, 51, 204);">[ ifitpath '</span><span
 style="color: rgb(204, 51, 204);">Data' ]</span>);</pre>
<pre>&gt;&gt; a = i<span style="color: rgb(51, 102, 255);">Data</span>(<span
 style="font-weight: bold;">{</span> <span
 style="color: rgb(204, 51, 204);">[ ifitpath </span><span
 style="color: rgb(204, 51, 204);">'Data/*.dat' ]</span> ,...<br><span
 style="color: rgb(204, 51, 204);"></span><span
 style="color: rgb(204, 51, 204);">[ ifitpath </span><span
 style="color: rgb(204, 51, 204);">'</span><span
 style="color: rgb(204, 51, 204);">Data/sv1850.scn' ]</span>,...<br><span
 style="color: rgb(204, 51, 204);">[ ifitpath </span><span
 style="color: rgb(204, 51, 204);">'</span><span
 style="color: rgb(204, 51, 204);">Data/sv1884.scn'</span> ],...<br><span
 style="color: rgb(204, 51, 204);">[ ifitpath </span><span
 style="color: rgb(204, 51, 204);">'</span><span
 style="color: rgb(204, 51, 204);">Data/sv4700.scn'</span> ] <span
 style="font-weight: bold;">}</span>);<br></pre>
</div>
which return an array of iData objects.<br>
<br>
A <a href="../iFiles/doc/uigetfiles.html">file selector</a>,
which supports multiple file selection, may be used by
issuing<br>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">iData</span>(<span
 style="color: rgb(204, 51, 204);">''</span>)</pre>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">load</span>(iData,<span
 style="color: rgb(204, 51, 204);">''</span>)</pre>
By default, an analysis of the data file will be done, and the best
importer <br>
method will be used. It is possible to select a prefered method with
e.g.<br>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">load</span>(iData, <span
 style="color: rgb(204, 51, 204);">'filename'</span>, <span
 style="color: rgb(204, 51, 204);">'HDF5'</span>)</pre>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">load</span>(iData, <span
 style="color: rgb(204, 51, 204);">'filename'</span>, <span
 style="color: rgb(204, 51, 204);">'gui'</span>);&nbsp; % a method selector pops-up.</pre>
A list of the supported formats is shown below.<br>
<h4><a class="mozTocH4" name="mozTocId52427"></a>Distant files</h4>
The specified file names may include URL tags such as<br>
<ul>
  <li><span style="font-weight: bold;">file://</span><span
 style="font-style: italic;">filename</span></li>
  <li><span style="font-weight: bold;">ftp://</span><span
 style="font-style: italic;">filename</span></li>
  <li><span style="font-weight: bold;">http://</span><span
 style="font-style: italic;">filename</span></li>
</ul>
were the two latter cases first get a copy of the distant file
(requires write permission), and then import it. A valid Internet
connection is then required, with proper Proxy settings if needed.<br>
<h4><a class="mozTocH4" name="mozTocId250466"></a>Compressed files</h4>
Compressed files (ZIP, TAR, GZIP, Z) can also be imported directly, in
which case they are first extracted locally (requires write
permission), and then imported. This extraction mechanism also appl for
distant file.<br>
<br>
<div style="text-align: right;"><span style="font-weight: bold;">To get
more help</span>: <a href="matlab:help%20iData">help iData</a>, <a
 href="matlab:help%20iData/load">help iData/load</a><br>
</div>
<h3><a class="mozTocH3" name="mozTocId59221"></a>Supported data formats</h3>
In principle, any text based file is loaded transparently (see <a
 href="#mozTocId141862">below</a>). Binary files require a dedicated
wrapper, but many formats are supported. In some case, additional axis
definition specific to the format will be applied.<br>
<br>
The list of available methods is stored in the <span
 style="font-style: italic; color: rgb(204, 51, 204);">iFit/iFiles/iLoad_ini.m</span>
file, <br>
and can be obtained from the <span
 style="font-weight: bold; font-style: italic;">iLoad</span> function<br>
<pre style="margin-left: 40px;">&gt;&gt; config = <span
 style="color: rgb(51, 102, 255);">iLoad</span>(<span
 style="color: rgb(204, 51, 204);">''</span>,<span
 style="color: rgb(204, 51, 204);">'load config'</span>);</pre>
a local <span style="font-style: italic;">iLoad.ini</span>
configuration file is stored in the Matlab
<span style="font-style: italic;">Preferences</span> directory, and
then overrides the system default.<br>
The current method list is:<img style="width: 340px; height: 338px;"
 alt="iData load import method selector"
 title="iData load import method selector"
 src="images/iData_load_method_selector.png" align="right"><br>
<ul>
  <li>any Data in text format<br>
  </li>
  <li>ILL Data (most instruments at the <a
 href="http://www.ill.fr/YellowBook/">ILL</a>)<br>
  </li>
  <li>ILL TAS Data (polarized or not)</li>
  <li>SPEC</li>
  <li>McStas (Scan DAT output 1D, 2D monitor, sim file, Sqw table)</li>
  <li>ISIS/SPE tof data</li>
  <li>INX tof data</li>
  <li>Lotus1-2-3 (first spreadsheet) (*.wk1)<br>
  </li>
  <li>NeXT/SUN (.au) sound</li>
  <li>Microsoft WAVE (.wav) sound</li>
  <li>Audio/Video Interleaved (*.avi) </li>
  <li>NetCDF (*.cdf)<br>
  </li>
  <li>NetCDF 1.0 (*.nc)<br>
  </li>
  <li>FITS (*.fits)<br>
  </li>
  <li>Microsoft Excel (*.xls)</li>
  <li>Image/Picture (*.gif, *.bmp, *.tif, *.jpg, *.png)<br>
  </li>
  <li>HDF4 (*.hdf4)<br>
  </li>
  <li>HDF5 (*.hdf5)<br>
  </li>
  <li>Matlab workspace (*.mat)<br>
  </li>
  <li>Comma Separated Values (*.csv)<br>
  </li>
  <li>Numerical single block</li>
  <li>XML (*.xml)<br>
  </li>
</ul>
Additional data formats can be added easily, as explained in the <a
 href="iFiles.html">iFiles</a> help pages. Some of these formats are
also available for <a href="Save.html">Saving</a> iData objects.<br>
<br>
<h3><a class="mozTocH3" name="mozTocId782211"></a>Example data files</h3>
<a href="images/iFit_Data.png"><img alt="iFit: example Data"
 title="iFit: example Data" src="images/iFit_Data.png"
 style="border: 0px solid ; width: 300px; height: 266px;" align="right"></a>The
iFit
package
provides
a
set
of
<a href="../Data/">example
data
files</a>
used
to
demonstrate
the functionalities of the package.<br>
<ul>
  <li><span style="font-weight: bold;">ILL_D10.dat</span>: some D10
neutron diffractometer measurement at the ILL<br>
  </li>
  <li><span style="font-weight: bold;">ILL_IN20.dat</span>: some IN20
neutron triple-axis diffractometer at the ILL (GL goniometer scan)<br>
  </li>
  <li><span style="font-weight: bold;">ILL_IN6.dat</span>: some IN6
neutron time of flight spectrometer at the ILL (liquid water)<br>
  </li>
  <li><span style="font-weight: bold;">ILL_IN6_2.dat</span>: some IN6
neutron time of flight spectrometer at the ILL (liquid 3He)<br>
  </li>
  <li><span style="font-weight: bold;">MCA.dat</span>: some Canberra
multichannel analyzer data (from a Brillouin light scattering
spectrometer)<br>
  </li>
  <li><span style="font-weight: bold;">SPEC.dat</span>: some ESRF data<br>
  </li>
  <li><span style="font-weight: bold;">sv1850.scn</span>: some IN12
neutron triple-axis diffractometer at the ILL (QH scan)<br>
  </li>
  <li><span style="font-weight: bold;">sv1884.scn</span>: some IN12
neutron triple-axis diffractometer at the ILL (sample rotation scan)<br>
  </li>
  <li><span style="font-weight: bold;">sv4700.scn</span>: some IN12
neutron triple-axis diffractometer at the ILL</li>
</ul>
All of these can be directly accessed with e.g.<br>
<pre style="margin-left: 40px;"><span style="color: rgb(51, 102, 255);"><span
 style="color: rgb(0, 0, 0);">&gt;&gt; b = </span>iData</span>(<span
 style="color: rgb(204, 51, 204);">[ ifitpath 'Data' filesep <span
 style="color: rgb(0, 0, 0);">filename</span> ]</span>);<br>&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">iData</span>(<span
 style="color: rgb(204, 51, 204);">[ ifitpath 'Data'<span
 style="color: rgb(0, 0, 0);"></span> ]</span>);<br>&gt;&gt; <span
 style="color: rgb(51, 102, 255);">subplot</span>(a, <span
 style="color: rgb(204, 51, 204);">'tight'</span>)<br></pre>
The empty iData object &#8709; can be obtained from:<br>
<pre style="margin-left: 40px;">&gt;&gt; a=<span
 style="color: rgb(51, 102, 255);">iData</span><br>&gt;&gt; a=<span
 style="color: rgb(51, 102, 255);">zeros</span>(<span
 style="color: rgb(51, 102, 255);">iData</span>, size)<br></pre>
<h3><a class="mozTocH3" name="mozTocId141862"></a>Importing directly
from
Matlab variables</h3>
A direct import of a Matlab variable is performed with<br>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">iData</span>(variable)</pre>
such as<br>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">iData</span>(<span
 style="color: rgb(51, 102, 255);">rand</span>(10))</pre>
or<br>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">iData</span>(<span
 style="color: rgb(51, 102, 255);">struct</span>(<span
 style="color: rgb(204, 51, 204);">'a'</span>,1,<span
 style="color: rgb(204, 51, 204);">'b'</span>,<span
 style="color: rgb(204, 51, 204);">'a string'</span>))</pre>
This works for basically any imput object (structure, numeric array,
cell, ...).<br>
<br>
A special syntax is available to import Signal and Axis definitions
with e.g.<br>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">iData</span>(x,y,...c);</pre>
imports <span style="font-style: italic;">Signal</span> as 'c' and <span
 style="font-style: italic;">axes</span> x,y, ... which should then all
be numerical values with 'x' for the columns, 'y' for the rows, 'z' for
the depth, ... that is the plotting Matlab convention used e.g. in <span
 style="font-style: italic;">surf(x,y,z)</span>.<br>
<br>
The <span style="font-weight: bold; font-style: italic;">findobj</span>
method can be used to inquire for all iData objects available in the
workspace/memory:<br>
<pre style="margin-left: 40px;">&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">findobj</span>(iData);<span
 style="color: rgb(51, 102, 255);"></span></pre>
The <span style="font-weight: bold;">zeros</span> method initializes
an empty (or constant) array of objects:<br>
<pre style="margin-left: 40px;">&gt;&gt; a=<span
 style="color: rgb(51, 102, 255);">zeros</span>(<span
 style="color: rgb(51, 102, 255);">iData</span>, size)  % create a [size] array of empty objects<br>&gt;&gt; a=<span
 style="color: rgb(51, 102, 255);">zeros</span>(<span
 style="color: rgb(51, 102, 255);"></span>object, size) % duplicates 'object' as a [size] array<br></pre>
<h3><a class="mozTocH3" name="mozTocId755882"></a>Importing from Matlab
Figures<img style="width: 334px; height: 315px;"
 alt="The Peaks figure imported as an iData"
 title="The Peaks figure imported as an iData" src="images/Peaks.png"
 align="right"></h3>
The direct import method also works fromMatlab figures, when simply
giving a valid Handle Graphics Object to iData:<br>
<pre style="margin-left: 40px;">&gt;&gt; f=<span
 style="color: rgb(51, 102, 255);">figure</span>; <span
 style="color: rgb(51, 102, 255);">peaks</span>;<br>&gt;&gt; a = <span
 style="color: rgb(51, 102, 255);">iData</span>(f);</pre>
The handle can be a figure, a surface, an axis, a line, ...<br>
<h3><a class="mozTocH3" name="mozTocId672193"></a>How it works
(looktxt, iLoad, <a href="iFiles.html">iFiles</a>)<br>
</h3>
The file names to import are sent to the <a href="iFiles.html">iFiles</a>/iLoad
routine,
which
scans
the
file
and
searches
for
the
file
extension
and
patterns
in
the
file
contents
(in
the
case
of
text
files)
in
order to
identify the proper importation method to use.<br>
<br>
The text files are processed with the <a
 href="../iFiles/doc/looktxt.html">looktxt</a> parser (refer to <a
 href="http://looktxt.sourceforge.net">http://looktxt.sourceforge.net</a>)
and
translated
into
a
Matlab
script
which
is
then
read
into
the
workspace.
Binary
files
are
read
with
dedicated
read
routines,
as
it
is
usually
not
possible
to
interpret correctly the file structure <span
 style="font-style: italic;">ab-initio</span>. <br>
<br>
The resulting Matlab variable is a structure, which holds a <span
 style="font-style: italic;">Data</span> field with all numerical
blocks from the initial file, and a <span style="font-style: italic;">Header</span>
field which holds any preceding comment strings for each field. Data
fields are automatically named from keywords found just before the
numerical blocks. These steps are performed through the<span
 style="font-style: italic;"> iFiles/iLoad</span> wrapper.<br>
<br>
The structures are then converted into <a href="iData.html">iData</a>
objects, and optionally some data format specific post-processing
scripts are applied, as described in <span style="font-style: italic;">iFiles/iLoad_ini.m</span><br>
<br>
Refer to the <a href="iFiles.html">iFiles</a> documentation to learn
how to customize load methods and import filters.<br>
<br>
<div style="text-align: right;"><span style="font-weight: bold;">To get
more help: </span><a href="iFiles.html">iFiles</a>, <a
 href="../iFiles/doc/looktxt.html">looktxt</a><br>
</div>
<br>
<hr style="width: 100%; height: 2px;">
<div style="text-align: center;"><span style="font-style: italic;">E.
Farhi - iFit/iData loading data - </span><span
 style="font-style: italic;">
$Date: 2011-02-08 16:06:31 $ $Revision: 1.9 $
</span><span style="font-style: italic;"> </span>- back to <a
 href="index.html">Main
iFit
Page </a><a href="http://www.ill.eu/"><img
 title="ILL, Grenoble, France &lt;www.ill.eu&gt;"
 src="images/ILL-web-jpeg.jpg" alt="ILL, Grenoble, France &lt;www.ill.eu&gt;"
 style="border: 0px solid ; width: 53px; height: 50px;" align="right"></a>
</div>
</body>
</html>
